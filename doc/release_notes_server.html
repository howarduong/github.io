<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>BigWorld Technology Server Release Notes</title><link rel="stylesheet" type="text/css" href="bigworld.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div id="bigworld-header"><img src="http://try.bigworldtech.com/bigworld/image.php?img=bigworld_logo.gif&amp;svn=$HeadURL: http://patchsvn/svn/evaluation/official/IndiePackage/2.1/current/bigworld/doc/release_notes_server.html $" alt="bw logo"></div><div id="content"><div class="book" title="BigWorld Technology Server Release Notes"><div class="titlepage"><div><div><h1 class="title"><a name="Server_Release_Notes"></a>BigWorld Technology Server Release Notes</h1></div><div><p class="releaseinfo">BigWorld Technology 2.1. Released 2012.</p></div><div><p class="copyright">Copyright &copy; 1999-2012 BigWorld Pty Ltd. All rights reserved. </p></div><div><div class="legalnotice" title="Legal Notice"><a name="d0e17"></a><p>This document is proprietary commercial in confidence and access
  is restricted to authorised users. This document is protected by
  copyright laws of Australia, other countries and international treaties.
  Unauthorised use, reproduction or distribution of this document, or any
  portion of this document, may result in the imposition of civil and
  criminal penalties as provided by law.</p></div></div></div><hr></div><div class="article" title="BigWorld Technology 2.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e20"></a>BigWorld Technology 2.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Important Notes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e23"></a>1.&nbsp;Important Notes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The Client/Server protocol version for this release is 2.0.8.
        This protocol version matches the release when the protocol was last
        changed. Only clients with the 2.0.8 protocol version can connect to
        the server in this release.</p></li></ul></div></div><div class="section" title="2.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xref_2_1_0_New_Features"></a>2.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added a new flag <span class="literal">SendLatestOnly</span> that can be
        set on properties that have <span class="literal">OTHER_CLIENTS</span> or
        <span class="literal">ALL_CLIENTS</span> flag (or client methods). If set to
        <span class="literal">true</span>, only the latest message for a property (or a
        method call) is sent to clients instead of a message for each change
        of that property (or repeated call of a method). This can be used to
        save bandwidth.</p><p>Also added flag <span class="literal">IsReliable</span> for the same
        properties and methods. If set to <span class="literal">false</span>, these
        messages will be sent unreliably from the server to the client. If
        there is packet loss, this message will not be delivered.</p><p>Setting <span class="literal">SendLatestOnly</span> to
        <span class="literal">true</span> and <span class="literal">IsReliable</span> to
        <span class="literal">false</span> and changing a value every game tick causes
        behaviour similar to volatile position and direction values.</p><p>See the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> for more
        information.</p><p class="remark"><em><span class="remark">Bug 28421</span></em></p></li><li class="listitem"><p>Added a new option <span class="literal">AppealRadius</span> that can be
        set on entity types in their <code class="filename">.def</code> file. This allows for entities to be
        seen by a client at a distance further than the player's
        <em class="emphasis">Area of Interest</em> distance (i.e.
        <code class="property">Entity.aoiRadius</code>). This is useful for
        implementing large entities that can be seen from a great distance,
        such as a large dragon.</p><p>Additionally, a flag
        <span class="literal">DetailedPosition/SendLatestOnly</span> has also been added
        to entity <code class="filename">.def</code> files. If an
        entity does not have a volatile position, any movement of the cell
        entity will cause a history event. Setting this to
        <span class="literal">true</span> allows for this to be efficiently sent to
        clients without them getting redundant messages.</p><p>The <span class="literal">DetailedPosition/SendLatestOnly</span> flag is
        implicitly set when <span class="literal">AppealRadius</span> is
        non-zero.</p><p>See the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> for more
        information.</p><p class="remark"><em><span class="remark">Bug 3764</span></em></p></li><li class="listitem"><p>Added a new, optional server component named ServiceApp. This is
        a modified BaseApp that allows implementing scripted services. An
        example implementation of a service is included that runs a Python web
        server (using the Twisted Python framework) inside the ServiceApp to
        give a RESTful web interface for accessing live game entities. For
        details on this example service, refer to <a href="./html/server_web_integration/server_web_integration.html#xref_TwistedWeb_Service" class="olink"><i>The TwistedWeb Service</i></a>.</p><p class="remark"><em><span class="remark">Bug 31543</span></em></p></li><li class="listitem"><p>Added support for two-way script calls. Previously, all remote
        script calls within a BigWorld server were one-way. This meant that
        simulating a two-way call required implementing two one-way methods.
        Two-way methods are now supported. The calling code receives a
        <code class="classname">Deferred</code> object. Callback methods can be added
        to this object to receive the response or failure information. For
        details, refer to <a href="./html/server_programming_guide/server_programming_guide.html#xref_Two_Way_Calls" class="olink">Two-way calls</a>.</p><p class="remark"><em><span class="remark">Bug 16894</span></em></p></li><li class="listitem"><p>Added support for asynchronous handling of
        <code class="methodname">onInit</code> and <code class="methodname">onFini</code>
        events. These event listeners can now return a
        <code class="classname">Deferred</code> object. If so, the initialisation or
        shutdown stages will not progress until these have been called.</p><p>See the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 31978</span></em></p></li><li class="listitem"><p>Added <code class="methodname">BigWorld.addEventListener()</code>. This
        allows registering for <code class="classname">BWPersonality</code> callbacks
        outside of this module. This is particularly useful for decoupling
        reusable modules from the <code class="classname">BWPersonality</code>
        module.</p><p>See the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 31926</span></em></p></li><li class="listitem"><p>It is now possible to get a Python console on the DBMgr process.
        This can be done through WebConsole or via the command:</p><pre class="programlisting">control_cluster.py pyconsole dbmgr</pre><p>Execute <code class="code">control_cluster.py --help</code> for more info on
        ControlCluster usage.</p><p class="remark"><em><span class="remark">Bug 31942</span></em></p></li><li class="listitem"><p>Added Python function <code class="function">BigWorld.fetchURL()</code>
        that allows asynchronous fetching of URL via HTTP to the BaseApp,
        CellApp and DBMgr.</p><p>For more information on the <code class="function">fetchURL()</code>
        function, please refer to either the <a href="./html/..//api_python/baseapp/index.html#Client_Python_API" class="olink">Client Python API</a>, <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>, or <span class="olink">????</span>.</p><p class="remark"><em><span class="remark">Bug 27602</span></em></p></li><li class="listitem"><p>Added Python function
        <code class="function">BigWorld.lookUpBasesByIndex()</code> that allows
        look-ups of entities in the database on simple property queries, as
        well as offline/online status.</p><p>See the <a href="./html/..//api_python/baseapp/index.html#Client_Python_API" class="olink">Client Python API</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 28424</span></em></p></li><li class="listitem"><p>Added flag <code class="property">shouldWriteToPrimary</code> to
        <code class="methodname">Base.writeToDB()</code>. This allows writing to the
        primary database instead of the secondary database. It is useful when
        using the new <code class="function">BigWorld.lookUpBasesByIndex()</code>
        function.</p><p>See the <a href="./html/..//api_python/baseapp/index.html#Client_Python_API" class="olink">Client Python API</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 28424</span></em></p></li><li class="listitem"><p>Added configuration option
        <span class="literal">cellApp/maxTickStagger</span> to
        <code class="filename">bw.xml</code>. This adds the ability to stagger the
        CellApp update ticks.</p><p>If all CellApps are synchronised, the network load produced by
        cluster is very spiky. Having each CellApp produce its traffic at
        offset times helps to spread the traffic out over time. This helps
        avoid packet loss for some network hardware.</p><p>See the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 31621</span></em></p></li><li class="listitem"><p>Added a property <code class="property">Entity.artificialLoad</code> to
        the cell entity. This allows an entity to add an artificial amount of
        load to the calculated load that is used for load balancing. It is
        useful if you have an entity or space that often has periods of low
        load but can quickly change.</p><p>See <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a> for more
        details.</p><p class="remark"><em><span class="remark">Bug 28438</span></em></p></li><li class="listitem"><p>The offline patcher now supports recursive ZIP file archives,
        that is, ZIP file archives inside ZIP file archives. These are handled
        by generating deltas between the contents of the ZIP files, instead of
        a delta between the ZIP files themselves.</p><p>See the <span class="olink">????</span> document for more
        details.</p><p class="remark"><em><span class="remark">Bug 26666</span></em></p></li><li class="listitem"><p>A new CellApp script method
        <code class="methodname">BigWorld.isNextTickPending()</code> has been added.
        This new method returns a boolean indicating whether the current tick
        has exceeded its assigned execution time. This allows expensive script
        computations to know when to relinquish control in order for the next
        tick to start processing.</p><p>For more information on the
        <code class="methodname">isNextTickPending()</code> please refer to the
        <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 26863</span></em></p></li><li class="listitem"><p>Two new cell entity Python callbacks have been added for when
        entities leave the area of interest of a Witness. The new callbacks
        are <code class="methodname">Entity.onLeftAoI()</code> and
        <code class="methodname">Entity.onLeftAoIID()</code>.</p><p>For more information on the <code class="methodname">onLeftAoI()</code>
        and <code class="methodname">onLeftAoIID()</code> callbacks, please refer to
        the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug #31787 / Ticket #2968</span></em></p></li><li class="listitem"><p>The data directory used by BWLockD can be specified on the
        command line (the default path is <code class="filename">/var/lib/bigworld/bwlockd</code>).</p><p class="remark"><em><span class="remark">Bug #31765</span></em></p></li><li class="listitem"><p>Added configuration option
        <span class="literal">maxOpenFileDescriptors</span> to
        <code class="filename">bw.xml</code>. This adds the capability to increase the
        number of simultaneously open files for each App.</p><p>bwmachined is also updated to ensure that this value can be
        raised to at least 16384 in processes it starts.</p><p>For more information on this option please refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_General_Configuration_Options" class="olink">General Configuration Options</a>.</p><p class="remark"><em><span class="remark">Bug 31878</span></em></p></li><li class="listitem"><p>Added two new CellApp Entity callbacks,
        <code class="methodname">Entity.onGhostCreated()</code> and
        <code class="methodname">Entity.onGhostDestroyed()</code>.</p><p>As the names suggest these methods are called on ghosted
        entities as they are created and destroyed.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>These callbacks <em class="emphasis">must</em> be decorated with
          the <span class="literal">@bwdecorators.callableOnGhost</span> decorator in
          order to be successfully called.</p></div><p>For more information on the
        <code class="methodname">onGhostCreated()</code> and
        <code class="methodname">onGhostDestroyed()</code> callbacks, please refer to
        the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 32301</span></em></p></li><li class="listitem"><p>A new ControlCluster command is available for outputting
        information about server processes in Nagios-compatible format.</p><p>Thresholds can be set for triggering warning and critical
        conditions based on load and number of running BaseApps and CellApps.
        This can be useful for integrating a check for server availability
        with the Nagios monitoring tool.</p><p>Refer to the <span class="literal">--help</span> output for the
        <span class="literal">nagios</span> ControlCluster command for more
        details.</p><p class="remark"><em><span class="remark">Bug 32354</span></em></p></li><li class="listitem"><p>Added a new CellApp <code class="filename">bw.xml</code> option
        <span class="literal">shouldNavigationDropPosition</span> which allows the
        navigation code to automatically drop the position of an entity from
        the navigation mesh down to the collision scene.</p><p>For more information on this option please refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_CellApp_Configuration_Options" class="olink">CellApp Configuration Options</a>.</p><p class="remark"><em><span class="remark">Bug 32301</span></em></p></li><li class="listitem"><p>A new document has been added which describes how to interface
        Python and C++, located at <a href="./html/python_and_c/python_and_c.html#Python_And_C" class="olink">Python and C</a>. The
        section on debugging script memory leaks was moved from the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> into the <a href="./html/python_and_c/python_and_c.html#Python_And_C" class="olink">Python and C</a> document.</p><p class="remark"><em><span class="remark">Bug 32074</span></em></p></li><li class="listitem"><p>When using a custom authentication system with DBMgr, it is now
        possible to send extra information back to the client on a successful
        login.</p><p>This can be used, for example, to allow your authentication
        system to generate an authentication token when a successful username
        and password are first used. This token could then be passed on
        subsequent logins, avoiding the username/password step for players
        when using the same hardware.</p><p>A second example is returning information about current account
        status (e.g. remaining credit).</p><p class="remark"><em><span class="remark">Bug 32552</span></em></p></li><li class="listitem"><p>Ghosted cell entities can now have <code class="code">set_*</code> style
        callbacks called when ghosted properties change on the real entity.
        These optional callbacks take the same form as the client-side
        <code class="code">set_*</code> callbacks. For more information, please refer to
        the <a href="./html/server_programming_guide/server_programming_guide.html#xref_Property_Callbacks_On_Ghosted_Entities" class="olink">Property Callbacks On Ghosted Entities</a>.</p><p class="remark"><em><span class="remark">Bug 32654</span></em></p></li><li class="listitem"><p>Improved the bandwidth usage of method calls and property
        updates sent from the server to the client. Savings will typically be
        between 2 and 6 bytes per message.</p><p>Two main optimisations have been implemented. Previously each
        script message included the entity id. This is now done separately so
        that multiple messages can share this data. For entities with a
        volatile position, four bytes are saved. For non-volatile entities,
        typically 2-4 bytes are saved; 2 for the first message and 4 for
        subsequent messages.</p><p>The second optimisation is dropping the size prefix for any
        script messages that are constant size. For these messages, 2 bytes
        are saved. For variable size messages, 1 byte is now saved.</p><p class="remark"><em><span class="remark">Bug 32152 and Bug 32638</span></em></p></li><li class="listitem"><p>The SpaceViewer tool has been reimplemented in HTML and is now
        integrated into the Web Console. Consequently, the former wx Python
        version is now deprecated.</p><p class="remark"><em><span class="remark">Bug 32257</span></em></p></li></ul></div></div><div class="section" title="3.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e443"></a>3.&nbsp;Changed Features</h2></div></div></div><div class="section" title="3.1.&nbsp;Script &amp; Script API"><div class="titlepage"><div><div><h3 class="title"><a name="d0e446"></a>3.1.&nbsp;Script &amp; Script API</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Python was upgraded from 2.6.4 to 2.6.6</p><p><em class="emphasis">IMPORTANT:</em> Make sure to
          update your lib-dynload64 directory as Python binary modules
          (<code class="filename">.so</code> files) may not be
          compatible. This may result in stalling when importing these modules
          or other server instability.</p><p>Note that this directory has also been moved from <code class="filename">res/scripts/common</code> to <code class="filename">res/scripts/server_common</code>.</p><p class="remark"><em><span class="remark">Bug 27617</span></em></p></li><li class="listitem"><p><em class="emphasis">IMPORTANT:</em> The server only
          Python binary modules (<code class="filename">.so</code>
          files) have been moved from the Python script directory <code class="filename">res/scripts/common</code> to the server only
          Python script directory <code class="filename">res/scripts/server_common</code>. This change
          allows easier separation of files during the resource packing step
          for production releases.</p><p class="remark"><em><span class="remark">Bug 27617</span></em></p></li><li class="listitem"><p><code class="methodname">ResMgr.resolveToAbsolutePath</code> has been
          modified so that if the given path does not exist it will return the
          path relative to the first resource tree instead of raising an
          exception.</p><p>For more information on the
          <code class="methodname">resolveToAbsolutePath</code> method please refer
          to either the <a href="./html/..//api_python/baseapp/index.html#Client_Python_API" class="olink">Client Python API</a>, <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>, or <span class="olink">????</span>.</p><p class="remark"><em><span class="remark">Bug 32219</span></em></p></li><li class="listitem"><p>As part of the Python upgrade the behaviour of the
          <code class="function">open()</code> function has changed. Files and paths
          referenced via <code class="function">open()</code> will no longer be
          relative to the BigWorld resource tree as defined in your
          <code class="filename">.bwmachined.conf</code> file. Files are now relative
          to <code class="methodname">os.getcwd()</code>.</p><p>In order to replicate old behaviour of referencing files
          within the BigWorld resource tree you will need to use the
          <code class="methodname">ResMgr.resolveToAbsolutePath()</code> method. For
          example:</p><pre class="programlisting">fp = open( "data/custom_data.dat", "r" )</pre><p>would become</p><pre class="programlisting">filename = ResMgr.resolveToAbsolutePath( "data/custom_data.dat" )
fp = open( filename, "r" )</pre><p>Alternatively, there is a new utility module
          <code class="classname">BWUtil</code> that contains a method to replace the
          builtin <code class="function">open()</code> function to support the original
          behaviour for relative files.</p><p>To activate this, put the following in your
          <code class="filename">BWAutoImport.py</code>:</p><pre class="programlisting">import BWUtil
BWUtil.monkeyPatchOpen()</pre><p class="remark"><em><span class="remark">Bug 27617</span></em></p></li><li class="listitem"><p><code class="function">BigWorld.executeRawDatabaseCommand()</code> now
          supports returning multiple result sets. These multiple result sets
          can be returned by calling this function with multiple SQL
          statements separated by a semicolon, or from calling stored
          procedure calls. Refer to the <a href="./html/server_programming_guide/server_programming_guide.html#xref_Execute_Commands_on_SQL_Database" class="olink">Execute Commands on SQL
      Database</a> for more
          details.</p><p class="remark"><em><span class="remark">Bug 28423 / Ticket #2781</span></em></p></li><li class="listitem"><p>The implementation of the method
          <code class="methodname">Entity.bounceGrenade()</code> has been moved out
          of the core CellApp binary. This method is now available as part of
          the CellApp extensions example located in <code class="filename">bigworld/src/examples/cellapp_extension</code>.</p><p>To use this method you will now need to compile the CellApp
          extension separately to the CellApp binary.</p><p class="remark"><em><span class="remark">Bug 26229</span></em></p></li><li class="listitem"><p>The BWLog module method <code class="methodname">getStrings()</code>
          that was deprecated in previous releases in favour of
          <code class="methodname">getFormatStrings()</code> has now been
          removed.</p><p>To make any code compatible, simply change your code to use
          <code class="methodname">BWLog.getFormatStrings()</code>.</p><p>There is no related documentation for this API. Please refer
          to the source code for <code class="classname">PyBWLog</code> in <code class="filename">bigworld/src/server/tools/message_logger</code>
          for information on this class.</p></li><li class="listitem"><p>The behaviour when assigning to a
          <span class="literal">FIXED_DICT</span> or <span class="literal">ARRAY</span> property
          of a base entity has changed. Previously, assigning to a
          <span class="literal">FIXED_DICT</span> property with a Python
          <span class="literal">dict</span> would just keep this <span class="literal">dict</span>
          instance. This value is now converted to a
          <span class="literal">PyFixedDictDataInstance</span>. Similarly, Python
          <span class="literal">list</span> instances are converted to
          <span class="literal">PyArrayDataInstance</span>. This is now consistent with
          the CellApp behaviour.</p><p>For more information on these property types, please refer to
          the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Property_Types" class="olink">Property Types</a>.</p><p class="remark"><em><span class="remark">Bug 18972</span></em></p></li><li class="listitem"><p>The Note Data Store example located in <code class="filename">fantasydemo/res/scripts/base</code> and
          <code class="filename">fantasydemo/res/server/examples/note_data_store</code>
          has been updated to use PostgreSQL by default. MySQL support should
          still work as before for non-indie customers.</p><p>For more information on using either PostgreSQL or MySQL with
          the Note Data Store example, please refer to the instructions file
          located in
          <code class="filename">fantasydemo/res/server/examples/note_data_store/instructions.txt</code>.</p><p class="remark"><em><span class="remark">Bug 28416</span></em></p></li><li class="listitem"><p>The CellApp method
          <code class="methodname">BigWorld.createEntityOnBaseApp</code> now accepts
          an optional third argument of a callable object which will be
          invoked when the Base entity has been created. The callback provides
          a single argument which is the Base mailbox of the newly created
          entity on success, or <span class="literal">None</span> on failure.</p><p>For more information on the
          <code class="methodname">createEntityOnBaseApp()</code> method please refer
          to the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 26962</span></em></p></li><li class="listitem"><p>The CellApp method
          <code class="methodname">Entity.entitiesInAoI()</code> will no longer
          return destroyed entities. Previously, this could occur if an entity
          in an AoI was recently destroyed but the client has not yet been
          informed.</p><p>For more information on the
          <code class="methodname">entitiesInAoI()</code> method please refer to the
          <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 31563</span></em></p></li><li class="listitem"><p><code class="classname">Entity.</code><code class="property">direction</code>
          is now a mutable type instead of being a copy of the entity's
          direction. This means that <code class="code">entity.direction[2] = newYaw</code>
          now works. If you need to take a copy of the current direction, use
          <code class="code">currDir = Math.Vector3( entity.direction )</code>.</p><p>For more information on the <code class="property">direction</code>
          property please refer to the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 26892</span></em></p></li><li class="listitem"><p>The <code class="methodname">onFini</code> event is now triggered
          slightly earlier. It is now called immediately after leaving the
          main run loop and before other things have started to shut
          down.</p><p>For more information on the <code class="methodname">onFini</code>
          method please refer to either the <a href="./html/..//api_python/baseapp/index.html#Client_Python_API" class="olink">Client Python API</a>, <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>, or <span class="olink">????</span>.</p><p class="remark"><em><span class="remark">Bug 31942</span></em></p></li><li class="listitem"><p>A new optional parameter,
          <em class="parameter"><code>shouldRememberUnknown</code></em>, has been added to the
          <code class="classname">PyBillingResponse</code> class's
          <code class="methodname">loadEntityByName()</code> method, used in the
          Python billing system. If set to <span class="literal">True</span>, newly
          created unknown entities are saved out to the database if
          <em class="parameter"><code>createUnknown</code></em> is also
          <span class="literal">True</span>. If set to <span class="literal">False</span>, they
          are not automatically written out to the database on login. It
          defaults to <span class="literal">False</span> for backwards
          compatibility.</p><p>For more information on these methods and parameters please
          refer to the <span class="olink">????</span>.</p><p class="remark"><em><span class="remark">Bug 31943</span></em></p></li><li class="listitem"><p>The CellApp methods <code class="methodname">Entity.navigate()</code>
          and <code class="methodname">Entity.navigateFollow()</code> have been
          deprecated.</p><p>To update your code, use the recommended method
          <code class="methodname">BigWorld.navigateStep()</code>. See <a href="./html/howto_move_entities/howto_move_entities.html#HowTo_Move_Entities" class="olink">How To Move Entities</a> for details.</p><p><code class="methodname">BigWorld.navigateStep()</code> differs from
          <code class="methodname">Entity.navigateFollow()</code> only by taking a
          position as a parameter rather than an Entity reference, a distance
          and an angle.</p><p><code class="methodname">BigWorld.navigateStep()</code> differs from
          <code class="methodname">Entity.navigate()</code> as it exposes more
          control over navigation process to the Python scripting code.</p><p class="remark"><em><span class="remark">Bug 31732</span></em></p></li><li class="listitem"><p>Deprecated <span class="literal">Py_Return</span> in favour of
          <span class="literal">Py_RETURN_NONE</span>, which is part of the standard
          Python distribution.</p><p>Deprecated <span class="literal">PyTypePlus</span> in favour of
          <span class="literal">PyTypeObject</span>, which is part of the standard
          Python distribution.</p><p>Deprecated <span class="literal">PyInstancePlus</span> and
          <span class="literal">Py_InstanceHeader</span> as they are simply aliases for
          <span class="literal">PyObjectPlus</span> and
          <span class="literal">Py_Header</span>.</p><p>There is no related documentation for this change.</p><p class="remark"><em><span class="remark">Bug 32074</span></em></p></li><li class="listitem"><p>The CellApp method
          <code class="methodname">Entity.navigateStep</code> now calls the
          <code class="methodname">Entity.onMoveFailure</code> notification method if
          the system detects that <code class="methodname">Entity.navigateStep</code>
          is being called too frequently in a single tick from the
          <code class="methodname">Entity.onMove</code> notification method.</p><p>In previous releases this situation would log a warning in the
          server logs and stop calling the
          <code class="methodname">Entity.onMove</code> notification method. The most
          likely cause is attempting to navigate to a position the entity
          already occupies.</p><p>For more information on these method please refer to the
          <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 32573</span></em></p></li></ul></div></div><div class="section" title="3.2.&nbsp;DBMgr"><div class="titlepage"><div><div><h3 class="title"><a name="d0e842"></a>3.2.&nbsp;DBMgr</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Billing system support has been updated to be configurable at
          startup time using the <code class="filename">bw.xml</code> option
          <span class="literal">&lt;billingSystem&gt;&lt;type&gt;</span>. For more
          information on this option please refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a>.</p><p class="remark"><em><span class="remark">Bug 31451</span></em></p></li><li class="listitem"><p>The database engines used by DBMgr have been modified to now
          be loaded from shared libraries (<code class="filename">.so</code> files) in the directory <code class="filename">bigworld/bin/Hybrid64/dbmgr-extensions</code>.</p><p>The source code for the database engine shared libraries can
          be found in <code class="filename">bigworld/src/server/dbmgr_extensions/bwengine_<em class="replaceable"><code>&lt;engine_type&gt;</code></em></code>.</p><p class="remark"><em><span class="remark">Bug 31482</span></em></p></li></ul></div><div class="section" title="3.2.1.&nbsp;Consolidation &amp; Snapshotting"><div class="titlepage"><div><div><h4 class="title"><a name="d0e877"></a>3.2.1.&nbsp;Consolidation &amp; Snapshotting</h4></div></div></div><p>A number of changes have occurred to improve the consolidation
        and snapshotting facilities of the primary and secondary databases.
        The changes are focused on improving feedback for error situations
        that were previously difficult to diagnose, as well as allowing
        smoother installation support when using RPMs.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The TransferDBs Python script has been converted into a C++
            application. The source code for this program now resides in the
            directory <code class="filename">bigworld/src/server/tools/transfer_db</code>.
            The binary location remains untouched in <code class="filename">bigworld/bin/Hybrid64/commands/transfer_db</code>.</p><p>For more information regarding TransferDB please refer to
            the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_Database_Snapshot_Tool" class="olink">Database Snapshot Tool</a>.</p><p class="remark"><em><span class="remark">Bug 31556</span></em></p></li><li class="listitem"><p>The SnapshotHelper program now builds into the directory
            <code class="filename">bigworld/bin/Hybrid64/commands/_helpers</code>.
            SnapshotHelper used to build into <code class="filename">bigworld/tools/server/bin/Hybrid64</code>.</p><p>This change allows the BigWorld server installation to not
            depend on the server tools directory being installed on cluster
            machines that are not intended to run the tools.</p><p>For more information regarding SnapshotHelper please refer
            to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_Database_Snapshot_Tool" class="olink">Database Snapshot Tool</a>.</p><p class="remark"><em><span class="remark">Bug 31556</span></em></p></li></ul></div></div></div><div class="section" title="3.3.&nbsp;Load Balancing"><div class="titlepage"><div><div><h3 class="title"><a name="d0e919"></a>3.3.&nbsp;Load Balancing</h3></div></div></div><p>A number of improvements have been made to the load balancing.
      These include:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Supporting multiple CPU load boundaries calculated by the
          CellApps. These are passed to CellAppMgr and used by the load
          balancing. These are exposed to SpaceViewer as <span class="literal">Entity
          Bounds</span>.</p><p>For more information please refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_Load_Balancing_Configuration_Options" class="olink">Load Balancing Configuration Options</a> option
          <span class="literal">numCPUOffloadLevels</span>.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>The load balancing now has a concept of an aggression level.
          If thrashing of a cell partition occurs (rapid movement back and
          forth), the balance aggression is reduced. This helps to avoid these
          thrashing situations. This aggression value has been exposed to
          SpaceViewer.</p><p>For more information please refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_Load_Balancing_Configuration_Options" class="olink">Load Balancing Configuration Options</a> options
          <span class="literal">agressionDecrease</span>,
          <span class="literal">aggressionIncreasePeriod</span>,
          <span class="literal">maxAggression</span>, and
          <span class="literal">maxAggressionIncreasePeriod</span>.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>Better CellApp load calculation to feed into the load
          balancing algorithm. Previously, the load change due to offloading
          or onloading an entity could take a while to be factored in. This is
          now estimated immediately.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>Improved balancing when CellApp channels are
          overloaded.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>Decreased default settings for <span class="literal">lowerBound</span>
          and <span class="literal">upperBound</span> in <code class="filename">bw.xml</code>'s
          <span class="literal">cellAppMgr/cellAppLoad</span>. This greatly increases
          the likelihood of using more CellApps earlier.</p><p>For more information on these options please refer to the
          <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_CellAppMgr_Configuration_Options" class="olink">CellAppMgr Configuration Options</a>.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>Removed old configuration options. These include:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>balance/minEntityOffload</p></li><li class="listitem"><p>balance/minMovement</p></li><li class="listitem"><p>balance/slowApproachFactor</p></li><li class="listitem"><p>cellApp/offloadHysteresis</p></li><li class="listitem"><p>cellApp/channelOverloadLimit</p></li><li class="listitem"><p>cellApp/offloadMaxPerCheck</p></li><li class="listitem"><p>cellApp/ghostingMaxPerCheck</p></li></ul></div><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li><li class="listitem"><p>Added new configuration options. These include:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>balance/aggressionDecrease</p></li><li class="listitem"><p>balance/aggressionIncreasePeriod</p></li><li class="listitem"><p>balance/maxAggression</p></li><li class="listitem"><p>balance/maxAggressionIncreasePeriod</p></li></ul></div><p>For more information on these options please refer to the
          <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> sections <a href="./html/server_operations_guide/server_operations_guide.html#xref_Load_Balancing_Configuration_Options" class="olink">Load Balancing Configuration Options</a>.</p><p class="remark"><em><span class="remark">Bug 31955</span></em></p></li></ul></div></div><div class="section" title="3.4.&nbsp;Documentation"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1049"></a>3.4.&nbsp;Documentation</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <a href="./html/server_installation_guide/server_installation_guide.html#Server_Installation_Guide" class="olink">Server Installation Guide</a> has been
          re-written to provide a more logical installation workflow as well
          as a better <em class="emphasis">first run</em> experience.</p><p>As part of this document update the Server Tools Installation
          Guide no longer exists and has been fully incorporated into the
          <a href="./html/server_installation_guide/server_installation_guide.html#Server_Installation_Guide" class="olink">Server Installation Guide</a>. This was possible
          due to the simplification of the server tools installation process
          from using RPM packages.</p><p class="remark"><em><span class="remark">Bug 31653</span></em></p></li></ul></div></div><div class="section" title="3.5.&nbsp;Miscellaneous"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1067"></a>3.5.&nbsp;Miscellaneous</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>When installing BWMachineD from an RPM package the kernel
          socket buffer sizes will be set to the recommended minimum values if
          they have not already been set in
          <code class="filename">/etc/sysctl.conf</code>.</p><p>Existing values will not be modified. If the current values
          are lower the recommended minimum values BWMachineD will emit a
          warning in the system logs
          (<code class="filename">/var/log/messages</code>).</p><p class="remark"><em><span class="remark">Bug 21832</span></em></p></li><li class="listitem"><p>DBMgr and SyncDB now strictly enforce the use of
          <span class="literal">InnoDB</span> as the storage engine for its tables. They
          attempt to change the engine of any table that does not comply on
          startup. SyncDB will also give a notice if the default storage
          engine is something other than <span class="literal">InnoDB</span>.</p><p class="remark"><em><span class="remark">Bug 27017 / Ticket 1480</span></em></p></li><li class="listitem"><p>Unit test binaries have been moved from the <code class="filename"><em class="replaceable"><code>bw_root</code></em>/tests</code>
          directory into <code class="filename"><em class="replaceable"><code>bw_root</code></em>/bigworld/bin/unit_tests</code>.
          This helps to consolidate all generated binaries into a single, well
          known location.</p><p class="remark"><em><span class="remark">Bug 28169</span></em></p></li><li class="listitem"><p>The libcURL library used by BaseApp, CellApp and DBMgr has
          been upgraded to version 7.21.6, and now builds against our supplied
          OpenSSL headers. Previously, the system's OpenSSL headers were being
          erroneously used in building the library.</p><p class="remark"><em><span class="remark">Bug 31562</span></em></p></li><li class="listitem"><p>The BigWorld SQLite library wrapper has been cleaned up to
          allow better integration from a variety of programs. Previously
          using this library involved only including the
          <code class="filename">sqlite/sqlite_util.hpp</code> header. This header has
          been removed and replaced by a separate header for both the
          <code class="classname">SqliteConnection</code> and
          <code class="classname">SqliteStatement</code> classes,
          <code class="filename">sqlite/sqlite_connection.hpp</code> and
          <code class="filename">sqlite/sqlite_statement.hpp</code>
          respectively.</p><p class="remark"><em><span class="remark">Bug 31556</span></em></p></li><li class="listitem"><p>The AoI radius for entities is no longer restricted to 500m.
          The limit can now be set using the CellApp configuration option
          <span class="literal">maxAoIRadius</span>. Refer to <a href="./html/server_operations_guide/server_operations_guide.html#xref_CellApp_Configuration_Options" class="olink">CellApp Configuration Options</a> for more
          details.</p><p><span class="literal">ghostDistance</span>,
          <span class="literal">maxAoIRadius</span> and
          <span class="literal">defaultAoIRadius</span> can take any positive float
          value. <span class="literal">maxAoIRadius</span> must not be greater than
          <span class="literal">ghostDistance</span>, and
          <span class="literal">defaultAoIRadius</span> must not be greater than
          <span class="literal">maxAoIRadius</span>.</p><p>Increasing the value of <span class="literal">maxAoIRadius</span>
          reduces the precision of the entity position data sent to the
          client. For example, doubling <span class="literal">maxAoIRadius</span> will
          reduce the precision of this data by half, whereas halving it will
          double the precision.</p><p class="remark"><em><span class="remark">Bug 31666</span></em></p></li><li class="listitem"><p>Replaced <code class="filename">bw.xml</code> option
          <span class="literal">reviver/timeoutInPings</span> with
          <span class="literal">reviver/timeout</span>. This is now specified in
          seconds.</p><p>Increased the default timeout period from 0.5 seconds to 3
          seconds.</p><p class="remark"><em><span class="remark">Bug 31929</span></em></p></li></ul></div></div></div><div class="section" title="4.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1191"></a>4.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The default value for non-persistent properties in a FIXED_DICT
        are now read from the type's &lt;Default&gt; section when loading from
        the database. For details about the FIXED_DICT data type and setting
        default falues for it, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_FIXED_DICT_Data_Type" class="olink">FIXED_DICT Data Type</a>.</p><p class="remark"><em><span class="remark">Ticket 2909</span></em></p></li><li class="listitem"><p>Fixed a bug with bwmachined when the default broadcast route is
        a multihomed interface. For details on how to setup the default
        broadcast route, refer to the <a href="./html/server_installation_guide/server_installation_guide.html#Server_Installation_Guide" class="olink">Server Installation Guide</a> section <a href="./html/server_installation_guide/server_installation_guide.html#xref_Cluster_Configuration_Routing" class="olink">Routing</a>.</p><p class="remark"><em><span class="remark">Bug 27742</span></em></p></li><li class="listitem"><p>Fixed a bug where method calls between a cell entity and its
        associated base entity would take longer to be transmitted if the
        entity was a player entity than if there was no attached
        player.</p><p class="remark"><em><span class="remark">Bug 31546</span></em></p></li><li class="listitem"><p>Fixed a bug where corrupt log files could cause the LogViewer
        module of WebConsole to try to endlessly try to read log entries,
        giving an error message upon each failed attempt.</p><p>This would cause spam of this message in the WebConsole log
        files, which could lead to disk space issues.</p><p class="remark"><em><span class="remark">Bug 31715 / Ticket 3377</span></em></p></li><li class="listitem"><p>Improved performance of streaming <span class="literal">FIXED_DICT</span>
        and <span class="literal">ARRAY</span> method arguments that are dynamically
        created. For example a nested custom <span class="literal">FIXED_DICT</span>
        implementation could have its
        <code class="methodname">getDictFromObj()</code> method called 3 times rather
        than once. For more details on these types, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Composite_Types" class="olink">Composite Types</a>.</p><p class="remark"><em><span class="remark">Bug 31741 / Ticket 3288</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause Command Watcher responses to fail
        if the response was greater than 64k bytes.</p><p class="remark"><em><span class="remark">Bug 31930</span></em></p></li><li class="listitem"><p>The <code class="methodname">Entity.onEnteredAoI()</code> callback is
        now no longer called when offloading a Witness. Refer to <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a> for details on the
        <code class="methodname">onEnteredAoI()</code> callback method.</p><p class="remark"><em><span class="remark">Bug 31787</span></em></p></li><li class="listitem"><p>There is no longer a limit on the number of unique model types
        that can be loaded by the server. It was previously limited to
        32768.</p><p class="remark"><em><span class="remark">Bug 32026</span></em></p></li><li class="listitem"><p>Fixed a bug where WebConsole would try to read the wrong
        StatGrapher preferences file after installation, and always treat the
        StatGrapher preferences file as needing to be reloaded on every
        access. For more details about WebConsole and StatGrapher, reger to
        the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_WebConsole" class="olink">WebConsole</a>.</p><p class="remark"><em><span class="remark">Bug 31948</span></em></p></li><li class="listitem"><p>Fixed a bug where long stream descriptions could stall auxiliary
        data streams to clients in low per-client bandwidth situations even if
        sufficient bandwidth was available to stream the data itself. For
        details about streaming auxiliary data, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Auxiliary_Data" class="olink">Sending Auxiliary Data to the Client Via Proxy</a>
        section .</p><p class="remark"><em><span class="remark">Bug 31892 / Ticket 3454</span></em></p></li><li class="listitem"><p>Fixed a bug where <code class="varname">globalData</code>,
        <code class="varname">baseAppData</code> or <code class="varname">cellAppData</code> could
        temporarily revert to an older state after a change was made. This
        could occur when there were multiple change messages travelling to the
        manager at once. For details about global data, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Global_Data" class="olink">Global Data</a>.</p><p class="remark"><em><span class="remark">Bug 32117</span></em></p></li><li class="listitem"><p>Resending of only reliable data from lost packets between client
        and server was disabled in BWT 1.9.4. This has now been re-enabled,
        which should reduce bandwidth usage in high packet loss situations.
        For details about reliable and unreliable data, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Prop_Is_Reliable" class="olink">Bandwidth Optimisation: Is Reliable</a>.</p><p class="remark"><em><span class="remark">Bug 27694</span></em></p></li><li class="listitem"><p>Packets dropped by the artificial packet-loss simulation code
        are now correctly counted in the "Packets Sent" and "Bytes Sent"
        watcher values of a NetworkInterface. For more details about
        introducing artificial packet loss, refer to the
        <span class="literal">externalLossRatio</span> entry in the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_General_Configuration_Options" class="olink">General Configuration Options</a>.</p><p class="remark"><em><span class="remark">Bug 32242</span></em></p></li><li class="listitem"><p>Fixed a bug where, if a teleport failed, the entity's position
        and direction would be incorrectly set to the given destination
        position and direction. This could occur when the mailbox addressed a
        non-existent CellApp. For more details about teleporting, refer to the
        <code class="methodname">Entity.teleport()</code> method entry in the <a href="./html/..//api_python/cellapp/index.html#Client_Python_API" class="olink">Client Python API</a>.</p><p class="remark"><em><span class="remark">Bug 32494 / BW-19545</span></em></p></li><li class="listitem"><p>Fixed a bug where concurrent
        <code class="methodname">giveClientTo()</code> requests to the same proxy
        entity could result in failing a development assertion and failing to
        call back the <code class="methodname">Proxy.onGiveClientToFailure()</code>
        callback. For details about the
        <code class="methodname">giveClientTo()</code> method, refer to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a> section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Proxies_And_Players" class="olink"><i>Proxies and Players</i></a>.</p><p class="remark"><em><span class="remark">Ticket 3821 / Bug 32616</span></em></p></li><li class="listitem"><p>Fixed some bugs related to BaseApp retirement. Channels from
        offloaded proxy entities to clients are now condemned rather than
        being destroyed straight-away, enabling packets critical to switching
        BaseApps to be re-sent.</p><p>Additionally, it was previously possible for some entities to be
        missed when offloading entities from a retiring BaseApp.</p><p>For more details about BaseApp retirement, refer to the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_BaseApp_Retirement" class="olink">BaseApp Retirement</a>.</p><p class="remark"><em><span class="remark">Bug 32518</span></em></p></li><li class="listitem"><p>Fixed a bug in the offline patcher: if either the source or
        destination trees contained zip files, the resulting patch would cause
        crashes when being applied or another revision was being added.
        Offline patching is documented in <span class="olink">????</span>.</p><p class="remark"><em><span class="remark">Bug 32617</span></em></p></li><li class="listitem"><p>Fixed a possible bad Base entity state during restoration of
        Cell entities when two or more CellApps die simultaneously, leaving
        the Base with a Cell mailbox pointing to a non-existent
        CellApp.</p><p class="remark"><em><span class="remark">Bug 32827</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause a CellApp crash when entities
        with non-volatile position updates are on board a moving vehicle.
        Previously, the event history on ghosted entities could become
        out-of-sync from the event history of the real entity.</p><p class="remark"><em><span class="remark">Bug 32831</span></em></p></li></ul></div></div><div class="section" title="5.&nbsp;Deprecation Notices"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1384"></a>5.&nbsp;Deprecation Notices</h2></div></div></div><div class="section" title="5.1.&nbsp;Script API"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1387"></a>5.1.&nbsp;Script API</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The BaseApp method
          <code class="methodname">BigWorld.quantumPassedPercent()</code> has been
          deprecated. It is still available but may be removed in a future
          release.</p><p>To update your code, use the new method
          <code class="methodname">BigWorld.isNextTickPending()</code>. This new
          method returns a boolean indicating whether the current tick has
          exceeded its assigned execution time. This new method differs from
          <code class="methodname">quantumPassedPercent()</code> which returned an
          integer between 0 an 100. Any calculations will need to be updated
          accordingly.</p><p class="remark"><em><span class="remark">Bug 26863</span></em></p></li><li class="listitem"><p>The personality callbacks
          <code class="methodname">onBaseAppReady</code>,
          <code class="methodname">onCellAppReady</code> and
          <code class="methodname">onDBMgrReady</code> have been deprecated by
          <code class="methodname">BWPersonality.onAppReady</code>.</p><p>Similarly, <code class="methodname">onBaseAppShuttingDown</code>,
          <code class="methodname">onBaseAppShutDown</code> and
          <code class="methodname">onCellAppShuttingDown</code> have been replaced by
          <code class="methodname">BWPersonality.onShuttingDown</code> and
          <code class="methodname">BWPersonality.onShutDown</code>.</p><p>These deprecated events are still available but may be removed
          in a future release.</p><p class="remark"><em><span class="remark">Bug 31543</span></em></p></li></ul></div></div><div class="section" title="5.2.&nbsp;Web Integration"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1443"></a>5.2.&nbsp;Web Integration</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The original Python module implementation of the BigWorld
          server Web Integration, located in <code class="filename">bigworld/src/server/web/python</code>, has
          been deprecated. It is currently planned to remove this in BigWorld
          Technology 3.0.</p><p>To update your code, it is recommended to use the new Web
          Service approach using ServiceApps and two way method calls as
          outlined in <a href="./html/server_web_integration/server_web_integration.html#Server_Web_Integration" class="olink">Server Web Integration Guide</a>.</p><p>Documentation for this deprecated functionality has been
          removed in this release. Please refer to the 2.0 documentation if
          you require the old documentation.</p><p class="remark"><em><span class="remark">Bug 32611</span></em></p></li></ul></div></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1461"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>If running the BigWorld Technology Server on a VMWare host,
        ensure that the Network Adapter has been set to E1000. Using the
        VMNet interface types can cause dropped UDP packets and will result
        in server process failures.</p></li><li class="listitem"><p>MySQL 5.1 does not support Unicode characters outside the Basic
        Multilingual Plane (BMP) defined in Unicode Version 3.0 in its UTF8
        character string data type. This implies that BigWorld also does not
        support persistence of characters outside the BMP. MySQL reports that
        this bug will be resolved in MySQL version 6.0, however, as it has not
        been released, no testing has been done.</p></li><li class="listitem"><p>When mapping a space's geometry more than once, problems might
        occur with User Data Objects, multiple User Data Objects will share
        the same GUID.</p><p class="remark"><em><span class="remark">Bug 27018</span></em></p></li><li class="listitem"><p>If a shell without the bottom side in its BSP is placed on an
        outside chunk, NavGen cannot generate a navmesh on both the shell and
        the outside chunk correctly. Navigation will fail if an entity
        attempts to navigate in this shell.</p><p class="remark"><em><span class="remark">Bug 27510</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.8 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1481"></a>BigWorld Technology 2.0.8 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xref_2_0_8_New_Features"></a>1.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Improved the bandwidth usage of method calls and property
        updates sent from the server to the client. Savings will typically be
        between 2 and 6 bytes per message.</p><p>Two main optimisations have been implemented. Previously each
        script message included the entity id. This is now done separately so
        that multiple messages can share this data. For entities with a
        volatile position, four bytes are saved. For non-volatile entities,
        typically 2-4 bytes are saved; 2 for the first message and 4 for
        subsequent messages.</p><p>The second optimisation is dropping the size prefix for any
        script messages that are constant size. For these messages, 2 bytes
        are saved. For variable size messages, 1 byte is now saved.</p><p class="remark"><em><span class="remark">Bug 32152 and Bug 32638</span></em></p></li><li class="listitem"><p>Ghosted cell entities can now have <code class="code">set_*</code> style
        callbacks called when ghosted properties change on the real entity.
        These optional callbacks take the same form as the client-side
        <code class="code">set_*</code> callbacks. For more information, please refer to
        the <a href="./html/server_programming_guide/server_programming_guide.html#xref_Property_Callbacks_On_Ghosted_Entities" class="olink">Property Callbacks On Ghosted Entities</a>.</p><p class="remark"><em><span class="remark">Bug 32654</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1510"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where concurrent
        <code class="methodname">giveClientTo()</code> requests to the same proxy
        entity could result in failing a development assertion and failing to
        call back the <code class="methodname">Proxy.onGiveClientToFailure()</code>
        callback.</p><p class="remark"><em><span class="remark">Ticket 3821 / Bug 32616</span></em></p></li><li class="listitem"><p>Previously, database transactions could be lost if the MySQL
        database was stopped and then restarted. This has been fixed so that
        these transactions will always be applied when the MySQL database is
        restarted.</p><p class="remark"><em><span class="remark">Bug 32647</span></em></p></li><li class="listitem"><p>In 2.0.7, a new feature was added allowing extra information to
        be sent back to the client on a successful login. This was not being
        sent when successfully logging on to an already loaded entity. This
        has now been fixed.</p><p class="remark"><em><span class="remark">Bug 32552</span></em></p></li><li class="listitem"><p>Added "nub" watcher to the Reviver process. Fixes an issue with
        doing Filtered Watcher queries that involve "nub" and all processes
        when a Reviver process is running.</p><p class="remark"><em><span class="remark">Bug 32640</span></em></p></li><li class="listitem"><p>Fixed a potential BaseApp crash if a Proxy is deleted while it
        was loading a file in a background thread. This is related to the use
        of <code class="methodname">Proxy.streamFileToClient()</code>.</p><p class="remark"><em><span class="remark">Bug 32021</span></em></p></li><li class="listitem"><p>Fixed a possible bad Base entity state during restoration of
        Cell entities when two or more CellApps die simultaneously, leaving
        the Base with a Cell mailbox pointing to a non-existent
        CellApp.</p><p class="remark"><em><span class="remark">Bug 32827</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause a CellApp crash when entities
        with non-volatile position updates are on board a moving vehicle.
        Previously, the event history on ghosted entities could become
        out-of-sync from the event history of the real entity.</p><p class="remark"><em><span class="remark">Bug 32831</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.7 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1558"></a>BigWorld Technology 2.0.7 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1561"></a>1.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>When using a custom authentication system with DBMgr, it is now
        possible to send extra information back to the client on a successful
        login.</p><p>This can be used, for example, to allow your authentication
        system to generate an authentication token when a successful username
        and password are first used. This token could then be passed on
        subsequent logins, avoiding the username/password step for players
        when using the same hardware.</p><p>A second example is returning information about current account
        status (e.g. remaining credit).</p><p class="remark"><em><span class="remark">Bug 32552</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1574"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where attempting to create entities from within
        the BaseApp's <code class="methodname">Base.onRestore()</code> callback could
        fail.</p><p class="remark"><em><span class="remark">Ticket 3786 / Bug 32482</span></em></p></li><li class="listitem"><p>Fixed an issue with WebConsole when using a MySQL database backend
        with a database type of InnoDB and a default character set of UTF-8.
        Previously WebConsole could fail to start due to a key size limitation
        error.</p><p class="remark"><em><span class="remark">Ticket 3820</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.6 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1591"></a>BigWorld Technology 2.0.6 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1594"></a>1.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added a new flag <span class="literal">SendLatestOnly</span> that can be
        set on properties that have <span class="literal">OTHER_CLIENTS</span> or
        <span class="literal">ALL_CLIENTS</span> flag (or client methods). If set to
        <span class="literal">true</span>, only the latest message for a property (or a
        method call) is sent to clients instead of a message for each change
        of that property (or repeated call of a method). This can be used to
        save bandwidth.</p><p>Also added flag <span class="literal">IsReliable</span> for the same
        properties and methods. If set to <span class="literal">false</span>, these
        messages will be sent unreliably from the server to the client. If
        there is packet loss, this message will not be delivered.</p><p>Setting <span class="literal">SendLatestOnly</span> to
        <span class="literal">true</span> and <span class="literal">IsReliable</span> to
        <span class="literal">false</span> and changing a value every game tick causes
        behaviour similar to volatile position and direction values.</p><p>This feature can save considerable bandwidth is certain
        situations.</p><p class="remark"><em><span class="remark">Bug 28421</span></em></p></li><li class="listitem"><p>Changed the version numbering scheme sent from the client to
        the server during login. Previously, this was a monotonically
        increasing number (58 in BigWorld 2.0.5). This is now based on the
        BigWorld version number of the release it was last changed in. This
        is now 2.0.6 and will remain as this until a change in a future
        release.</p><p>It is planned to release BigWorld 2.1.0 with protocol 2.0.6.
        This means that it should be possible to connect a 2.0.6 client to
        a 2.1.0 server (and vice-versa).</p><p class="remark"><em><span class="remark">Bug 32520</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1646"></a>BigWorld Technology 2.0.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1649"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a potential crash that could occur late in server
        shutdown. This crash was not serious but could leave core files
        around.</p><p class="remark"><em><span class="remark">Bug: None</span></em></p></li><li class="listitem"><p>Fixed baseApp/externalInterface configuration in bw.xml.
        Previously, this was using loginApp/externalInterface if it was
        specified.</p><p class="remark"><em><span class="remark">Bug: None</span></em></p></li><li class="listitem"><p>Fixed an issue with cell mailboxes on base entities when used
        after the cell entity has been requested to be created, but before
        <code class="methodname">Base.onGetCell()</code> has been called. An
        exception is now raised when such a mailbox is assigned as a value to
        a <code class="code">MAILBOX</code> property or it is used as a
        <code class="code">MAILBOX</code> method argument. This was previously being
        allowed, leading to an assertion failure when the mailbox was used to
        call a method. </p><p class="remark"><em><span class="remark">Bug: 32024</span></em></p></li><li class="listitem"><p>Fixed a potential recurring relogin failure that could occur
        when a previous logout fails due to a DBMgr death.</p><p class="remark"><em><span class="remark">Bug 31881 / Ticket 3478</span></em></p></li><li class="listitem"><p>Enable buffering of createEntity messages on CellApps to
        ensure that a CellApp death doesn't cause the CellApp to which
        entities are restored to stop responding to, and be killed by,
        the CellAppMgr.</p><p class="remark"><em><span class="remark">Bug 32025 / Ticket 3559</span></em></p></li><li class="listitem"><p>Fixed a potential DBMgr crash that could occur when reviving
        a failed DBMgr while a <code class="methodname">writeToDB()</code>
        request for a new entity was outstanding.</p><p class="remark"><em><span class="remark">Bug: None</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause an incorrect reply to some
        network request messages. This was showing up as the callback for
        <code class="code">BigWorld.createBaseAnywhereFromDBID()</code> being called with
        incorrect values.</p><p class="remark"><em><span class="remark">Ticket: 3607</span></em></p></li><li class="listitem"><p>Fixed an issue that would cause a base entity not to be backed up
        if <code class="code">Base.shouldAutoBackup</code> is <code class="code">BigWorld.NEXT_ONLY</code>
        when a Base entity is restored.</p><p class="remark"><em><span class="remark">Bug: 32154/Ticket: 3630</span></em></p></li><li class="listitem"><p>Fixed an issue where Base entities that were registered as a
        <code class="property">globalBase</code> and were destroyed during the
        <code class="methodname">onRestore()</code> callback would not have their
        <code class="property">globalBase</code> entries removed.</p><p class="remark"><em><span class="remark">Bug: 32154/Ticket: 3630</span></em></p></li><li class="listitem"><p>Fixed an issue where Base entities that called
        <code class="methodname">deregisterGlobally()</code> during the
        <code class="methodname">onRestore()</code> callback would not have their
        <code class="property">globalBase</code> entry removed.</p><p class="remark"><em><span class="remark">Bug: 32154/Ticket: 3630</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1742"></a>BigWorld Technology 2.0.4 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1745"></a>1.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Client entity creation for non-volatile entities will now send
        detailed direction updates to the client for the initial entity
        creation message.</p><p>Previously the initial entity creation message contained
        optimised low precision direction information which could cause an
        entity to face in an undesired direction.</p><p class="remark"><em><span class="remark">Bug: 31888</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1756"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Downgraded an error message to a warning for missing file
        descriptors in the event poller. This is due to situations where
        normal usage of the web integration module caused this error to be
        emitted in benign cases.</p><p class="remark"><em><span class="remark">Bug: 31625 / Ticket: 3298</span></em></p></li><li class="listitem"><p>The BaseAppMgr's <span class="literal">cellAppMgr</span> watcher path is
        now correct after a CellAppMgr restart or revival.</p><p class="remark"><em><span class="remark">Bug: 31673</span></em></p></li><li class="listitem"><p>DBMgr now successfully loads fixed size persistent
        <span class="literal">ARRAY</span> properties that were added or had their size
        modified on an existing entity in a MySQL database.</p><p>SyncDB does not populate fixed size <span class="literal">ARRAY</span>
        tables (eg: <span class="literal">tbl_Avatar_newarray</span>) with default
        values for all entries in the parent table. When the entity is loaded
        from the database the property will be adjusted, either adding default
        values or removing excess values from the end of the array, before
        streaming the entity to the BaseApp.</p><p class="remark"><em><span class="remark">Bug: 31673</span></em></p></li><li class="listitem"><p>Fixed a bug in code relating to the script call to
        <code class="methodname">Base.writeToDB()</code> that could cause an invalid
        memory access, resulting in a segmentation fault.</p><p class="remark"><em><span class="remark">Bug: 31837</span></em></p></li><li class="listitem"><p>Fixed a problem that would cause
        <code class="methodname">BigWorld.addTimer()</code> to lose precision when
        the game time gets larger.</p><p>Additionally, the <code class="varname">initialOffset</code> and
        <code class="varname">repeatOffset</code> values are now rounded instead of
        truncated when converting to game ticks.</p><p class="remark"><em><span class="remark">Bug: 31851</span></em></p></li><li class="listitem"><p>Fixed a problem with batch Watcher queries that would fail when
        more than 1024 processes were queried in a single batch
        request.</p><p><em class="emphasis">NB:</em> This fix only applies to
        TCP watcher requests. The old UDP watcher request mechanism which is
        used in BigWorld Technology 1.9 server processes are still potentially
        susceptible to this issue.</p><p class="remark"><em><span class="remark">Bug: 31832</span></em></p></li><li class="listitem"><p>Fixed race conditions that could lead to a critical failure on
        the BaseApp due to the failure of the assertion <code class="code">pProxyPusher!=
        NULL</code>.</p><p class="remark"><em><span class="remark">Bug: 31822</span></em></p></li><li class="listitem"><p>Fixed a bug where navigation could enter an infinite loop while
        doing an Astar search.</p><p class="remark"><em><span class="remark">Ticket: 3489</span></em></p></li><li class="listitem"><p>Fixed a bug where navigation may not return the optimal path
        because it gets an incorrect position from its neighbour.</p><p class="remark"><em><span class="remark">Ticket: 3489</span></em></p></li><li class="listitem"><p>Fixed a bug where the connection between two neighbouring chunks
        was incorrect because a chunk was not trying to find an exact match on
        the other side.</p><p class="remark"><em><span class="remark">Ticket: 3489</span></em></p></li><li class="listitem"><p>Fixed a bug where finding a navmesh for a given position may
        have only returned a navmesh if it was adjacent to another
        chunk.</p><p class="remark"><em><span class="remark">Ticket: 3489</span></em></p></li><li class="listitem"><p>Fixed a potential BaseApp crash when
        <code class="methodname">Base.destroy()</code> was called from within the
        <code class="methodname">Proxy.onRestore()</code> method.</p><p class="remark"><em><span class="remark">Bug #31911 / Ticket: 3502</span></em></p></li><li class="listitem"><p>Fixed a bug where two navmeshes on opposite sides of a chunk
        boundary might not be able to connect to one another if they differ in
        height.</p><p class="remark"><em><span class="remark">Ticket: 3489</span></em></p></li><li class="listitem"><p>Fixed some issues with the proxy rate limit message filter that
        could cause buffered proxy messages to be played back on the wrong
        proxy entities.</p><p class="remark"><em><span class="remark">Bug #31743</span></em></p></li><li class="listitem"><p>Fixed an issue where an invalid BaseApp address could be sent to
        the client when <code class="methodname">Proxy.giveClientTo()</code> is
        called with a proxy on another BaseApp. A Python exception will now be
        raised in this case.</p><p class="remark"><em><span class="remark">Bug #31630</span></em></p></li><li class="listitem"><p>Fixed an issue where an entity might have slowed down during
        navigation when crossing a navmesh boundary.</p><p class="remark"><em><span class="remark">Bug #31907</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1884"></a>BigWorld Technology 2.0.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1887"></a>1.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added configuration option
        <span class="literal">cellApp/maxTickStagger</span> to
        <code class="filename">bw.xml</code>. This adds the ability to stagger the
        CellApp update ticks.</p><p>If all CellApps are synchronised, the network load that can be
        produced by a cluster can be very spikey. Having each CellApp produce
        its traffic at offset times helps to spread the traffic out over time.
        This helps avoid packet loss for some network hardware.</p><p>This packet loss is most likely to occur upstream in your
        connection to the internet. If a large amount of packet loss is noticed
        with a large number of clients connected, consider increasing this
        value.</p><p>For more information on the <span class="literal">maxTickStagger</span>
        option, see the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> chapter
        <a href="./html/server_operations_guide/server_operations_guide.html#xref_Server_Configuration_With_bw_xml" class="olink"><i>Server Configuration with <span class="literal">bw.xml</span></i></a>.</p><p class="remark"><em><span class="remark">Bug 31621</span></em></p></li><li class="listitem"><p>Added a property <code class="code">Entity.artificialLoad</code> to the cell
        entity. This allows an entity to add an artificial amount of load to
        the calculated load that is used for load balancing. It is useful if
        you have an entity or space that often has periods of low load but can
        quickly change. For further information see the CellApp Python API
        documentation.</p><p class="remark"><em><span class="remark">Bug 28438</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1923"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where destroying a Proxy during or soon after a
        giveClientTo() operation, could cause a BaseApp crash.</p><p class="remark"><em><span class="remark">Bug: 31617 / Ticket: 3301</span></em></p></li><li class="listitem"><p>Fixed an issue where the handler for
        <code class="code">BigWorld.registerWriteFileDescriptor()</code> was not being called
        if an error occurred. Only calling of the read handler was attempted,
        even if there was only a write handle for that file descriptor.</p><p class="remark"><em><span class="remark">Bug 31684 / Ticket 3351</span></em></p></li><li class="listitem"><p>Added better tracking of relogin attempts as well as a timeout
        for old pending logins.</p><p class="remark"><em><span class="remark">Bug 31669</span></em></p></li><li class="listitem"><p>Fixed an issue with RPM building scripts where the output from
        SVN commands was not being properly read, causing the scripts to
        sometimes exit prematurely.</p><p class="remark"><em><span class="remark">No associated bug</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1950"></a>BigWorld Technology 2.0.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1953"></a>1.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Previously when the <code class="filename">bw.xml</code> option
        <span class="literal">&lt;baseApp&gt;&lt;backUpUndefinedProperties&gt;</span>
        was set to <span class="literal">true</span>, properties defined in the
        <span class="literal">&lt;TempProperties&gt;</span> section of the Entity
        definition file were still included in Entity backups. This behaviour
        has been changed so that the <span class="literal">&lt;TempProperties&gt;</span>
        are no longer backed up in any circumstance.</p><p class="remark"><em><span class="remark">Bug: 31505 / Ticket : 3077</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1977"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue that could cause
        <span class="literal">NavigationController</span> instances added via
        <code class="methodname">Entity.navigate()</code> to be ineffective, and
        cause a CellApp crash if it was called for a destination that was not
        navigable.</p><p class="remark"><em><span class="remark">Bug: None</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause a DBMgr assertion if
        <code class="code">Base.writeToDB()</code> is called twice quickly on a new entity
        that does not have a unique <span class="literal">Identifier</span>
        property.</p><p class="remark"><em><span class="remark">Ticket: 2958</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause secondary DB consolidation to
        fail when an entity had been deleted from the primary database.</p><p class="remark"><em><span class="remark">Ticket: 2829</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause DBMgr to crash when looking up
        an Entity by Identifier when the Entity definition did not describe an
        Identifier field. A script error is now thrown instead to warn the
        user of the mistake.</p><p class="remark"><em><span class="remark">Ticket: 2882</span></em></p></li><li class="listitem"><p>Fixed an issue with acknowledgements for physics corrections.
        Previously, it was possible for a development assertion to fail if a
        client was given to another proxy while a physics correction was on
        the wire.</p><p class="remark"><em><span class="remark">Ticket: 2928</span></em></p></li><li class="listitem"><p>Fixed an issue that could cause a CellApp to crash (assertion
        failure) when entities are offloaded soon after a new cell has been
        added to a space.</p><p class="remark"><em><span class="remark">Ticket: 2928</span></em></p></li><li class="listitem"><p>Fixed an issue with the offline patcher, where it would abort
        prematurely when attempting to patch an empty source file.</p><p class="remark"><em><span class="remark">Bug: 31484</span></em></p></li><li class="listitem"><p>Fixed a problem with bwmachined when the default broadcast route
        is a multihomed interface.</p><p class="remark"><em><span class="remark">Bug: 27742</span></em></p></li><li class="listitem"><p>Improved the robustness of calling
        <code class="classname">Proxy</code>.<code class="methodname">giveClientTo()</code>
        to give a client connection a remote BaseApp's proxy via a mailbox.
        This was previously unreliable under packet loss.</p><p class="remark"><em><span class="remark">Bug: 31509 / Ticket : 3076</span></em></p></li><li class="listitem"><p>Fixed a crash that could occur if there was packet reordering
        (potentially due to loss) on a multi-packet bundle when not sent on a
        channel. This is most likely to occur if using the server's Web
        Integration.</p><p class="remark"><em><span class="remark">Ticket: 3104</span></em></p></li><li class="listitem"><p>Fixed an issue causing some of the network-related statistics
        with exponential averages to be wrongly calculated.</p><p class="remark"><em><span class="remark">Bug: 31492</span></em></p></li><li class="listitem"><p>Fixed an issue with DBMgr's MySQL implementation that could
        cause streaming errors if a transaction rollback occurred during the
        middle of an entity read or write.</p><p class="remark"><em><span class="remark">Bug: 31513 / Ticket: 3113</span></em></p></li><li class="listitem"><p>Fixed an issue with StatLogger crashing when working with a data
        set describing more than a year's worth of samples.</p><p class="remark"><em><span class="remark">Bug: None</span></em></p></li><li class="listitem"><p>If a player and a non-volatile entity were teleported together
        using the cell entity's <code class="code">Entity.teleport()</code> method, it was
        possible that the client may not be updated with the correct space of
        the non-volatile entity. This has now been fixed.</p><p class="remark"><em><span class="remark">Bug: 31508 / Ticket: 3085</span></em></p></li><li class="listitem"><p>Fixed a problem where acceleration movement controllers
		(<code class="code">accelerateToPoint</code>, <code class="code">accelerateToEntity</code>,
		and <code class="code">accelerateAlongPath</code>) with a facing style of
		<code class="code">FACING_VELOCITY</code> would reset the yaw to 0 when it arrived
		at the destination point, if the <code class="code">stopAtDestination</code>
		parameter was True.</p><p class="remark"><em><span class="remark">Bug: 31512</span></em></p></li><li class="listitem"><p>Fixed an issue with using negative indices for subscription and
		slice accesses for ARRAY typed values that could lead to memory
		corruption.</p><p class="remark"><em><span class="remark">Bug: 31535</span></em></p></li><li class="listitem"><p>Fixed an issue where a multiple writeToDB requests for a new
        Entity could be incorrectly buffered which would lead to a DBMgr
        assertion.</p><p class="remark"><em><span class="remark">Bug: 31584 / Ticket: 3209</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2102"></a>BigWorld Technology 2.0.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2105"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added missing files in the Full Source package that were
        preventing the package from being compiled.</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 2.0 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2112"></a>BigWorld Technology 2.0 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2115"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 2.0 is the latest version of the BigWorld
        Technology engine.</p></li></ul></div></div><div class="section" title="2.&nbsp;Important Notes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2122"></a>2.&nbsp;Important Notes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The release number system has changed. Previously, there were
        two digits assigned to a major release version (e.g. 1.9), an extra
        digit for the minor release version (e.g. 1.9.6) and a final, fourth
        digit for the patch version (e.g. 1.9.6.7). Major release versions now
        have a single digit. The full version number now has three digits
        (e.g. 2.0.0).</p></li><li class="listitem"><p>In order to make the source code location for BigWorld
        components consistent, the
        <code class="filename"><em class="replaceable"><code>trunk</code></em>/src</code> directory
        has been moved to
        <code class="filename"><em class="replaceable"><code>trunk</code></em>/bigworld/src</code>.
        This needs to be considered when merging source code changes from
        previous versions to the latest version.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="xref_2_0_0_New_Features"></a>3.&nbsp;New Features</h2></div></div></div><div class="section" title="3.1.&nbsp;Script &amp; Script API"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2145"></a>3.1.&nbsp;Script &amp; Script API</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A number of new features have been added to help working with
          multiple spaces.</p><p><code class="classname">Base</code><code class="methodname">.createCellEntity()</code>
          now accepts a base mailbox in place of the cell mailbox. This makes
          it easy to find the creation location in
          <code class="classname">BigWorld</code><code class="methodname">.globalBases</code>.</p><p>The <code class="methodname">__init__</code> methods of cell entities
          will now be given the entity that was used in
          <code class="classname">Base</code><code class="methodname">.createCellEntity()</code>.
          This allows setting of the initial entity location on the cell
          entity rather than via the base entity's <code class="varname">cellData[
          "position" ]</code>.</p><p>A new script method
          <code class="classname">Base</code><code class="methodname">.teleport()</code> has
          been added. It takes a base entity mailbox that indicates the entity
          that this entity should be teleported to.
          <code class="classname">Entity</code><code class="methodname">.onTeleportSuccess()</code>
          is called on success and is passed the destination entity. This is
          useful for setting the position of the teleporting entity.</p><p class="remark"><em><span class="remark">Bug 27418</span></em></p></li><li class="listitem"><p>Added
          <code class="classname">BigWorld</code>.<code class="methodname">addTimer()</code>
          and
          <code class="classname">BigWorld</code>.<code class="methodname">delTimer()</code>
          script methods to CellApp.</p></li><li class="listitem"><p>Added BigWorld.getSpaceGeometryMappings() to CellApp, which
          retrieves the client-server geometry mappings for a space.</p><p class="remark"><em><span class="remark">Bug 27871</span></em></p></li><li class="listitem"><p><code class="varname">BigWorld.globalBases</code>,
          <code class="varname">BigWorld.baseAppData</code>,
          <code class="varname">BigWorld.cellAppData</code> and
          <code class="varname">BigWorld.globalData</code> now have a
          <code class="methodname">get()</code> method like Python
          dictionaries.</p><p class="remark"><em><span class="remark">Bug 27764</span></em></p></li><li class="listitem"><p><span class="literal">ARRAY</span> data type instances now have a method
          <code class="methodname">equals_seq()</code> for performing Boolean
          equality testing against an arbitrary Python sequence. This
          alleviates the need to cast <span class="literal">ARRAY</span> instances into
          appropriate types prior to performing an equality test with Python
          lists and tuples.</p><p class="remark"><em><span class="remark">Bug 27864</span></em></p></li></ul></div></div><div class="section" title="3.2.&nbsp;Entity Definitions &amp; Property Types"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2242"></a>3.2.&nbsp;Entity Definitions &amp; Property Types</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added a new data type, <span class="literal">UNICODE_STRING</span>,
          which allows assignment of Python Unicode string objects. Persistent
          <span class="literal">UNICODE_STRING</span> properties require 3 bytes per
          character for storage in MySQL. The BigWorld MySQL database now use
          UTF-8 as their character set, as do the connections to those
          databases.</p><p>For more information, please refer to the <a href="./html/server_programming_guide/server_programming_guide.html#xref_STRING_UNICODE_STRING_BLOB_and_data_types" class="olink"><span class="type">STRING</span>, <span class="type">UNICODE_STRING</span>,
      <span class="type">BLOB</span>, and <span class="type">PYTHON</span> Data Types</a>.</p></li><li class="listitem"><p>A new section <span class="literal">&lt;TempProperties&gt;</span> is now
          supported in <code class="filename">.def</code> files to allow specifying
          properties that are not backed up or offloaded. These should
          generally be rare but are useful for properties that cannot be
          streamed such as sockets or properties that are recreated on
          restoring.</p><p class="remark"><em><span class="remark">Bug 20228</span></em></p></li><li class="listitem"><p>ARRAY data type instances now have a method equals_seq() for
          performing Boolean equality testing against an arbitrary Python
          sequence. This alleviates the need to cast ARRAY instances into
          appropriate types prior to performing an equality test with Python
          lists and tuples.</p><p class="remark"><em><span class="remark">Bug 27864</span></em></p></li></ul></div></div><div class="section" title="3.3.&nbsp;Database &amp; Billing Systems"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2275"></a>3.3.&nbsp;Database &amp; Billing Systems</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>It is now a lot easier to integrate an external billing system
          and account authentication with the BigWorld server. This can be
          done in Python or C++ in DBMgr.</p><p class="remark"><em><span class="remark">Bug 27583</span></em></p></li></ul></div></div><div class="section" title="3.4.&nbsp;FantasyDemo &amp; Examples"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2284"></a>3.4.&nbsp;FantasyDemo &amp; Examples</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>FantasyDemo XMPP integration. The FantasyDemo client is now
          also a lightweight XMPP client which can send/receive messages and
          presence notifications to any other XMMP client (e.g. GAIM, Pidgin).
          This is an example of connecting to external service in a
          non-blocking manner via
          <code class="classname">BigWorld</code><code class="methodname">.registerFileDescriptor()</code>.</p></li></ul></div></div><div class="section" title="3.5.&nbsp;Fault Tolerance &amp; Disaster Recovery"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2296"></a>3.5.&nbsp;Fault Tolerance &amp; Disaster Recovery</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added
          <code class="classname">Entity</code>.<code class="varname">shouldAutoBackup</code>
          property. This allows disabling automatic backing up of cell
          entities to their base entity.</p><p class="remark"><em><span class="remark">Bug 26377</span></em></p></li></ul></div></div><div class="section" title="3.6.&nbsp;Cluster Management"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2311"></a>3.6.&nbsp;Cluster Management</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BaseApps can now be retired while the server is running. Base
          entities are offloaded to other BaseApps, and connected clients are
          transparently reconnected to their proxy entities on destination
          BaseApps. To trigger a BaseApp retirement, there is a new
          <em class="emphasis">Retire App</em> action in the action menu for
          BaseApps in WebConsole/ClusterControl. There is also a new
          <span class="literal">retireproc</span> command for the
          <span class="command"><strong>control_cluster.py</strong></span> command line tool.</p><p>See the <a href="./html/server_operations_guide/server_operations_guide.html#xref_Controlled_Startup_And_Shutdown" class="olink"><i>Controlled Startup and Shutdown</i></a> for more
          details.</p><p class="remark"><em><span class="remark">Bug 24187</span></em></p></li></ul></div></div><div class="section" title="3.7.&nbsp;Miscellaneous"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2333"></a>3.7.&nbsp;Miscellaneous</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The server now uses <code class="function">epoll</code> instead of
          <code class="function">select</code> to wait for network activity. This
          improves the scalability of the
          <code class="classname">BigWorld</code><code class="methodname">.registerFileDescriptor()</code>
          implementation.</p><p class="remark"><em><span class="remark">Bug 25734</span></em></p></li><li class="listitem"><p>Watchers can now be fetched via TCP. Previously, only UDP was
          supported. This caused there to be a maximum size for the watcher
          query results.</p><p class="remark"><em><span class="remark">Bug 6353</span></em></p></li><li class="listitem"><p>There are now options to compress some of the network traffic.
          See the networkCompression options in bw.xml for more
          details.</p><p class="remark"><em><span class="remark">Bug 27744</span></em></p></li></ul></div></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2363"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="section" title="4.1.&nbsp;General"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2366"></a>4.1.&nbsp;General</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In order to make the source code location for BigWorld
          components consistent, the
          <code class="filename"><em class="replaceable"><code>trunk</code></em>/src</code> folder has
          been moved to
          <code class="filename"><em class="replaceable"><code>trunk</code></em>/bigworld/src</code>.
          This needs to be considered when merging source code changes from
          previous versions to the latest version.</p><p class="remark"><em><span class="remark">Bug 10156</span></em></p></li><li class="listitem"><p>The internal Python library has been updated to version
          2.6.4.</p><p class="remark"><em><span class="remark">Bug 27310</span></em></p></li><li class="listitem"><p>The SQLite library has been upgraded to version 3.6.23.</p></li><li class="listitem"><p>The CPU time spent in the main thread while loading chunks is
          5 to 10 times less than before.</p><p class="remark"><em><span class="remark">Bug 27401</span></em></p></li><li class="listitem"><p>Navigation meshes in memory are now more compact through the
          use of an indexing scheme for the vertices in nav-poly edges.</p><p class="remark"><em><span class="remark">Bug 27787</span></em></p></li></ul></div></div><div class="section" title="4.2.&nbsp;Script &amp; Script API"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2403"></a>4.2.&nbsp;Script &amp; Script API</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The
          <code class="classname">Proxy</code>.<code class="methodname">giveClientTo()</code>
          method can now accept a base mailbox to a proxy on a remote BaseApp
          for transferring the client. This relaxes the restriction that the
          destination proxy has to reside on the same BaseApp as the source
          proxy.</p></li><li class="listitem"><p><code class="classname">BigWorld</code>.<code class="methodname">PatrolPath</code>
          has been removed. User Data Object PatrolNode should be used for
          creating patrol paths in space.</p></li><li class="listitem"><p>The Cell entity property
          <code class="property">Entity.aoiPriority</code> has been removed. This has
          been replaced by the <code class="property">Entity.aoiUpdateScheme</code>
          property and <code class="methodname">Entity.setAoIUpdateScheme()</code>
          method. These allow greater control of the update rate based on
          distance and also allows specifying for a specific instance of an
          entity in an AoI.</p><p class="remark"><em><span class="remark">Bug 27230</span></em></p></li><li class="listitem"><p>There is a new scripts path <code class="filename">server_common</code> under the resource path
          <code class="filename">scripts</code>. Modules placed here
          can be loaded by the BaseApp and CellApp, as well as DBMgr for
          importing modules used with class-customised data types. This is
          intended for Python modules that are common between server
          components, but are not distributed with the client.</p><p class="remark"><em><span class="remark">Bug 23026</span></em></p></li><li class="listitem"><p>The deprecated
          <code class="classname">Base</code><code class="varname">.contactDetails</code>
          property has now been removed.</p><p class="remark"><em><span class="remark">Bug 27662</span></em></p></li><li class="listitem"><p>Fixed a bug where the CellApp personality callback
          <code class="methodname">onAllSpaceGeometryLoaded()</code> was not being
          called back when auto-loading space data from the database.</p><p class="remark"><em><span class="remark">Bug 27871</span></em></p></li><li class="listitem"><p>The script method
          <code class="classname">Entity</code><code class="varname">.addPortalConfig</code> has
          been replaced by
          <code class="classname">Entity</code><code class="varname">.setPortalState</code>.</p><p>An identical method has been added to the client
          entity.</p><p class="remark"><em><span class="remark">Bug 26400</span></em></p></li></ul></div></div><div class="section" title="4.3.&nbsp;Entity Definitions &amp; Property Types"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2484"></a>4.3.&nbsp;Entity Definitions &amp; Property Types</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="literal">&lt;Volatile&gt;</span> settings can now be placed
          in interface <code class="filename">.def</code> files.</p><p class="remark"><em><span class="remark">Bug 26039</span></em></p></li><li class="listitem"><p>The <code class="filename">bw.xml</code> option,
          <span class="literal">baseApp/backUpUndefinedProperties</span> now defaults to
          <span class="literal">false</span>. It is recommended that each property
          requiring backup should be included in the entity's
          <code class="filename">.def</code> file.</p><p class="remark"><em><span class="remark">Bug 20228</span></em></p></li></ul></div></div><div class="section" title="4.4.&nbsp;Database &amp; Billing Systems"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2515"></a>4.4.&nbsp;Database &amp; Billing Systems</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A number of <code class="filename">bw.xml</code> options have
          changed.</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><span class="literal">dbMgr/createUnknown</span> is now
              <span class="literal">billingSystem/shouldAcceptUnknownUsers</span>.</p></li><li class="listitem"><p><span class="literal">dbMgr/rememberUnknown</span> is now
              <span class="literal">billingSystem/shouldRememberUnknownUsers</span>.</p></li><li class="listitem"><p><span class="literal">dbMgr/loadUnknown</span> has been replaced by
              <span class="literal">billingSystem/authenticateViaBaseEntity</span>.</p></li><li class="listitem"><p><span class="literal">dbMgr/entityType</span> is now
              <span class="literal">billingSystem/entityTypeForUnknownUsers</span>.</p></li></ul></div></li><li class="listitem"><p>Added configuration option
          <span class="literal">billingSystem/isPasswordHashed</span> to
          <code class="filename">bw.xml</code>. This indicates whether the password
          stored in the database's <span class="literal">bigworldLogOnMapping</span>
          table is hashed.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This is option is <span class="literal">true</span> by default.
            Running <span class="command"><strong>sync_db</strong></span> will convert existing
            passwords.</p><p>It is not possible to restore the original passwords once
            this is performed.</p></div><p class="remark"><em><span class="remark">Bug 14763</span></em></p></li><li class="listitem"><p>Modified the database's
          <span class="literal">bigworldLogOnMapping</span> table to store the
          <span class="literal">entityID</span> of the associated entity rather than the
          identifying property. This means that it is no longer necessary for
          these entity types to have an identifier property.</p><p>Also, the <span class="literal">typeID</span> column in this table was
          renamed to <span class="literal">entityType</span>.</p></li><li class="listitem"><p>The default collation associated with
          <span class="literal">UNICODE_STRING</span> properties in the MySQL database
          is now <em class="emphasis">utf8_bin</em>. The collation can be changed
          by using the <span class="literal">dbMgr/unicodeString/collation</span> option
          in <code class="filename">bw.xml</code>.</p><p class="remark"><em><span class="remark">Bug 27666</span></em></p></li></ul></div></div><div class="section" title="4.5.&nbsp;Fault Tolerance &amp; Disaster Recovery"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2617"></a>4.5.&nbsp;Fault Tolerance &amp; Disaster Recovery</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <code class="filename">bw.xml</code> option
          <span class="literal">useDefaultSpace</span> now defaults to
          <span class="literal">false</span>. A number of new features have been added
          to help work with multiple spaces. See <a class="xref" href="#xref_2_0_0_New_Features" title="3.&nbsp;New Features">New Features</a>.</p><p class="remark"><em><span class="remark">Bug 27418</span></em></p></li><li class="listitem"><p>Persistent entities can now be individually flagged for
          auto-loading by the database on server startup. Previously, all
          persistent entities that were checked out at the time of the last
          server shutdown were auto-loaded. The following changes were made to
          support this:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>A new argument to the
                <code class="methodname">Base.writeToDB()</code> method,
                <em class="parameter"><code>shouldAutoLoad</code></em>, can be used to indicate
                whether an entity should be auto-loaded by the database when
                the server starts up.</p></li><li class="listitem"><p>The
                <code class="classname">BWPersonality</code><code class="methodname">.onBaseAppReady()</code>
                callback is now called with two Boolean arguments instead of
                the one argument in previous versions. The first argument
                remains as the <em class="parameter"><code>isBootstrap</code></em> argument,
                set to <span class="literal">True</span> for the bootstrap BaseApp. The
                new second Boolean argument indicates whether the database has
                auto-loaded any entities or not.This is useful for seeding
                persistent entities into a newly created database.</p></li><li class="listitem"><p>The <code class="filename">bw.xml</code> option
                <span class="literal">dbMgr/clearRecoveryData</span> has been removed.
                Instead, a new tool called <span class="command"><strong>ClearAutoLoad</strong></span>
                can be used to clear the auto-load data when needed (located
                at
                <code class="filename">bigworld/bin/Hybrid64/commands/clear_auto_load</code>).</p></li></ul></div><p class="remark"><em><span class="remark">Bug 21519</span></em></p></li><li class="listitem"><p>Auto-loading entities and spaces on the XML database is now
          supported.</p><p class="remark"><em><span class="remark">Bug 28022</span></em></p></li></ul></div></div><div class="section" title="4.6.&nbsp;Watchers"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2687"></a>4.6.&nbsp;Watchers</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Watcher values in the <span class="literal">debug</span> and
          <span class="literal">debugging</span> directories have all been moved to
          either the <span class="literal">config</span> or <span class="literal">logger</span>
          directories.</p></li></ul></div></div><div class="section" title="4.7.&nbsp;Server Tools"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2706"></a>4.7.&nbsp;Server Tools</h3></div></div></div><div class="section" title="4.7.1.&nbsp;Message Logger"><div class="titlepage"><div><div><h4 class="title"><a name="d0e2709"></a>4.7.1.&nbsp;Message Logger</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The logger ID associated with processes for the purposes of
            logging with MessageLogger has been changed from an integer type
            to a string type. This option is set for logging processes in
            <code class="filename">bw.xml</code> as the <code class="option">loggerID</code>
            option, and MessageLogger filters LoggerIDs via the
            <code class="option">-l</code> command line option.</p><p>The shipped init-script for MessageLogger does not use the
            <code class="option">-l</code> command line option. Developers who are not
            using the shipped init-script for starting MessageLogger should
            check that if they use -l option but do not wish to use the
            LoggerID filter, they should set it to an empty string instead of
            "0".</p></li></ul></div></div></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2730"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue that could cause messages destined for an old
        client to be delivered to a new client when an entity is taken over
        via
        <code class="classname">BigWorld</code><code class="methodname">.onLogOnAttempt()</code>.</p><p class="remark"><em><span class="remark">Bug 26908</span></em></p></li><li class="listitem"><p>Loading of files required by User Data Objects is now done on
        startup instead of on first use, avoiding file access from the main
        thread when the first User Data Object is created.</p><p class="remark"><em><span class="remark">Bug 17451</span></em></p></li><li class="listitem"><p>Fixed bugs in entity def files that use <span class="literal">True</span>
        or <span class="literal">False</span> as the default value of property type
        <span class="literal">BOOL</span>. <span class="literal">BOOL</span> is actually an alias
        of <span class="literal">UINT8</span> so it only accepts <span class="literal">0</span> or
        <span class="literal">1</span> as its value. Also, a warning message will be
        printed if trying to intepret a non-integer string value as an integer
        when reading it from data section.</p><p class="remark"><em><span class="remark">Bug 25794</span></em></p></li><li class="listitem"><p>Restoring cell entities from a BaseApp when a CellApp dies is
        now spread out over time. This avoid a problem where the BaseAppMgr
        could kill a BaseApp because restoring was taking too long.</p><p class="remark"><em><span class="remark">Bug 25821</span></em></p></li><li class="listitem"><p>Fixed a problem where the
        <code class="methodname">Entity.onLeavingCell()</code> callback, triggered
        via a teleporting entity, was called while there was a partially
        constructed message on the channel to the destination CellApp. If this
        callback generated any traffic on this channel, the teleport message
        would be truncated and crash the destination CellApp.</p><p class="remark"><em><span class="remark">Bug 27350</span></em></p></li><li class="listitem"><p>Fixed a bug where entity navigation cannot pass the space
        geometry boundary when space geometries are loaded with a
        transform.</p><p class="remark"><em><span class="remark">Bug 26963</span></em></p></li><li class="listitem"><p>Improved the calculation of the downstream bandwidth.
        Previously, some internal traffic from the cell entity to the base
        entity was being counted in the downstream calculation, reducing the
        amount sent to clients.</p><p class="remark"><em><span class="remark">Bug 26912</span></em></p></li><li class="listitem"><p>Fixed an issue that could potentially affect users attempting to
        relogin while their existing Proxy was still online. It was possible
        that relogin attempts would never succeed and subsequent login
        attempts would fail reporting that a previous relogin attempt was
        still in progress.</p><p class="remark"><em><span class="remark">Bug 27642</span></em></p></li><li class="listitem"><p>Fixed a bug that caused the position of passenger entities to be
        wrong on the server when the vehicle had non-zero pitch. The server
        was interpretting pitch in the wrong direction.</p><p class="remark"><em><span class="remark">Bug 27031</span></em></p></li><li class="listitem"><p>Fixed an issue where LogViewer could fail to query logs when the
        WebConsole server existed in a different timezone to the browser that
        performed the query.</p><p class="remark"><em><span class="remark">Ticket #2277</span></em></p></li><li class="listitem"><p>Fixed an issue where DBMgr could prematurely stop waiting for
        the sync_db process to terminate, causing hangs when shutting
        down.</p><p class="remark"><em><span class="remark">Ticket #2431 / Bug 27940</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2818"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>MySQL 5.1 does not support Unicode characters outside the Basic
        Multilingual Plane (BMP) defined in Unicode Version 3.0 in its UTF8
        character string data type. This implies that BigWorld also does not
        support persistence of characters outside the BMP. MySQL reports that
        this issue will be resolved in MySQL version 6.0, however, as it has
        not been released, no testing has been done.</p></li><li class="listitem"><p>When mapping a space's geometry more than once, problems might
        occur with User Data Objects, multiple User Data Objects will share
        the same GUID.</p><p class="remark"><em><span class="remark">Bug 27018</span></em></p></li><li class="listitem"><p>If a shell without the bottom side in its bsp is placed on an
        outside chunk, NavGen cannot generate a navmesh on both the shell and
        the outside chunk correctly. Navigation will fail if an entity
        attempts to navigate in this shell.</p><p class="remark"><em><span class="remark">Bug 27510</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.12 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2835"></a>BigWorld Technology 1.9.6.12 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2838"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where some cells could be unable to create ghosts
        or offload entities onto an adjacent cell. This could have occurred if
        a cell was retired using SpaceViewer, and was quickly re-added to the
        same space.</p><p class="remark"><em><span class="remark">Bug: 28164</span></em></p></li><li class="listitem"><p>Fixed an issue where acknowledgements that were destined for an
        old network channel could be processed by a new channel. This could
        occur if a cell entity is destroyed and then quickly recreated in a
        high loss environment.</p><p class="remark"><em><span class="remark">Bug: 28275</span></em></p></li><li class="listitem"><p>Fixed an issue that could leave an entity channel in a bad state
        after base entities have been restored. If this occurred, WARNING
        messages like the following would be seen repeatedly from a
        CellApp.</p><div class="blockquote"><blockquote class="blockquote"><p>Channel::addToReceiveWindow( 10.40.1.101:36772/4462 ):
          Dropping packet from old channel 10.40.1.101:36772 (v0 &lt;
          v1)</p></blockquote></div><p class="remark"><em><span class="remark">Bug: 28187</span></em></p></li><li class="listitem"><p>Anonymous channels no longer time out if the local process was
        the one that paused for longer than the timeout period. Previously, if
        DBMgr blocked for greater than 60 seconds, it would drop its anonymous
        channels such as the channel from the LoginApp.</p><p class="remark"><em><span class="remark">Bug: 28126</span></em></p></li><li class="listitem"><p>Fixed an issue that would cause time synchronisation to no
        longer work after a CellAppMgr had been restored. This would mean that
        the game time of CellApp and BaseApp processes could slowly drift
        apart after this.</p><p class="remark"><em><span class="remark">Bug: 28190</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.11 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2870"></a>BigWorld Technology 1.9.6.11 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2873"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue with CellApp that could cause problems when
        restoring cell entities that were buffered due to high load. If
        CellApp load was consistently high, it might have been a long time
        before all the pending entity restorations were processed. It was
        possible for the cell to be removed in the meantime, causing those
        cell entities to never be restored.</p><p class="remark"><em><span class="remark">Bug: 28025</span></em></p></li><li class="listitem"><p>Fixed a race condition between when CellAppMgr adds a cell to a
        CellApp, and other CellApps offloading or creating ghosts on that
        CellApp. Previously, this could cause assertion failures with ghost
        message buffering.</p><p class="remark"><em><span class="remark">Bug 28036</span></em></p></li><li class="listitem"><p>Fixed a race condition in DBMgr startup which could result in
        tasks being processed before initialisation had been completed.</p><p class="remark"><em><span class="remark">Bug 28051</span></em></p></li><li class="listitem"><p>Fixed a problem that caused the player's client entity to not be
        moved into the new space if the cell entity was teleported while
        <code class="code">Entity.controlledBy == None</code>.</p><p class="remark"><em><span class="remark">Bug 28064/Ticket 2465</span></em></p></li><li class="listitem"><p>Added an assertion to guard against when an anonymous channel is
        recreated after being timed out after 60 seconds. It is undesirable to
        continue running as data will have been lost. </p><p>This avoids side-effects occurring later, such as when a CellApp
        channel to another CellApp times out causing CellApps to become
        incapable of on-loading entities.</p><p class="remark"><em><span class="remark">Bug 28126 / Ticket 2530</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.10 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2907"></a>BigWorld Technology 1.9.6.10 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2910"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue with DBMgr that could cause a new persistent
        entity to be written multiple times to the database.</p><p class="remark"><em><span class="remark">Bug: 26916</span></em></p></li><li class="listitem"><p>Fixed an issue that could leave DBMgr in a state where a base
        entity is reported as being online after it has been destroyed. This
        could occur if the base entity was destroyed immediately after being
        written to the database for the first time.</p><p class="remark"><em><span class="remark">Bug: 27964 / Ticket: 2464</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.9 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2924"></a>BigWorld Technology 1.9.6.9 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2927"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue introduced by the patch done in 1.9.6.8. This
        could cause an assertion to fail when a cell is removed from a
        CellApp.</p><p class="remark"><em><span class="remark">Bug: 27915/Ticket: 2416</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.8 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2936"></a>BigWorld Technology 1.9.6.8 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2939"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a rare race condition that could occur in extreme cases
		where cells from CellApps are being added and then removed repeatedly
		under heavily-loaded situations.  Previously this could cause an
		assertion to fail when processing ghost messages.</p><p class="remark"><em><span class="remark">Ticket: 2416</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.7 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2948"></a>BigWorld Technology 1.9.6.7 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2951"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where a base entity may not be able to be
        destroyed because it is waiting for its cell entity to be destroyed
        first. This is caused by a call to
        <code class="methodname">Base.giveClientTo()</code>, which can cause
        subsequent messages on the same bundle to be dropped. This can include
        the notification that the cell entity has been destroyed.</p><p class="remark"><em><span class="remark">Bug: 27875</span></em></p></li><li class="listitem"><p>Fixed an issue in the networking layer which could cause crashes
        due to assertion failures relating to "<code class="code">Mangled fragment
        footers</code>".</p><p class="remark"><em><span class="remark">Bug 27891 / Ticket 2379</span></em></p></li><li class="listitem"><p>Fixed an issue where applications could be incorrectly
        processing packets on a channel from a previous channel version. In
        particular, this could cause the base entities to process packets from
        a previous incarnation of a recently destroyed cell entity as if it
        came from a newly created cell entity.</p><p class="remark"><em><span class="remark">Bug 27898 / Ticket 2383</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.6 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2976"></a>BigWorld Technology 1.9.6.6 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2979"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><em class="emphasis">IMPORTANT:</em> Fixed an issue that
        could cause corrupted data to be written to and read from the MySQL
        database.</p><p>This was caused by a patch done in 1.9.6.5. It is important to
        upgrade from BigWorld 1.9.6.5.</p><p class="remark"><em><span class="remark">Bug: 27827</span></em></p></li><li class="listitem"><p>Fixed an issue with using <code class="filename">sync_db</code> with
        MySQL 5.1.</p><p class="remark"><em><span class="remark">Bug: 26533</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3000"></a>BigWorld Technology 1.9.6.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3003"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><em class="emphasis">IMPORTANT:</em> Fixed an issue that
        could cause corrupted data to be written to the MySQL database.</p><p>This could occur if an entity has an ARRAY of ARRAY property and
        many of these entities are written at the same time. If MySQL database
        lock contention requires the transaction to be repeated, the second
        attempt could have contained incorrect data.</p><p class="remark"><em><span class="remark">Bug: 27827</span></em></p></li><li class="listitem"><p>Fixed a potential CellApp assertion that could occur if entities
        were teleported together immediately after enter each other's Area of
        Interest.</p><p class="remark"><em><span class="remark">Ticket #2304/Bug 27861</span></em></p></li><li class="listitem"><p>Fixed an issue where cell entity creation could fail when
        CellApp backups were disabled.</p><p class="remark"><em><span class="remark">Ticket #2025</span></em></p></li><li class="listitem"><p>Fixed an issue where some sequences of buffered ghost messages
        on the CellApp were being played back incorrectly. This could cause
        assertions to fail later.</p><p class="remark"><em><span class="remark">Bug 27851</span></em></p></li><li class="listitem"><p>Fixed an issue where the client could crash while trying to
        connect to the server if a previous login attempt failed while
        contacting the BaseApp.</p><p class="remark"><em><span class="remark">Bug 27866</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3036"></a>BigWorld Technology 1.9.6.4 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3039"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue where an entity that is teleporting into an
        indoor chunk newly created space may cause movement issues. This may
        occur if the indoor chunk had not been loaded at the time the
        teleporting entity was placed into the space.</p><p class="remark"><em><span class="remark">Ticket #2110</span></em></p></li><li class="listitem"><p>Fixed a problem that could cause User Data Objects to be
        unloaded too early. This would occur when there are multiple spaces
        that have the same geometry mapped. If one of these spaces was
        unloaded, the User Data Objects for all spaces would be
        unloaded.</p><p class="remark"><em><span class="remark">Bug: 27714</span></em></p></li><li class="listitem"><p>Fixed an issue where requesting a slice by only providing the
        start index could return an empty list, for example
        <code class="code">entity.listProp[1:]</code>.</p><p class="remark"><em><span class="remark">Ticket #1959</span></em></p></li><li class="listitem"><p>Fixed a memory leak in DBMgr introduced by the addition of
        <code class="classname">BufferedEntityTask</code> in BigWorld 1.9.6.0.</p><p class="remark"><em><span class="remark">Ticket #1951</span></em></p></li><li class="listitem"><p>Fixed a problem caused by calling
        <code class="code">Base.createCellEntity()</code> with a cell mailbox that has not
        yet been initialised. A base entities cell mailbox is only properly
        initialised when its <code class="code">Base.onGetCell</code> callback is
        called.</p><p class="remark"><em><span class="remark">Bug 27381</span></em></p></li><li class="listitem"><p>Fixed a problem that could cause teleporting an entity to fail.
        Previously, when an entity teleports between two CellApps that have
        not communicated prior to the teleport, if the first packet is
        dropped, the channel may be in a bad state and the teleport
        information could be stuck on the channel indefinitely.</p><p class="remark"><em><span class="remark">Ticket #1859 / Bug 27379</span></em></p></li><li class="listitem"><p>Fixed an issue with base entities getting into a state where
        they could not be destroyed due to a pending cell entity destroy
        operation. The timeout for condemned channels has been extended to
        prevent premature dumping of un-acknowledged pending outgoing packets
        on condemned channels.</p><p class="remark"><em><span class="remark">Ticket #1633</span></em></p></li><li class="listitem"><p>Fixed a problem introduced in 1.9.6.3 that can cause a CellApp
        crash if a cell is removed from a space and then reintroduced before
        chunks that were loading had been discarded.</p><p class="remark"><em><span class="remark">Bug 27611</span></em></p></li><li class="listitem"><p>Fixed an issue with server controlled Witnesses receiving
        incorrect position updates when being a passenger.</p><p class="remark"><em><span class="remark">Bug 27262</span></em></p></li><li class="listitem"><p>Fixed a rare assertion that could occur when network loss was
        occurring and the number of buffered packets exactly matched the size
        of the buffered packets array.</p><p class="remark"><em><span class="remark">Bug 27262</span></em></p></li><li class="listitem"><p>Fixed a bug with sending oversized Mercury message requests.
        Previously, the sending side was clobbering the length field in a
        variable length message, causing crashes on the receiving side.</p><p class="remark"><em><span class="remark">Bug 27660</span></em></p></li><li class="listitem"><p>Fixed a bug that could cause out-of-order property updates being
        sent down to the client when an entity changes detail levels, or when
        two entities teleport together.</p><p class="remark"><em><span class="remark">Bug 27687</span></em></p></li><li class="listitem"><p>Fixed a memory leak caused by requests on channels.</p><p class="remark"><em><span class="remark">Bug 27700</span></em></p></li><li class="listitem"><p>Fixed an issue when player entities in the same AoI teleport
        together. Previously, there was a chance that some updates on
        properties made just before the teleport were not being propagated on
        the next update after they finish teleporting into the new
        space.</p><p class="remark"><em><span class="remark">Bug 27710</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3125"></a>BigWorld Technology 1.9.6.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3128"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a problem that could cause sub-elements of properties of
        ghost entities to not be updated.</p><p class="remark"><em><span class="remark">Bug 27353</span></em></p></li><li class="listitem"><p>Fixed a potential CellApp crash caused by a race condition when
        creating and removing cells.</p><p class="remark"><em><span class="remark">Bug 27309</span></em></p></li><li class="listitem"><p>Fixed a bug that could cause incorrect space data to be
        associated with a space. If a cell was removed from a space and then
        added back shortly after, old space data values that should have been
        removed during that period of time were still being kept.</p><p class="remark"><em><span class="remark">Bug 27342</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3147"></a>BigWorld Technology 1.9.6.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3150"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added the missing src/lib/third_party_integration library and bigworld/src/server/web library. </p><p class="remark"><em><span class="remark">Ticket # 1799</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.6.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3159"></a>BigWorld Technology 1.9.6.1 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.6 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3164"></a>BigWorld Technology 1.9.6 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3167"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.6 is the latest version of the BigWorld
        Technology engine. This version contains multiple bug fixes which do
        not require complicated merges. Future 1.9 releases are expected to
        mainly contain bug fixes.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3174"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Multiple bug fixes were done in this version.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3181"></a>3.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added new methods
        <code class="methodname">BigWorld.navigatePathPoints()</code> and
        <code class="methodname">Entity.navigatePathPoints()</code>.</p><p>These methods perform a navigation search without moving the
        entity. The returned list of points from source to destination are the
        same as the points the entity would move to using
        <code class="methodname">navigateStep()</code>.</p><p class="remark"><em><span class="remark">Bug 26880</span></em></p></li><li class="listitem"><p>Added options to periodically save and archive the XML
        database.</p><p class="remark"><em><span class="remark">Bug 27118</span></em></p></li><li class="listitem"><p>Added
        <code class="classname">Base</code>.<code class="varname">shouldAutoBackup</code>
        property. This allows disabling of automatic backing up of base
        entities to other BaseApps.</p><p class="remark"><em><span class="remark">Bug 27074</span></em></p></li><li class="listitem"><p>Added
        <code class="classname">Base</code>.<code class="varname">shouldAutoArchive</code>
        property. This allows disabling of automatic archiving up of base
        entities to the database.</p><p class="remark"><em><span class="remark">Bug 27074</span></em></p></li></ul></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3228"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The constant
        <code class="varname">BigWorld.SHOULD_AUTO_BACKUP_NEXT_ONLY</code> has been
        renamed to <code class="varname">BigWorld.NEXT_ONLY</code>. This constant is
        used for the <code class="varname">shouldAutoBackup</code> property for base and
        cell entities, and the <code class="varname">shouldAutoArchive</code> property
        for base entities.</p><p class="remark"><em><span class="remark">Bug 27074</span></em></p></li></ul></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3249"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Set the log level severity for the error message "Failed to get
        stream on client method" to be more appropriate under conditions where
        the underlying cause is expected.</p><p>There can be a small time window after a proxy entity loses its
        client (either by disconnection, timeout, or via script) and before
        the cell entity has been informed about this change of state, where
        the cell entity has sent down to the proxy messages intended for the
        client. In this case, these messages are dropped (as they were
        previously), but now they are NOTICE level messages if they occur
        within an arbitary short period of time (currently 1 second).</p><p class="remark"><em><span class="remark">Bug 27090 / Ticket 1510</span></em></p></li><li class="listitem"><p>Added extra checks to ensure that mailboxes are never sent on
        network channels that point to an invalid address. This was causing
        assertion failures to occur occasionally if the address was set to
        <code class="code">Address::NONE</code>.</p><p class="remark"><em><span class="remark">Bug 26845 / Ticket 1340</span></em></p></li><li class="listitem"><p>Added some extra checks if a bounding box was inside-out for a
        resource being loaded, with extra log messages identifying that exact
        resource. This was previously causing assertion failures on the
        server.</p><p class="remark"><em><span class="remark">Bug 27023 / Ticket 1491</span></em></p></li><li class="listitem"><p>Added comparison functions for ARRAY and FIXED_DICT objects,
        previously instances of these property types would always compare
        False.</p><p class="remark"><em><span class="remark">Bug 26958 / Ticket 1447</span></em></p></li><li class="listitem"><p><code class="code">self.myArray[:]</code> now generates a new list instead of
        returning <code class="code">self.myArray</code> for <code class="code">ARRAY</code>
        properties.</p><p class="remark"><em><span class="remark">Ticket 1616</span></em></p></li><li class="listitem"><p><code class="filename">mlcat.py</code> will now work correctly when
        specifying a log directory to read from if no configuration files are
        readable on the system.</p><p class="remark"><em><span class="remark">Bug 27172</span></em></p></li><li class="listitem"><p>Fixed player-controlled entites not being able to move in
        client-only spaces if the physics checking is enabled via setting
        <code class="code">topSpeed</code>.</p><p class="remark"><em><span class="remark">Bug 27251</span></em></p></li><li class="listitem"><p>Fixed an issue that could occur if 32768 or more controllers are
        added to an entity. Controllers could have been allocated the same id
        as a movement controller. Adding a movement controller would incorrect
        cancel another controller.</p><p class="remark"><em><span class="remark">Bug 27283</span></em></p></li><li class="listitem"><p>Fixed Python reference leaks in
        <code class="code">Entity.withholdFromClient</code>,
        <code class="code">Entity.isWithheldFromClient</code> and
        <code class="code">Entity.isInAoI</code>.</p><p class="remark"><em><span class="remark">Bug 27306</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3325"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>An issue exists where performing any operation that can modify
        an Entity's data (for example either property set operations or remote
        method calls) from within the Python
        <code class="classname">BackgroundTask</code>.<code class="methodname">doBackgroundTask()</code>
        method may cause network packet corruption and in turn a process
        crash.</p><p>To avoid this issue, when using Python BackgroundTasks perform
        all entity modifications and interactions from within the
        <code class="classname">BackgroundTask</code>.<code class="methodname">doMainThreadTask()</code>
        callback.</p><p class="remark"><em><span class="remark">Bug 27288</span></em></p></li><li class="listitem"><p>Python hashlib does not function correctly in Bots process or
        BaseApp due to an incompatibility between versions of OpenSSL.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li><li class="listitem"><p><em class="emphasis">Secondary Databases</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="classname">Base</code>.<code class="methodname">writeToDB</code>
            method. BigWorld will conform to this behaviour in a future
            release. In the meantime, passing <code class="code">False</code> in the
            <em class="parameter"><code>writeToDB</code></em> parameter to the
            <code class="classname">Base</code>.<code class="methodname">destroy</code>
            method should be avoided due to its unpredictable
            behaviour.</p></li><li class="listitem"><p>When using secondary databases on a Debian Linux
            distribution, the <code class="filename">transfer_db</code> script may
            silently fail due to a requirement of the python libxml2 module.
            When using secondary databases on Debian Linux please ensure to
            <span class="literal">apt-get install python-libxml2</span> on all BaseApp
            machines.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the
        <code class="classname">Base</code>.<code class="varname">cellData</code> base property
        (which exists if the cell entity has not been created) are also not
        checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code">resources.xml/system/terrain2</code>
        (by default, <code class="filename">system/data/terrain2.xml</code> ) is loaded
        each time that terrain is loaded. This can cause disk access in the
        main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See
        <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code> for
        an example.</p></li><li class="listitem"><p>The file specified by
        <code class="filename">resources.xml/environment/materialKinds</code> (by
        default, <code class="filename">system/data/material_kinds.xml</code>) is
        loaded the first time a collision test occurs that involves terrain.
        This can cause disk access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="filename">
        fantasydemo/res/scripts/cell/FantasyDemo.py</code> for an
        example.</p></li><li class="listitem"><p>The <code class="code">UserDataObjectRef</code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code>
        and <code class="filename">fantasydemo/res/scripts/base/FantasyDemo.py</code>
        for examples.</p></li><li class="listitem"><p><span class="type">FIXED_DICT</span> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scripts.</p></li><li class="listitem"><p>MySQL stored procedures are not supported when used with the
        <code class="classname">BigWorld</code>.<code class="methodname">executeRawDatabaseCommand</code>
        method.</p><p>For details on this method, see the document <em class="emphasis">Server Programming Guide</em>'s section <em class="emphasis">The Database Layer -&gt; Execute Arbitrary Commands On
        Database</em>.</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>The 64-bit version of the server uses up to 50% more memory than
        the 32-bit version in some cases.</p><p class="remark"><em><span class="remark">Bug 24442</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3539"></a>BigWorld Technology 1.9.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3542"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.5 is the latest version of the BigWorld
        Technology engine. This version contains multiple bug fixes which do
        not require complicated merges. Future 1.9 releases are expected to
        mainly contain bug fixes.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3549"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Navigation now works for a space loaded with a transform matrix.</p></li><li class="listitem"><p>Multiple bug fixes were done in this version.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3559"></a>3.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added
        <code class="classname">Entity</code>.<code class="methodname">shouldAutoBackup</code>
        property. This allows disabling automatic backing up of cell entities
        to their base entity.</p><p class="remark"><em><span class="remark">Bug 26377</span></em></p></li><li class="listitem"><p>Added <code class="code">BigWorld.maxCellAppLoad()</code> and
        <code class="code">BigWorld.load()</code> methods to the CellApp. These are useful
        for deciding to disallow some script actions when the server is
        overloaded.</p><p class="remark"><em><span class="remark">Bug 26881</span></em></p></li></ul></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3585"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A fault tolerance issue existed where entity attributes would
        not exist on the restored BaseApp when
        <code class="classname">Proxy</code>.<code class="methodname">onClientDeath</code>
        was called.</p><p>This issue has now been fixed, however users will notice that
        <code class="classname">Base</code>.<code class="methodname">onRestore</code> is now
        called prior to <code class="methodname">onClientDeath</code>.</p><p class="remark"><em><span class="remark">No bug associated</span></em></p></li></ul></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3611"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue that could cause messages destined for the old
        client to be delivered to the new client when an entity is taken over
        via <code class="code">BigWorld.onLogOnAttempt.</code></p><p class="remark"><em><span class="remark">Bug 26908</span></em></p></li><li class="listitem"><p>Now ensuring that <code class="code">BigWorld.writeToDB</code> calls are
        applied to the database in order. Previously, two operations to write
        an entity could be sent to the database and each one sent immediately
        to its own thread. Now, if one of these operations for an entity is
        outstanding, others are buffered until the first has completed.</p><p class="remark"><em><span class="remark">Bug 13927</span></em></p></li><li class="listitem"><p>Fixed an issue that would cause client/server property changes to
        be propagated incorrectly when an entity has more than 60 top-level
        client/server properties.</p><p class="remark"><em><span class="remark">Bug 27059 / Ticket 1504</span></em></p></li><li class="listitem"><p>An issue was fixed where the Reviver process would crash after
        having revived a process due to uncancelled timers.</p><p class="remark"><em><span class="remark">Bug 27028</span></em></p></li><li class="listitem"><p>Fixed an issue with BaseApp and CellApp reconnecting to a new
        DBMgr process, for example after reviving a dead DBMgr process.</p><p class="remark"><em><span class="remark">Bug 27040</span></em></p></li><li class="listitem"><p>Fixed a bug where navigation would not work if a space geomtry is
        loaded with a transform matrix.</p><p class="remark"><em><span class="remark">Bug 26963</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3650"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Python hashlib does not function correctly in Bots process or
        BaseApp due to an incompatibility between versions of OpenSSL.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li><li class="listitem"><p><em class="emphasis">Secondary Databases</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="classname">Base</code>.<code class="methodname">writeToDB</code>
            method. BigWorld will conform to this behaviour in a future
            release. In the meantime, passing <code class="code">False</code> in the
            <em class="parameter"><code>writeToDB</code></em> parameter to the
            <code class="classname">Base</code>.<code class="methodname">destroy</code>
            method should be avoided due to its unpredictable
            behaviour.</p></li><li class="listitem"><p>When using secondary databases on a Debian Linux
            distribution, the <code class="filename">transfer_db</code> script may
            silently fail due to a requirement of the python libxml2 module.
            When using secondary databases on Debian Linux please ensure to
            <span class="literal">apt-get install python-libxml2</span> on all BaseApp
            machines.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the
        <code class="classname">Base</code>.<code class="varname">cellData</code> base property
        (which exists if the cell entity has not been created) are also not
        checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code">resources.xml/system/terrain2</code>
        (by default, <code class="filename">system/data/terrain2.xml</code> ) is loaded
        each time that terrain is loaded. This can cause disk access in the
        main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See
        <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code> for
        an example.</p></li><li class="listitem"><p>The file specified by
        <code class="filename">resources.xml/environment/materialKinds</code> (by
        default, <code class="filename">system/data/material_kinds.xml</code>) is
        loaded the first time a collision test occurs that involves terrain.
        This can cause disk access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="filename">
        fantasydemo/res/scripts/cell/FantasyDemo.py</code> for an
        example.</p></li><li class="listitem"><p>The <code class="code">UserDataObjectRef</code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code>
        and <code class="filename">fantasydemo/res/scripts/base/FantasyDemo.py</code>
        for examples.</p></li><li class="listitem"><p><span class="type">FIXED_DICT</span> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scripts.</p></li><li class="listitem"><p>MySQL stored procedures are not supported when used with the
        <code class="classname">BigWorld</code>.<code class="methodname">executeRawDatabaseCommand</code>
        method.</p><p>For details on this method, see the document <em class="emphasis">Server Programming Guide</em>'s section <em class="emphasis">The Database Layer -&gt; Execute Arbitrary Commands On
        Database</em>.</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>The 64-bit version of the server uses up to 50% more memory than
        the 32-bit version in some cases.</p><p class="remark"><em><span class="remark">Bug 24442</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.4.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3845"></a>BigWorld Technology 1.9.4.5 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.4.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3850"></a>BigWorld Technology 1.9.4.4 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.4.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3855"></a>BigWorld Technology 1.9.4.3 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.4.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3860"></a>BigWorld Technology 1.9.4.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3863"></a>1.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A fault tolerance issue existed where entity attributes would
        not exist on the restored BaseApp when
        <code class="classname">Proxy</code>.<code class="methodname">onClientDeath</code>
        was called.</p><p>This issue has now been fixed, however users will notice that
        <code class="classname">Base</code>.<code class="methodname">onRestore</code> is now
        called prior to <code class="methodname">onClientDeath</code>.</p><p class="remark"><em><span class="remark">Bug 27021</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3889"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue that would cause client/server property changes to
        be propagated incorrectly when an entity has more than 60 top-level
        client/server properties.</p><p class="remark"><em><span class="remark">Bug 27059 / Ticket 1504</span></em></p></li><li class="listitem"><p>An issue was fixed where the Reviver process would crash after 
        having revived a process due to uncancelled timers.</p><p class="remark"><em><span class="remark">Bug 27028</span></em></p></li><li class="listitem"><p>Fixed an issue with BaseApp and CellApp reconnecting to a new
        DBMgr process, for example after reviving a dead DBMgr process.</p><p class="remark"><em><span class="remark">Bug 27040</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.4.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3908"></a>BigWorld Technology 1.9.4.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3911"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a threading issue affecting the reference counting of
        Model objects on the server. This could cause a CellApp crash while
        loading models.</p><p class="remark"><em><span class="remark">Bug 26805</span></em></p></li><li class="listitem"><p>Fixed an issue with processing script from WebConsole's Python
        Console. Line feed characters were not being processed
        correctly.</p><p class="remark"><em><span class="remark">Bug 26930</span></em></p></li><li class="listitem"><p>Removed log NOTICE message from CellApp's
        <code class="code">Entity::updateInternalsForNewPosition</code> regarding setting
        the position of a non-volatile entity. This has been replaced by two
        more accurate messages. These warn when adding a movement controller
        to an entity whose position is not volatile and when the
        client-controlled entity does not have a volatile position.</p><p class="remark"><em><span class="remark">Bug 26921</span></em></p></li><li class="listitem"><p>Fixed a crash that could occur on the CellApp while destreaming
        a property for an entity during creation or restoration. </p><p>The problem occurs if the property is a class-customised USER or
        FIXED_DICT data type. If this property's
        <code class="code">createFromStream()</code> conversion method accesses the entity
        owning the property, any attempt to access one of that entity's
        properties before they are destreamed would result in a segmentation
        fault.</p><p>The new behaviour is to make it seem as though none of the
        defined properties exist, so an <code class="classname">AttributeError</code>
        will be raised instead.</p><p class="remark"><em><span class="remark">Bug 26975 / Ticket #1452</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3948"></a>BigWorld Technology 1.9.4 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3951"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.4 is the latest version of the BigWorld
        Technology engine. This version contains multiple bug fixes which do
        not require complicated merges. Future 1.9 releases are expected to
        mainly contain bug fixes.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3958"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Multiple bug fixes and some network performance optimisations
        were done in this version.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3965"></a>3.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>No new features</p></li></ul></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3972"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="section" title="4.1.&nbsp;DBMgr"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3975"></a>4.1.&nbsp;DBMgr</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A new feature was introduced in BigWorld 1.9.2.3 providing a
          new Entity property data type <span class="type">UNICODE_STRING</span>. To enable
          the usage of this property type initially required the conditional
          compilation in DBMgr. This feature has now been modified to always
          be enabled. In enabling this feature and reviewing the associated
          database behaviour it was deemed necessary to alter the initial
          behaviour that was provided. These changes are enumerated
          below:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Existing persistent entity <span class="type">STRING</span> properties
              will have their associated database column types changes from
              <span class="database">TEXT</span> / <span class="database">VARCHAR</span> to <span class="database">BLOB</span> / <span class="database">VARBINARY</span>.</p><p>This change effectively means that the <span class="type">STRING</span>
              data type as understood by the database is simply a byte
              sequence. We do not anticipate any behavioural changes in
              BigWorld as a result of this modification. If non-latin1 data
              has been stored into a <span class="type">STRING</span> property however you
              may notice that querying this data in a MySQL client may display
              different results.</p></li><li class="listitem"><p>Existing entity tables (by default identified with the
              prefix '<span class="literal">tbl_</span>') will have their default
              character set modified to be UTF-8.</p><p>As all existing <span class="type">STRING</span> fields will have been
              modified to <span class="database">BLOB</span> /
              <span class="database">VARBINARY</span>, this change
              should only affect newly created fields with of type <span class="database">TEXT</span> / <span class="database">VARCHAR</span> which is be used by the
              <span class="type">UNICODE_STRING</span> data type.</p></li><li class="listitem"><p>The default character set of the database has been
              modified to UTF-8.</p><p>This modification will automatically propagate the
              character set to newly created entity tables as required.</p></li><li class="listitem"><p>The <span class="database">bigworldLogOnMapping</span> table has had its
              <span class="database">logOnName</span>, <span class="database">password</span> and <span class="database">recordName</span> fields modified to <span class="database">VARBINARY</span> to be consistent with the
              entity properties they replicate.</p></li><li class="listitem"><p>The client connection from DBMgr to the MySQL database
              will now always use a character set of UTF-8.</p></li></ul></div></li></ul></div></div><div class="section" title="4.2.&nbsp;Mercury / Network"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4064"></a>4.2.&nbsp;Mercury / Network</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The network traffic generated by changing the size of an
          <span class="type">ARRAY</span> property has been greatly reduced. Only the new
          values and the slice being changed are streamed.</p><p>This change required modifying the client-server communication
          protocol.</p><p class="remark"><em><span class="remark">Bug 15846</span></em></p></li></ul></div></div><div class="section" title="4.3.&nbsp;BaseApp"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4078"></a>4.3.&nbsp;BaseApp</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The deprecated old-style BaseApp backup system has been
          removed in this release. The old backup system made use of dedicated
          backup BaseApps, and has been disabled in recent releases. The two
          <code class="filename">bw.xml</code> options associated with the old-style
          BaseApp backup system have also been removed:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><span class="literal">baseAppMgr/onlyUseBackupOnSameMachine</span></p></li><li class="listitem"><p><span class="literal">baseAppMgr/useNewStyleBackup</span></p></li></ul></div><p class="remark"><em><span class="remark">Bug 26657</span></em></p></li></ul></div></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4100"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a bug that allowed the BaseApp script method
        <code class="classname">BigWorld</code>.<code class="methodname">delTimer</code> to
        cancel timers that were not added via
        <code class="classname">BigWorld</code>.<code class="methodname">addTimer</code>.
        This could later cause memory corruption when the true owner of the
        timer attempted to cancel it.</p><p class="remark"><em><span class="remark">Bug 26425</span></em></p></li><li class="listitem"><p>It was possible for Base entity timers to be restored with a
        different script id. If game script had stored the original return
        value of
        <code class="classname">Base</code>.<code class="methodname">addTimer</code>, it was
        possible that the entity would no longer work after restoration. This
        has now been fixed.</p><p class="remark"><em><span class="remark">Bug 26425</span></em></p></li><li class="listitem"><p>The CellApp method
        <code class="classname">Entity</code>.<code class="methodname">cancel</code> now
        generates a Python exception if called on a ghost entity. Previously,
        an assertion was hit.</p><p class="remark"><em><span class="remark">Bug 26547</span></em></p></li><li class="listitem"><p>Previously, calling <code class="code">entity.position.y += 1</code> on a
        ghost entity would cause an assertion. A Python exception is now
        raised instead.</p><p class="remark"><em><span class="remark">Bug 26489</span></em></p></li><li class="listitem"><p>Specifying non-ascii message filters in LogViewer should now
        work correctly. Any valid UTF-8 string should work. To query BigWorld
        server logs that have character set encoding other than UTF-8 will
        require a modification in
        <code class="filename">bigworld/tools/server/web_console/common/encoding.py</code>.</p><p class="remark"><em><span class="remark">Bug 26609</span></em></p></li><li class="listitem"><p>Removed the colon characters from secondary database filenames
        so that they will work on Windows mounts.</p><p class="remark"><em><span class="remark">Bug 26659</span></em></p></li><li class="listitem"><p>Fixed a problem that could cause script methods called by the
        client to be delivered to the wrong server entity. This could occur if
        a message arrived from the old client just after a call to
        <code class="code">Proxy.giveClientTo()</code>.</p><p class="remark"><em><span class="remark">Bug 26662</span></em></p></li><li class="listitem"><p>Fixed a bug that prevented Unicode characters from being used in
        WebConsole's Python Console.</p><p class="remark"><em><span class="remark">Bug 26444</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause a cell entity to get into a bad
        state if it was offloaded more than 65535 times.</p><p class="remark"><em><span class="remark">Bug 26829</span></em></p></li><li class="listitem"><p>Fixed a bug that could cause extra property updates to be sent
        to the client when a player changes CellApps. This fix reduces the
        bandwidth to the client and prevents unexpected calls to
        <code class="code">set_</code> methods.</p><p class="remark"><em><span class="remark">Bug 26854</span></em></p></li><li class="listitem"><p>Fixed a bug that caused the BaseViaCell mailbox's
        <code class="code">.cell</code> attribute to not exist if the mailbox's entity type
        had no base script, rather than no cell script. Also fixed the
        BaseViaCell cell mailbox accessor to be wrongly mapped to
        <code class="code">.base</code> on the CellApp.</p><p class="remark"><em><span class="remark">Bug N/A</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4201"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Python hashlib does not function correctly in Bots process or
        BaseApp due to an incompatibility between versions of OpenSSL.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li><li class="listitem"><p><em class="emphasis">Secondary Databases</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="classname">Base</code>.<code class="methodname">writeToDB</code>
            method. BigWorld will conform to this behaviour in a future
            release. In the meantime, passing <code class="code">False</code> in the
            <em class="parameter"><code>writeToDB</code></em> parameter to the
            <code class="classname">Base</code>.<code class="methodname">destroy</code>
            method should be avoided due to its unpredictable
            behaviour.</p></li><li class="listitem"><p>When using secondary databases on a Debian Linux
            distribution, the <code class="filename">transfer_db</code> script may
            silently fail due to a requirement of the python libxml2 module.
            When using secondary databases on Debian Linux please ensure to
            <span class="literal">apt-get install python-libxml2</span> on all BaseApp
            machines.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the
        <code class="classname">Base</code>.<code class="varname">cellData</code> base property
        (which exists if the cell entity has not been created) are also not
        checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code">resources.xml/system/terrain2</code>
        (by default, <code class="filename">system/data/terrain2.xml</code> ) is loaded
        each time that terrain is loaded. This can cause disk access in the
        main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See
        <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code> for
        an example.</p></li><li class="listitem"><p>The file specified by
        <code class="filename">resources.xml/environment/materialKinds</code> (by
        default, <code class="filename">system/data/material_kinds.xml</code>) is
        loaded the first time a collision test occurs that involves terrain.
        This can cause disk access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="filename">
        fantasydemo/res/scripts/cell/FantasyDemo.py</code> for an
        example.</p></li><li class="listitem"><p>The <code class="code">UserDataObjectRef</code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="filename">fantasydemo/res/scripts/cell/FantasyDemo.py</code>
        and <code class="filename">fantasydemo/res/scripts/base/FantasyDemo.py</code>
        for examples.</p></li><li class="listitem"><p><span class="type">FIXED_DICT</span> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scripts.</p></li><li class="listitem"><p>MySQL stored procedures are not supported when used with the
        <code class="classname">BigWorld</code>.<code class="methodname">executeRawDatabaseCommand</code>
        method.</p><p>For details on this method, see the document <em class="emphasis">Server Programming Guide</em>'s section <em class="emphasis">The Database Layer -&gt; Execute Arbitrary Commands On
        Database</em>.</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>The 64-bit version of the server uses up to 50% more memory than
        the 32-bit version in some cases.</p><p class="remark"><em><span class="remark">Bug 24442</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.3.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4396"></a>BigWorld Technology 1.9.3.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4399"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed potential memory corruption if an entity was moved via
        script in its
        <code class="classname">Entity</code>.<code class="methodname">onDestroy</code>
        method.</p><p class="remark"><em><span class="remark">Bug 26576</span></em></p></li><li class="listitem"><p>The CellApp method <code class="code">Entity.cancel</code> now generates a
        Python exception if called on a ghost entity. Previously, an assertion
        was hit.</p><p class="remark"><em><span class="remark">Bug 26547</span></em></p></li><li class="listitem"><p>Fixed a memory leak caused when BigWorld 1.8 tools queries for
        a watcher value that does not exist.</p><p class="remark"><em><span class="remark">Bug 26579</span></em></p></li><li class="listitem"><p>Fixed a race condition causing an assertion to fail on BaseApp
        during startup. This could be triggered if many BaseApps were started
        on the same machine.</p><p class="remark"><em><span class="remark">Bug 26550</span></em></p></li><li class="listitem"><p>Fixed a problem that could cause script methods called by the
        client to be delivered to the wrong server entity. This could occur if
        a message arrived from the old client just after a call to
        <code class="code">Proxy.giveClientTo()</code>.</p><p class="remark"><em><span class="remark">Bug 26662</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause a cell entity to get into a bad
        state if it was offloaded more than 65535 times.</p><p class="remark"><em><span class="remark">Bug 26829</span></em></p></li><li class="listitem"><p>Fixed a bug that could cause extra property updates to be sent to
        the client when a player changes CellApps. This fix reduces the
        bandwidth to the client and prevents unexpected calls to
        <code class="code">set_</code> methods.</p><p class="remark"><em><span class="remark">Bug 26854</span></em></p></li><li class="listitem"><p>Fixed a threading issue affecting the reference counting of
        Model objects on the server. This could cause a CellApp crash while
        loading models.</p><p class="remark"><em><span class="remark">Bug 26805</span></em></p></li><li class="listitem"><p>Fixed a crash that could occur on the CellApp while destreaming
        a property for an entity during creation or restoration. </p><p>The problem occurs if the property is a class-customised USER or
        FIXED_DICT data type. If this property's
        <code class="code">createFromStream()</code> conversion method accesses the entity
        owning the property, any attempt to access one of that entity's
        properties before they are destreamed would result in a segmentation
        fault.</p><p>The new behaviour is to make it seem as though none of the
        defined properties exist, so an <code class="classname">AttributeError</code>
        will be raised instead.</p><p class="remark"><em><span class="remark">Bug 26975 / Ticket #1452</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.3.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4473"></a>BigWorld Technology 1.9.3.4 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.3.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4478"></a>BigWorld Technology 1.9.3.3 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.3.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4483"></a>BigWorld Technology 1.9.3.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4486"></a>1.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>CellAppMgr now allows new cells to be added to retiring CellApp
        processes. Previously this caused an assertion, however if another
        CellApp process unexpectedly dies all available resources should be
        used to help smooth the load spike.</p><p class="remark"><em><span class="remark">Ticket #994</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4495"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Attempting to shutdown CellApp processes using the CellAppMgr
        watcher
        <span class="literal">cellApps/<em class="replaceable"><code>&lt;address:port&gt;</code></em>/isShuttingDown</span>
        would previously fail reporting that the CellApp was already shutting
        down. Setting this watcher value should now work as expected.</p><p class="remark"><em><span class="remark">Ticket #994</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.3.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4510"></a>BigWorld Technology 1.9.3.1 Server Release Notes</h2></div></div><hr></div><p>No changes were done for this version.</p></div><div class="article" title="BigWorld Technology 1.9.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e4515"></a>BigWorld Technology 1.9.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4518"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.3 is the latest version of the BigWorld
        Technology engine. This version contains multiple bug fixes and highly
        important features which do not require complicated merges. Future 1.9
        releases are expected to mainly contain bug fixes.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4525"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>It is now possible to filter the AoI entities sent to the
        client.</p></li><li class="listitem"><p>To assist in production environments, MessageLogger can be
        limited to logging from a subset of machines.</p></li><li class="listitem"><p>Access to external services is now supported using a
        BackgroundTask.</p></li><li class="listitem"><p>CentOS 5 Linux x86_64 distribution is now the preferred
        distribution. The server is now fully compliant with CentOS
        x86_64.</p></li><li class="listitem"><p>Analysis of watchers values can now be done using a new "Cluster
        Control" module.</p></li><li class="listitem"><p>Multiple bug fixes were done in this version.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4547"></a>3.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added functionality to support script control of which entities
        in an entity's Area of Interest are sent to the client. This is useful
        for security and performance reasons.</p><p>The new methods are:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><code class="classname">Entity</code>.<code class="methodname">withholdFromClient</code>(
            <em class="parameter"><code>entity</code></em>, <em class="parameter"><code>isWithheld</code></em>
            )</p></li><li class="listitem"><p><code class="classname">Entity</code>.<code class="methodname">isWithheldFromClient</code>(
            <em class="parameter"><code>entity</code></em> )</p></li><li class="listitem"><p><code class="classname">Entity</code>.<code class="methodname">entitiesInAoI</code>(
            <em class="parameter"><code>withheld</code></em> )</p></li><li class="listitem"><p><code class="classname">Entity</code>.<code class="methodname">isInAoI</code>(
            <em class="parameter"><code>entity</code></em> )</p></li></ul></div><p>New callback:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><code class="classname">Entity</code>.<code class="methodname">onEnteredAoI</code>(
            <em class="parameter"><code>entity</code></em> )</p></li></ul></div><p class="remark"><em><span class="remark">Bug 26000</span></em></p></li><li class="listitem"><p>The database layer now supports the option of storing ARRAY and
        TUPLE properties as a BLOB in the MySQL database instead of in
        separate tables. This can improve the performance of the
        database.</p><p>For more details, see the document <a href="./html/server_programming_guide/server_programming_guide.html#xref_Implementing_Common_Systems" class="olink"><i>Implementing Common Systems</i></a>'s section <a href="./html/server_programming_guide/server_programming_guide.html#xref_Storing_Arrays_And_Tuples_As_Blob" class="olink">Storing ARRAYs and TUPLEs as a BLOB</a>.</p><p class="remark"><em><span class="remark">Bug 18285</span></em></p></li><li class="listitem"><p>BWMachined now supports a new option <code class="option">--version</code>
        which enables cluster operators to verify an installed version of
        BWMachined.</p><p class="remark"><em><span class="remark">Bug 21413</span></em></p></li><li class="listitem"><p>To assist in production environments, MessageLogger can be
        limited to logging from a subset of machines.</p><p>For more details, see the <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a>'s
        section <a href="./html/server_operations_guide/server_operations_guide.html#xref_MessageLogger" class="olink">Message Logger</a> <span class="symbol">&#8594;</span> <a href="./html/server_operations_guide/server_operations_guide.html#xref_MessageLogger_Scalability" class="olink">Production Scalability</a></p><p class="remark"><em><span class="remark">Bug 17816</span></em></p></li><li class="listitem"><p>BaseApp and CellApp scripts can access external services (e.g.
        billing or shopping systems) without blocking the main thread by using
        a <code class="classname"> BackgroundTask </code> module.</p><p>For more details, see the document <em class="emphasis"> Server
        Programming Guide</em>'s section <em class="emphasis"> External
        Services</em>.</p></li><li class="listitem"><p>Added a new configuration option <code class="code">cellApp/ghostDistance
        </code>which allows customising the distance from a cell boundary
        which will be considered for ghosting entities.</p></li><li class="listitem"><p>Added a new chapter, <a href="./html/server_programming_guide/server_programming_guide.html#xref_Implementing_Common_Systems" class="olink"><i>Implementing Common Systems</i></a>, to the <a href="./html/server_programming_guide/server_programming_guide.html#Server_Programming_Guide" class="olink">Server Programming Guide</a>.</p></li><li class="listitem"><p>Non ASCII characters will now be correctly displayed in
        LogViewer. By default a UTF8 encoding is used, however this can be
        easily modified by editing the <code class="varname">ENCODING</code> constant in
        <code class="filename">bigworld/tools/server/web_console/log_viewer/controllers.py</code>.</p></li></ul></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4690"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="section" title="4.1.&nbsp;64 bit"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4693"></a>4.1.&nbsp;64 bit</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld now supports Linux CentOS 5.3 x86_64 distribution.
          Customers are encouraged to choose this distribution as their target
          distribution. It is expected that this distribution will become the
          primary BigWorld distribution for BigWorld 2.0.</p></li></ul></div></div><div class="section" title="4.2.&nbsp;DBMgr"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4700"></a>4.2.&nbsp;DBMgr</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The database table to entity definition synchronisation
          functionality has been removed from DBMgr into a separate tool
          <em class="emphasis">sync_db</em>.</p><p>For more details, see the document <a href="./html/server_operations_guide/server_operations_guide.html#Server_Operations_Guide" class="olink">Server Operations Guide</a> section <a href="./html/server_operations_guide/server_operations_guide.html#xref_DBMgr_MySQL_Support" class="olink"><i>MySQL Support</i></a>.</p></li><li class="listitem"><p>The data consolidation tool is now multi-threaded and has
          better performance. The
          <code class="property">&lt;dbMgr&gt;/&lt;numConnections&gt;</code>
          configuration setting determines the number of threads that the data
          consolidation tool spawns.</p><p class="remark"><em><span class="remark">Bug 21706</span></em></p></li><li class="listitem"><p>SyncDB now performs a single <span class="literal">ALTER TABLE</span>
          SQL command for all column modifications (i.e, add, delete, modify)
          when migrating between two entity definitions. This drastically
          increases the performance of SyncDB when migrating an existing
          database with large entity datasets.</p><p class="remark"><em><span class="remark">Bug 26101</span></em></p></li></ul></div></div><div class="section" title="4.3.&nbsp;LoginApp"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4732"></a>4.3.&nbsp;LoginApp</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <code class="filename">bw.xml</code> settings
          <code class="property">&lt;loginApp/externalAddress&gt;</code> and
          <code class="property">&lt;loginApp/localNetMask&gt;</code> have been moved
          to
          <code class="property">&lt;networkAddressTranslation/externalAddress&gt;</code>
          and
          <code class="property">&lt;networkAddressTranslation/localNetMask&gt;</code>
          to better reflect their meaning. The old options are still usable
          but are deprecated and will be removed in a future release.</p><p class="remark"><em><span class="remark">Bug 24584</span></em></p></li><li class="listitem"><p>LoginApp now supports specifying multiple login ports via
          <code class="property">loginApp/externalPorts/port</code> entries in the
          server configuration files. This allows a range of ports to be used
          as candidates on startup in the case that multiple LoginApps will be
          started on the same machine.</p><p>The <code class="property">loginApp/port</code> option still works but
          is now deprecated.</p><p class="remark"><em><span class="remark">Bug 26212</span></em></p></li></ul></div></div><div class="section" title="4.4.&nbsp;BaseApp"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4769"></a>4.4.&nbsp;BaseApp</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BaseApp's <code class="property">baseApp/externalPort</code>
          configuration option has been replaced by
          <code class="property">baseApp/externalPorts/port</code> to be consistent
          with the equivalent option of LoginApp.</p><p>The <code class="property">baseApp/externalPort</code> option still
          works but is now deprecated.</p></li><li class="listitem"><p>A new option
          <code class="property">baseApp/shouldShutDownIfPortUsed</code> has been
          added.</p><p class="remark"><em><span class="remark">Bug 26212</span></em></p></li></ul></div></div><div class="section" title="4.5.&nbsp;CellAppMgr"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4795"></a>4.5.&nbsp;CellAppMgr</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added better load distribution protection for situations where
          large numbers of spaces are created in a small period of time.
          Previously a large number of spaces could be created on a single
          CellApp due to the frequency of CellApps notifying the CellAppMgr of
          their current load. Space creation should now be more evenly
          distributed across CellApps in this situation.</p><p class="remark"><em><span class="remark">Ticket 637</span></em></p></li></ul></div></div><div class="section" title="4.6.&nbsp;Entities"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4804"></a>4.6.&nbsp;Entities</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Client only entities now allow instantiation for properties of
          type <span class="literal">OWN_CLIENT</span>, and any other data property
          types that use <span class="literal">DATA_OWN_CLIENT</span>. A Client side
          <span class="literal">NOTICE_MSG</span> will be generated for these types of
          property types.</p><p class="remark"><em><span class="remark">Bug 21570, 24773</span></em></p></li></ul></div></div><div class="section" title="4.7.&nbsp;Mercury / Network"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4822"></a>4.7.&nbsp;Mercury / Network</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The server no longer sends login replies to the client as
          once-off reliable messages, relying instead on the client's
          application-level retry mechanism to resend the login requests. This
          reduces the effect of DoS attacks. The login version has been bumped
          for this reason.</p><p class="remark"><em><span class="remark">Bug 25043</span></em></p></li></ul></div></div><div class="section" title="4.8.&nbsp;Server Tools"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4831"></a>4.8.&nbsp;Server Tools</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In order to accommodate 64 bit binaries, compiled server tools
          have been moved into a new location, <code class="filename">bigworld/tools/server/bin/</code>. If
          upgrading from a previous release, please follow our upgrade
          recommendations in the <em class="emphasis">Server Tools
          Installation Guide</em>.</p><p class="remark"><em><span class="remark">Bug 23318</span></em></p></li><li class="listitem"><p>In order to accommodate 64 bit distributions such as CentOS
          which ship with older versions of Python (i.e, Python 2.4),
          MessageLogger and the Python interface to the logs
          <code class="filename">BWLog.so</code> have been more logically separated.
          This has involved a major code change in <code class="filename">bigworld/src/server/tools/message_logger/</code>.
          This change should not have changed functionality at all, however as
          a result of this refactor a lot of methods and classes and have been
          renamed to assist code readability. Also as a result of this change,
          MessageLogger no longer supports writing of text logs using the
          <code class="option">-t</code>/<code class="option">--text</code> options.</p><p class="remark"><em><span class="remark">Bug 24727</span></em></p></li><li class="listitem"><p>Watcher functionality in WebConsole has been moved to a new
          "Watchers" module underneath the "Cluster Control" module. As part
          of this separation a new filtered watchers feature has been added
          which enables wildcard viewing of watcher values across server
          processes. A set of pre-configured filtered watchers that may be
          useful has been provided.</p><p class="remark"><em><span class="remark">Bug 25542</span></em></p></li></ul></div></div><div class="section" title="4.9.&nbsp;Web Integration Module"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4868"></a>4.9.&nbsp;Web Integration Module</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The Web Integration module for Python and PHP have had their
          functions <code class="methodname">BigWorld.setNubPort()</code> (Python)
          and <code class="methodname">bw_set_nub_port()</code> (PHP) deprecated.
          These functions have been renamed to
          <code class="methodname">BigWorld.resetNetworkInterface()</code> and
          <code class="methodname">bw_reset_network_interface()</code>
          respectively.</p><p class="remark"><em><span class="remark">Bug 24803</span></em></p></li><li class="listitem"><p>When building the Web Integration modules and supporting
          libraries in Hybrid[<span class="optional">
              <code class="option">64</code>
            </span>]_SingleThreaded mode, the Python re-distribution is no
          longer built with the BigWorld modifications that enable file access
          from only within a BigWorld resource path.</p><p class="remark"><em><span class="remark">Bug 14312</span></em></p></li></ul></div></div><div class="section" title="4.10.&nbsp;Miscellaneous"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4900"></a>4.10.&nbsp;Miscellaneous</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>By default, BigWorld now gets its timestamp from the
          <code class="function">clock_gettime</code> syscall and not the time stamp
          counter register (rdtsc). To return to the previous behaviour, refer
          to the section on <code class="property">TimingMethod</code> in <em class="emphasis">Server Tools Installation Guide</em>.</p><p class="remark"><em><span class="remark">Bug: N/A</span></em></p></li><li class="listitem"><p><code class="filename">bigworld/tools/server/install/setup_win_dev.py</code>
          now mounts windows shares without group and world writable
          permissions. This is to allow more reliable compilation of
          openssl.</p><p class="remark"><em><span class="remark">Bug: 25087</span></em></p></li></ul></div></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4925"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Converting from a Python integer to a C++ integer is now
        strictly checked that it's in a valid range. For example, assigning a
        value larger than 127 to a uint8 function argument was previously
        allowed but the value would be truncated to fit. This is no longer
        allowed.</p><p class="remark"><em><span class="remark">Bug 23381</span></em></p></li><li class="listitem"><p>Clients are now better able to maintain their connection to the
        server when they pause for an extended period of time. Previously, it
        was possible for the client to not process a resent packet (sent via
        piggyback) but still indicate to the server that it had been received.
        This meant that this packet would never be processed and the channel
        would be in a bad state.</p><p>Significant improvements have also been made in situations where
        there is packet loss or significant, temporary lag. The number of
        resent packets should now be significantly less.</p><p class="remark"><em><span class="remark">Bug 24199</span></em></p></li><li class="listitem"><p>mlcat <code class="option">--translate</code> now works when selecting a
        particular server startup.</p><p class="remark"><em><span class="remark">Bug 21715</span></em></p></li><li class="listitem"><p>The RDTSC timing method now functions correctly on 64 bit
        systems.</p><p class="remark"><em><span class="remark">Bug: N/A</span></em></p></li><li class="listitem"><p>BaseApp and CellApp processes now appropriately shut down when a
        failed server startup has occured prior to the processes having
        registering with BWMachined.</p><p class="remark"><em><span class="remark">Bug: 25031</span></em></p></li><li class="listitem"><p>Added protection against a rare case where a server process that
        was killed / died was immediately replaced with another unrelated
        process (thus consuming the server process' PID). BWMachined now
        detects this case has occured and drops the defunct server process
        from its list of active server processes.</p><p class="remark"><em><span class="remark">Ticket: 544</span></em></p></li><li class="listitem"><p>Fixed a bug in WebConsole/LogViewer that was causing the search
        range to be offset by the difference between the daylight-savings
        timezone offset and the non-daylight-savings timezone offset. The log
        search input time would always be treated as a time in
        daylight-savings regardless of whether daylight savings on the server
        was actually in effect.</p><p class="remark"><em><span class="remark">Bug: N/A</span></em></p></li><li class="listitem"><p>Fixed a bug that could cause CellApp processes to fail to start
        up if there is a poorly configured bwmachined process on the network.
        The CellApp process would report that it could not find the CellAppMgr
        even though one was present.</p><p class="remark"><em><span class="remark">Bug: 26094</span></em></p></li><li class="listitem"><p>Reduced the amount of log data generated when packets come in on
        the BaseApp's external interface that cannot be processed. This
        includes packets coming from clients that have been disconnected for a
        while. These packets are encrypted and they cannot be decrypted once
        the channel has gone.</p><p class="remark"><em><span class="remark">Bug: 25998</span></em></p></li><li class="listitem"><p>Reduced the amount of log data generated by BaseApp when clients
        are experiencing packet loss.</p><p class="remark"><em><span class="remark">Ticket: 644</span></em></p></li><li class="listitem"><p>Improved the argument checking to
        <code class="classname">Entity</code>.<code class="methodname">entitiesInRange</code>().
        Previously if an invalid entity type string was passed in, all entity
        types were matched. A Python <span class="type">ValueError</span> is now
        raised.</p><p class="remark"><em><span class="remark">Ticket: 647</span></em></p></li><li class="listitem"><p>Fixed a bug in the BigWorld Python import hook mechanism.
        Previously, reloading modules using the Python built-in
        <code class="code">reload()</code> function would use a cached copy of the source
        file read when first imported, instead of re-reading the potentially
        modified file from the disk.</p><p class="remark"><em><span class="remark">Bugs: 26152, 26104; Ticket: 602</span></em></p></li><li class="listitem"><p>Fixed a possible CellApp crash if createGhost messages from
        different CellApps for the same entity are received in the wrong
        order.</p><p class="remark"><em><span class="remark">Bug: 26203</span></em></p></li><li class="listitem"><p>The first input to a client entity's movement filter was
        incorrect for entities on a vehicle. It was passed in global
        coordinates instead of local coordinates. This could show up as
        passenger entities moving quickly towards their vehicle.</p><p class="remark"><em><span class="remark">Bug: 26410</span></em></p></li><li class="listitem"><p>Fixed an issue with DBMgr not reconnecting to the MySQL server,
        or any of the configured backup database servers, if the connection to 
		the current MySQL server is lost.</p><p class="remark"><em><span class="remark">Bug: 26437; Ticket: 829</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5021"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Python hashlib does not function correctly in Bots process or
        BaseApp due to an incompatibility between versions of openssl.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li><li class="listitem"><p>
          <em class="emphasis">Secondary Databases</em>
        </p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="code">Base.writeToDB</code> method. BigWorld will conform to this
            behaviour in a future release. In the meantime, passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter to the
            <code class="code">Base.destroy</code> method should be avoided due to its
            unpredictable behaviour.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the <code class="varname">Base.cellData</code>
        base property (which exists if the cell entity has not been created)
        are also not checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code"> resources.xml/system/terrain2
        </code> (by default, <code class="code"> system/data/terrain2.xml </code> ) is
        loaded each time that terrain is loaded. This can cause disk access in
        the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The file specified by <code class="code">
        resources.xml/environment/materialKinds </code> (by default, <code class="code">
        system/data/material_kinds.xml </code> ) is loaded the first time a
        collision test occurs that involves terrain. This can cause disk
        access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The <code class="code"> UserDataObjectRef </code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="code"> fantasydemo/res/scripts/cell/FantasyDemo.py </code> and
        <code class="code"> fantasydemo/res/scripts/base/FantasyDemo.py </code> for
        examples.</p></li><li class="listitem"><p><code class="code"> FIXED_DICT </code> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scritps.</p></li><li class="listitem"><p>MySQL stored procedures are not supported when used with the
        <code class="code"> BigWorld.executeRawDatabaseCommand </code> method.</p><p>For details on this method, see the document <em class="emphasis"> Server Programming Guide </em> 's section <em class="emphasis"> The Database Layer -&gt; Execute Arbitrary Commands On
        Database </em> .</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>The 64-bit version of the server uses up to 50% more memory than
        the 32-bit version in some cases.</p><p class="remark"><em><span class="remark">Bug 24442</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.6 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5197"></a>BigWorld Technology 1.9.2.6 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5200"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue with Channels that were registered for a delayed
        send, and reset to <code class="code">Address::NONE</code> before the delayed send
        occurred, causing an assertion failure. Now these channels are sent on
        just before they are reset to a new address.</p><p class="remark"><em><span class="remark">Bug 26845</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause a cell entity to get into a bad
        state if it was offloaded more than 65535 times.</p><p class="remark"><em><span class="remark">Bug 26829</span></em></p></li><li class="listitem"><p>Fixed a threading issue affecting the reference counting of
        Model objects on the server. This could cause a CellApp crash while
        loading models.</p><p class="remark"><em><span class="remark">Bug 26805</span></em></p></li><li class="listitem"><p>Fixed an issue with Channels that were registered for a delayed
		send, and reset to <code class="code">Address::NONE</code> before the send occurred,
		causing the assertion <code class="code">addr_ != Address::NONE</code> to fail on
		<code class="code">Nub::send()</code>.</p><p class="remark"><em><span class="remark">Bug 26845 / Ticket #1340</span></em></p></li><li class="listitem"><p>Fixed a crash that could occur on the CellApp while destreaming
        a property for an entity during creation or restoration. </p><p>The problem occurs if the property is a class-customised USER or
        FIXED_DICT data type. If this property's
        <code class="code">createFromStream()</code> conversion method accesses the entity
        owning the property, any attempt to access one of that entity's
        properties before they are destreamed would result in a segmentation
        fault.</p><p>The new behaviour is to make it seem as though none of the
        defined properties exist, so an <code class="classname">AttributeError</code>
        will be raised instead.</p><p class="remark"><em><span class="remark">Bug 26975 / Ticket #1452</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5251"></a>BigWorld Technology 1.9.2.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5254"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed an issue with Channels that were registered for a delayed
        send, and reset to <code class="code">Address::NONE</code> before the delayed send
        occurred, causing an assertion failure. Now these channels are sent on
        just before they are reset to a new address.</p><p class="remark"><em><span class="remark">Bug 26845</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause a cell entity to get into a bad
        state if it was offloaded more than 65535 times.</p><p class="remark"><em><span class="remark">Bug 26829</span></em></p></li><li class="listitem"><p>Fixed a threading issue affecting the reference counting of
        Model objects on the server. This could cause a CellApp crash while
        loading models.</p><p class="remark"><em><span class="remark">Bug 26805</span></em></p></li><li class="listitem"><p>Fixed an issue with Channels that were registered for a delayed
		send, and reset to <code class="code">Address::NONE</code> before the send occurred,
		causing the assertion <code class="code">addr_ != Address::NONE</code> to fail on
		<code class="code">Nub::send()</code>.</p><p class="remark"><em><span class="remark">Bug 26845 / Ticket #1340</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5290"></a>BigWorld Technology 1.9.2.4 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5293"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed potential memory corruption if an entity was moved via
        script in its
        <code class="classname">Entity</code>.<code class="methodname">onDestroy</code>
        method.</p><p class="remark"><em><span class="remark">Bug 26576</span></em></p></li><li class="listitem"><p>CellAppMgr now allows new cells to be added to retiring CellApp
        processes. Previously this caused an assertion, however if another
        CellApp process unexpectedly dies all available resources should be
        used to help smooth the load spike.</p><p class="remark"><em><span class="remark">Ticket #994</span></em></p></li><li class="listitem"><p>Attempting to shut down CellApp processes using the CellAppMgr
        watcher
        <span class="literal">cellApps/<em class="replaceable"><code>&lt;address:port&gt;</code></em>/isShuttingDown</span>
        would previously fail reporting that the CellApp was already shutting
        down. Setting this watcher value should now work as expected.</p><p class="remark"><em><span class="remark">Ticket #994</span></em></p></li><li class="listitem"><p>The CellApp method <code class="code">Entity.cancel</code> now generates a
        Python exception if called on a ghost entity. Previously, an assertion
        was hit.</p><p class="remark"><em><span class="remark">Bug 26547</span></em></p></li><li class="listitem"><p>Fixed startup crash if a corrupted .pyc was loaded.</p><p class="remark"><em><span class="remark">Ticket #1029</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5337"></a>BigWorld Technology 1.9.2.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5340"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a possible CellApp crash if createGhost messages from
        different CellApps for the same entity are received in the wrong
        order.</p><p class="remark"><em><span class="remark">Bug: 26203</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5349"></a>BigWorld Technology 1.9.2.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5352"></a>1.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added a new <span class="literal">UNICODE_STRING</span> Entity property
        type.</p><p>By default this property type is not able to be used as a
        <code class="property">&lt;Persistent&gt;</code> property. In order to persist
        this property type, DBMgr needs to be rebuilt enabling both the
        <span class="literal">USE_MYSQL</span> and <span class="literal">USE_MYSQL_UTF8</span>
        flags in
        <code class="filename">bigworld/src/server/dbmgr/Makefile</code>.</p><pre class="programlisting">...
USE_MYSQL=<em class="emphasis">1</em>
USE_MYSQL_UTF8=<em class="emphasis">1</em>
USE_XML=0</pre><p>Once rebuilt with UTF8 enabled, DBMgr will perform an
        <span class="literal">"ALTER DATABASE CHARACTER SET 'utf8'"</span> which will
        create any future tables with a utf8 default encoding, but leave
        existing tables in the latin1 encoding.</p><p class="remark"><em><span class="remark">Ticket #848</span></em></p></li></ul></div></div><div class="section" title="2.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5391"></a>2.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added better load distribution protection for situations where
        large numbers of spaces are created in a small period of time.
        Previously a large number of spaces could be created on a single
        CellApp due to the frequency of CellApps notifying the CellAppMgr of
        their current load. Space creation should now be more evenly
        distributed across CellApps in this situation.</p><p class="remark"><em><span class="remark">Ticket # 637</span></em></p></li><li class="listitem"><p>The first input to a client entity's movement filter was
        incorrect for entities on a vehicle. It was passed in global
        coordinates instead of local coordinates. This could show up as
        passenger entities moving quickly towards their vehicle.</p><p class="remark"><em><span class="remark">Bug: 26410</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5405"></a>BigWorld Technology 1.9.2.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5408"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a bug where a recently teleported entity's buffered ghost
		messages can be replayed in the wrong order, causing an assert.
 		<em><span class="remark"> Bug 24539 </span></em>
		</p></li><li class="listitem"><p>Fixed a bug where backups for some base entities will be missing
		shortly after a BaseApp is added to the cluster.
 		<em><span class="remark"> Bug 25525 </span></em>
		</p></li><li class="listitem"><p>Fixed a bug where the onInit callback on BaseApp was not being
		 triggered.
 		 <em><span class="remark"> Perldesk #311 </span></em>
	   </p></li><li class="listitem"><p>Fixed a bug where a cellapp would crash if an entity is told to
		 follow a destroyed entity.
 		 <em><span class="remark"> Perldesk #318 </span></em>
	   </p></li><li class="listitem"><p>Fixed a bug that results in error messages stating that a proxy
        was not set for call, which indicates that messages from the cell to
        the client entity are wrongly dropped at the BaseApp. This could cause
        entity updates to not be realised on the client, for example, whether
        an entity had left or entered the player's AoI. This could happen if
        there was some loss and/or latency on the server network resulting in
        more than one bundle being processed at a time, which would clear the
        proxy for call prematurely after the first bundle.</p><p class="remark"><em><span class="remark">Bug 25391</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5441"></a>BigWorld Technology 1.9.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5444"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.2 is the latest version of the BigWorld
        Technology engine. This version contains the fixes required for
        releasing the BigWorld evaluation version and urgent fixes required by
        customers using 1.9.1.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5451"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The server can now be compiled and run natively on 64 bit
        machines. This currently does not include the server tools.</p></li></ul></div></div><div class="section" title="3.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5458"></a>3.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a bug where <span class="literal">FLOAT64</span> properties stored
        in the XML database were truncated to 6 decimal places.</p><p class="remark"><em><span class="remark">Bug 9106</span></em></p></li><li class="listitem"><p>When using the LogViewer functionality of WebConsole on a
        machine located in a different timezone to the client browser,
        timezone differences were not being taken into account which caused
        strange search results. This issue has now been resolved.</p><p class="remark"><em><span class="remark">Bug 13525</span></em></p></li><li class="listitem"><p>Fixed two issues with the navigation, firstly,
        <code class="methodname">Entity.navigateFollow()</code> calls
        <code class="methodname">navigateStep()</code> internally, and due to the
        prototype for <code class="methodname">navigateStep()</code> changing in
        1.9.1, the calling code in <code class="methodname">navigateFollow()</code>
        was not updated to the new prototype. As a result, the arguments were
        mismatched.</p><p>Secondly, <code class="methodname">Entity.navigate()</code> has been
        fixed so that the navigating entity has its height lifted to be at
        least the containing navpoly's maximum height, in line with how
        <code class="methodname">Entity.navigateStep()</code> behaves.</p><p class="remark"><em><span class="remark">Bug 24241, Ticket # 83</span></em></p></li><li class="listitem"><p>User Data Objects will now get their <code class="methodname">__del__
        </code> method called when they get deleted.</p><p class="remark"><em><span class="remark">Bug 24153, Ticket # 85</span></em></p></li><li class="listitem"><p>Fixed a regression that allowed an external channel to assert
        when channels are set to assert on overflow. Put back the diagnostic
        info on overflow assert.</p><p class="remark"><em><span class="remark">Bug 24552</span></em></p></li><li class="listitem"><p>Fixed a bug whereby mailbox properties on entities are
        unavailable to scripts on the bots process.</p><p class="remark"><em><span class="remark">Bug 24109</span></em></p></li><li class="listitem"><p>Fixed a bug that would cause the DBMgr to hit a CRITICAL_MSG if
        it was using the XML database and a BaseApp was killed.</p><p class="remark"><em><span class="remark">Bug 24777</span></em></p></li><li class="listitem"><p>Fixed a bug in logging code that causes a crash when offloading
        ghosts along an overloaded channel.</p><p class="remark"><em><span class="remark">Bug 25024</span></em></p></li><li class="listitem"><p>Fixed three race conditions that could occur when chunks are
        loaded and unloaded quickly and would cause segfaults.</p><p class="remark"><em><span class="remark">Bug 24964</span></em></p></li><li class="listitem"><p>The control cluster script now correctly prints out an error
        message when mercuryprofile is used without specifying a
        process.</p><p class="remark"><em><span class="remark">Bug 25135</span></em></p></li><li class="listitem"><p>onDelBaseAppData will now correctly be called when removing data
        from the
        <code class="classname">BigWorld</code>.<code class="varname">baseAppData</code>
        dictionary.</p><p class="remark"><em><span class="remark">Ticket ID: 210</span></em></p></li><li class="listitem"><p>Fixed an issue with piggybacked packets where those piggybacked
        packets that are discarded due to being above the receive window may
        not have been resent if an ACK was sent for its containing packet. Now
        containing packets are not acknowledged if any of its piggybacked
        packets are discarded for being above the receive window.</p><p class="remark"><em><span class="remark">Bug 24553, Ticket # 114</span></em></p></li></ul></div></div><div class="section" title="4.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5554"></a>4.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>As 1.9.2 introduces support for 64 bit server binaries but not
        full support for the 64 bit server tools, bwmachined needs to be
        handled differently than to prior releases.</p><p>When building a 64 bit version of bwmachined, the binary will be
        placed into
        <code class="filename">bigworld/src/server/tools/bwmachined/Hybrid64/bwmachined</code>
        as opposed to its regular location
        <code class="filename">bigworld/tools/server/install/bwmachined</code>. This
        will impact the <span class="literal">bwmachined.sh install</span> procedure
        unless you explicity copy the 64 bit version into the standard
        location. This can be done with the following command.</p><pre class="programlisting">$ cd bigworld/src/server/tools/bwmachined
$ cp Hybrid64/bwmachined ../../../../tools/server/install</pre><p>If you intend to run 64 bit servers you will need to install a
        64 bit version of bwmachined onto the respective machines as there are
        known issues with 32 bit server binaries not working correctly due to
        glibc differences.</p><p>This issue will be completely resolved in 1.9.3.</p></li><li class="listitem"><p>Due to adding support to the
        <code class="code"><em class="replaceable"><code>*</code></em>_MSG</code> message macros for the
        <span class="literal">%z</span> format string modifier, log messages generated
        from 1.9.1 client / server processes using <span class="literal">%z</span> will
        be incorrectly saved by 1.9.0 or earlier instances of
        MessageLogger.</p><p>The recommended solution for this issue is to remove the old log
        directory when installing the 1.9.1 server tools and allow a
        completely fresh set of logs to be written.</p><p>For example:</p><pre class="programlisting">$ rm -rf /var/log/bigworld/message_logger</pre></li><li class="listitem"><p><em class="emphasis">Fedora 9</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Python hashlib does not function correctly in Bots process
            or BaseApp due to an incompatibility between versions of
            openssl.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li></ul></div></li><li class="listitem"><p><em class="emphasis">Secondary Databases</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="code">Base.writeToDB</code> method. BigWorld will conform to this
            behaviour in a future release. In the meantime, passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter to the
            <code class="code">Base.destroy</code> method should be avoided due to its
            unpredictable behaviour.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the <code class="varname">Base.cellData</code>
        base property (which exists if the cell entity has not been created)
        are also not checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code"> resources.xml/system/terrain2
        </code> (by default, <code class="code"> system/data/terrain2.xml </code> ) is
        loaded each time that terrain is loaded. This can cause disk access in
        the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The file specified by <code class="code">
        resources.xml/environment/materialKinds </code> (by default, <code class="code">
        system/data/material_kinds.xml </code> ) is loaded the first time a
        collision test occurs that involves terrain. This can cause disk
        access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The <code class="code"> UserDataObjectRef </code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="code"> fantasydemo/res/scripts/cell/FantasyDemo.py </code> and
        <code class="code"> fantasydemo/res/scripts/base/FantasyDemo.py </code> for
        examples.</p></li><li class="listitem"><p><code class="code"> FIXED_DICT </code> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scritps.</p></li><li class="listitem"><p>Currently, MySQL stored procedures are not supported when used
        with the <code class="code"> BigWorld.executeRawDatabaseCommand </code>
        method.</p><p>For details on this method, see the document <em class="emphasis"> Server Programming Guide </em> 's section <em class="emphasis"> The Database Layer -&gt; Execute Arbitrary Commands On
        Database </em> .</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>Customers using Debian Etch will experience issues with
        WebConsole and StatLogger failing overnight due to a MySQL
        reconnection issue. The cause of this issue is due to MySQL timing out
        inactive connections after 8 hours. Currently the default package
        versions of MySQL-python and SQLObject provided by Debian Etch do not
        include a known fix for this issue. The suggested work around for this
        problem is to restart WebConsole every morning prior to the majority
        of developers starting work. This can be achieved by added a cron job
        to the root user of the machine running WebConsole as follows:</p><pre class="programlisting"># 06:30 Mon-Fri: Restart WebConsole to avoid MySQL reconnection issues
30 6 * * 1-5 /etc/init.d/bw_web_console restart       </pre></li><li class="listitem"><p>The new function
        <code class="methodname">findRandomNeighbourPoint()</code> is a work in
        progress, and may return points such that, when the points are passed
        to <code class="methodname">canNavigateTo()</code>, the resulting nearest
        navigable point may be some distance away.</p></li><li class="listitem"><p>The packaged version of the ConsolidateDBs binary executable
        (located in
        <code class="filename">bigworld/bin/Hybrid/commands/consolidate_dbs</code>)
        cannot be run on Fedora 9 due to a difference in the version of the
        OpenSSL library that it was dynamically linked against when compiled
        under Fedora 8. In order for it to work with Fedora 9, a re-compile is
        required: from the top-level BigWorld directory, run:</p><pre class="programlisting">$ make -C bigworld/src/server/tools/consolidate_dbs clean all</pre></li><li class="listitem"><p>The 64-bit version of the server uses up to 50% more memory than
        the 32-bit version in some cases.</p><p class="remark"><em><span class="remark">Bug 24442</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.1.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5795"></a>BigWorld Technology 1.9.1.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5798"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a bug that could cause players to not see some other
        players or entities. This can happen if entities teleport very quickly
        in and out of a space in a very small duration of time, causing
        witnessing players to not be able to receive updates for those
        teleported entities.</p><p class="remark"><em><span class="remark">Bug 22779</span></em></p></li><li class="listitem"><p>Fixed a bug where changing an entity's controlledBy property
		to None then back again may cause all future updates from the client
		to be ignored.
        [<span class="citation">Ticket ID: 120</span>]
		</p><p class="remark"><em><span class="remark">Bug 24736</span></em></p></li><li class="listitem"><p>Fixed a bug whereby mailbox properties on entities are
		  unavailable to scripts on the bots process.</p><p class="remark"><em><span class="remark">Bug 24109</span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.1.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5820"></a>BigWorld Technology 1.9.1.2 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5823"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Included <code class="code"> src/lib/makefile
        </code> in the package to enable server compilation.
 		<em><span class="remark"> bug: 24168 </span></em>
		[<span class="citation">Ticket ID: 88</span>]
		[<span class="citation">Ticket ID: 93</span>]
		</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.1.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5842"></a>BigWorld Technology 1.9.1.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5845"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Included <code class="code"> bigworld/src/server/common/test_mysql.sh
        </code> in the package. <code class="code">bigworld/src/server/tools/consolidate_dbs</code> can now be compiled.</p><p class="remark"><em><span class="remark"> bug: 23832 </span></em></p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e5860"></a>BigWorld Technology 1.9.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5863"></a>1.&nbsp;Overview</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>BigWorld Technology 1.9.1 is the latest version of the BigWorld
        Technology engine. This version should allow customers to develop and
        release their games and is considered a feature complete, fully tested
        version for the BigWorld 1.9 series.</p></li></ul></div></div><div class="section" title="2.&nbsp;Executive Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5870"></a>2.&nbsp;Executive Summary</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The load on the DBMgr and primary MySQL database can now be
        significantly reduced. This is done via the use of intermediate,
        SQLite databases that are local to BaseApps to store entity archive
        data.</p><p>For further information please review the <em class="emphasis">Server Programming Guide</em>.</p></li><li class="listitem"><p>A new <em class="emphasis">Release Planning</em> document
        has been introduced. This document details the steps required to
        successfully release a game using the BigWorld Technology engine. It
        is recommended to review this document during the game development
        stages to ensure a successful game release.</p></li><li class="listitem"><p>The server has been ported to the x86-64 platform allowing
        server components to access much more memory and advanced performance
        and security features of all recent Intel and AMD processors.</p><p>In this release we do not recommend or support full scale
        commercial deployment using this platform, but do encourage and support
        development, testing and trial deployments. We anticipate it to be
        sufficiently tested by 1.9.2.</p></li></ul></div></div><div class="section" title="3.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5893"></a>3.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Secondary databases can be enabled to provide better scalability
        for large systems where the MySQL database is the bottleneck.</p><p>For details, see the document <em class="emphasis">Server
        Programming Guide</em>'s section <em class="emphasis"> The
        Database Layer -&gt; Secondary Databases</em>.</p></li><li class="listitem"><p>Servers will log a stack trace when hitting a critical assertion
        for easier bug reports.</p><p class="remark"><em><span class="remark">bug 21460</span></em></p></li><li class="listitem"><p>Added support for user-dependent bw.xml file to allow easier
        support for multiple users running from the same resource tree.</p><p>If a file with the name
        <code class="filename">bw_&lt;username&gt;.xml</code> exists, this is now used
        as the start of the server configuration chain instead of
        <code class="filename">bw.xml</code>.</p><p class="remark"><em><span class="remark">bug 19960</span></em></p></li><li class="listitem"><p>A new profiling command, called
        <span class="literal">mercuryprofile</span>, has been added to the
        ControlCluster command line tool for profiling Mercury interface
        statistics. For each process specified, a report is generated with
        statistics based on the number and size of messages received by that
        process.</p><p class="remark"><em><span class="remark">Bug 18153</span></em></p></li><li class="listitem"><p>Added LoginApp login rate statistics to StatGrapher:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Total Logins Per Second</p></li><li class="listitem"><p>Rate-limited Logins Per Second</p></li><li class="listitem"><p>Successful Logins Per Second</p></li><li class="listitem"><p>Failed Logins Per Second</p></li></ul></div><p>These statistics are 5-second exponentially weighted averages,
        sampled each second.</p><p class="remark"><em><span class="remark">Bug 20978</span></em></p></li><li class="listitem"><p>New server configuration options have been added to limit how
        many overflowed packets are allowed per channel type.</p><pre class="programlisting">
&lt;maxChannelOverflow&gt;
	&lt;external&gt; 1024 &lt;/external&gt;
	&lt;internal&gt; 8192 &lt;/internal&gt;
	&lt;indexed&gt;  4096 &lt;/indexed&gt;
	&lt;isAssert&gt; false &lt;/isAssert&gt;
&lt;/maxChannelOverflow&gt;
</pre><p class="remark"><em><span class="remark">Bug 21536</span></em></p></li><li class="listitem"><p>Added a new timer option called <span class="literal">gettime</span> which
        uses the high-resolution monotonic timer in the Linux kernel for
        better stability in environments where NTP is used.</p><p class="remark"><em><span class="remark">Bug 22116</span></em></p></li><li class="listitem"><p>Added a new configuration setting in
        <code class="filename">/etc/bwmachined.conf</code> called
        <code class="code">InternalInterface</code>. This option disables auto-discovery of
        the internal network interface by allowing the internal network
        interface to be specified. For more details, refer to the Server
        Installation Guide <span class="symbol">&#8594;</span>
        <code class="filename">/etc/bwmachined.conf</code> and InternalInterface.</p><p class="remark"><em><span class="remark">Bug 21030</span></em></p></li><li class="listitem"><p>All server components can now be compiled as native 64 bit
         binaries to support &gt;4GB of memory per process, longer registers,
         faster integer maths, NX support etc.</p><p>This feature is not yet officially support. If you are interested
        in using pre-release, native 64-bit binaries, please contact
        support@bigworldtech.com.</p><p class="remark"><em><span class="remark">Bug 19816</span></em></p></li><li class="listitem"><p>Added a mechanism to help detect issues with ghost entities.</p><p>The option <code class="code">cellApp/enforceGhostDecorators</code> has been
        added to <code class="filename">bw.xml</code>. If enabled, a cell entity method
        that is not in the <code class="filename">.def</code> file can only be called on
        a potential ghost entity if it has the
        <code class="code">@bwdecorators.callableOnGhost</code> decorator.</p><p>This is disabled by default so that functionality does not change.
        It is recommended that you enable this and
        <code class="code">cellApp/treatAllOtherEntitiesAsGhosts</code> during debugging.
        </p><p class="remark"><em><span class="remark">Bug 22995</span></em></p></li><li class="listitem"><p>Added a new function named
        <code class="methodname">findRandomNeighbourPoint()</code> to find a nearby
        random point around a given point. The result point is guaranteed to
        be connectable to the given point. <em class="emphasis">Note:
		</em> This function is still a work in progress.</p><p class="remark"><em><span class="remark">bugs 22494 and 23737</span></em></p></li><li class="listitem"><p>Added <code class="code">BigWorld.registerFileDescriptor</code> and related
        methods to script on BaseApps and CellApps. These allow Python sockets
        and files to be added to the nub's select loop so that they can be
        processed in a non-blocking way. A callback will be called when there
        is something of interest on the file descriptor.</p><p class="remark"><em><span class="remark">bug 23264</span></em></p></li></ul></div></div><div class="section" title="4.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6036"></a>4.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The Python navigation interface has been changed. A new, optional
        parameter <code class="code">maxDistance</code> has been added to a number of
        methods. This limits the search range to the specified distance to help
        avoid CellApp CPU spikes.</p><p><em class="emphasis">Important note:</em> All existing
        code calling these functions <em class="emphasis">must</em> be
        reviewed and modified accordingly to reflect the interface
        change.</p><p class="remark"><em><span class="remark">bug 22685</span></em></p></li><li class="listitem"><p>Added configuration options
        <span class="literal">&lt;baseApp/shouldResolveMailBoxes&gt;</span> and
        <span class="literal">&lt;cellApp/shouldResolveMailBoxes&gt;</span> to
        <code class="filename">bw.xml</code>. These options are defaulted to
        false.</p><p>Previously, if a mailbox could be resolved to a local entity,
        the mailbox was immediately replaced with a reference to that entity.
        This lead to error-prone code as mailbox arguments were used
        incorrectly to access entity properties directly. This often occurred
        during development when running in an environment with a single
        BaseApp or CellApp.</p><p class="remark"><em><span class="remark">bug 14064</span></em></p></li><li class="listitem"><p>New default server configuration files have been added. These
        files replace
        <code class="filename">bigworld/res/server/defaults.xml</code>.</p><p>You should update your <span class="literal">parentFile</span> entry in
        <code class="filename">bw.xml</code> to use
        <code class="filename">server/development_defaults.xml</code> during
        development and <code class="filename">server/production_defaults.xml</code>
        during production.</p><p>A new top level configuration option
        <span class="literal">&lt;production&gt;</span> has also been added which forces
        server processes to emit an <span class="literal">ERROR</span> message when bad
        production mode settings are encountered.</p><p class="remark"><em><span class="remark">Bug 18267</span></em></p></li><li class="listitem"><p>Certain warnings and debug messages relating to network
        reliability have been removed since they created excessive log
        messages and did not have any diagnostic merit.</p></li><li class="listitem"><p>Supporting better aggregation of messages sent on <em class="emphasis">
        irregular* </em> channels.</p><p>When making script calls on a BaseMailBox, for example,
        previously a network packet was created for each call. The sending of
        these messages have now been delayed slightly so that multiple
        messages to over the same channel can be aggregated.</p><p><em class="emphasis"> *An irregular channel is a channel that does not have
        a regular send interval. </em></p></li><li class="listitem"><p>CellApp's <code class="code"> Entity.findCover </code> function has been
        deprecated, since it relies in the deprecated reannotation
        information, previously generated by NavGen.</p></li><li class="listitem"><p>A cell mailbox is now available when the cell entity's creation
        is pending.</p></li><li class="listitem"><p>Primitive BigWorld data types as defined in
        <code class="filename">cstdmf/stdmf.hpp</code> such as
        <span class="type">int8</span>/<span class="type">uint16</span>/<span class="type">int32</span>/<span class="type">uint32</span>,
        have been modified to be fixed size types as opposed to 32 bit
        platform equivalents.</p><p class="remark"><em><span class="remark">bug 20972</span></em></p></li><li class="listitem"><p>BigWorld message macros (<em class="emphasis">i.e.</em>
        <span class="literal">ERROR_MSG</span> ...) have enabled GCC's static argument
        checking.</p><p class="remark"><em><span class="remark">bug 20261</span></em></p></li><li class="listitem"><p>Entities on the servers now expose an attribute "className" for
        consistency with ServerEntityMailbox.</p><p class="remark"><em><span class="remark">bug 21179</span></em></p></li><li class="listitem"><p>Changed the behaviour of the callback when an error occurs when
        script calls any of the functions:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><code class="methodname">BigWorld.createBaseRemotely()</code></p></li><li class="listitem"><p><code class="methodname">BigWorld.createBaseAnywhere()</code></p></li><li class="listitem"><p><code class="methodname">BigWorld.createBaseFromDB()</code></p></li><li class="listitem"><p><code class="methodname">BigWorld.createBaseFromDBID()</code></p></li><li class="listitem"><p><code class="methodname">BigWorld.createBaseAnywhereFromDB()</code></p></li><li class="listitem"><p><code class="methodname">BigWorld.createBaseAnywhereFromDBID()</code></p></li></ul></div><p>Previously in 1.9.0, if there was a problem while resolving the
        mailbox that was used to pass into the entity parameter of the
        callbacks registered with these functions, it would pass
        <span class="literal">None</span> for the entity parameter and fail silently.
        Error log output is now emitted in this case, and an invalid mailbox
        is passed through.</p><p class="remark"><em><span class="remark">Bug 21327</span></em></p></li><li class="listitem"><p>Space data is no longer archived by default in BigWorld servers.
        This feature appeared to not be used by most of our customers and
        disabling improves DBMgr performance.</p><p>To re-enable this feature use the
        <span class="literal">&lt;cellAppMgr/archivePeriod&gt;</span> option in
        <code class="filename">bw.xml</code>.</p><p class="remark"><em><span class="remark">Bug 19608</span></em></p></li><li class="listitem"><p>Setting Identifier properties (that is, defined entity
        properties that have <span class="literal">&lt;Identifier&gt; true
        &lt;/Identifier&gt;</span> ) for <span class="literal">BASE</span> properties
        for entities that have already been saved to the database (these
        entities have non-zero database IDs) will result in a Python
        <code class="classname">ValueError</code> exception being raised.</p><p>This is to prevent the situation where an entity that has been
        saved to the database with one identifier then changes that identifier
        to a new string. On this entity's next attempt to save itself to the
        database, the new value for the identifier property may break the
        uniqueness constraint on the identifier property if the same value for
        the identifier property exists for another entity in the
        database.</p><p>See also the associated entry in Known Issues regarding
        identifier properties.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>Instances of the <span class="literal">baseApp/externalPorts</span>
        <code class="filename">bw.xml</code> option that appear in different
        <span class="literal">baseApp</span> sections (within the same file and across
        configuration files in the <span class="literal">ParentFile</span> chain) are
        now respected. Previously, only the <span class="literal">baseApp</span> section
        that appeared first had its <span class="literal">externalPort</span> elements
        respected.</p><p class="remark"><em><span class="remark">Bug 21606</span></em></p></li><li class="listitem"><p>Destroying the default space from Python is no longer
        allowed.</p><p class="remark"><em><span class="remark">bug 18858</span></em></p></li><li class="listitem"><p>Allow a corresponding cell entity to be destroyed from the BaseApp
          as soon as it is requested.
        </p><p class="remark"><em><span class="remark">Bug 22729 </span></em></p></li><li class="listitem"><p>The third party flashticle package used by the StatGrapher has
        been replaced by the PyAMF package.  </p><p class="remark"><em><span class="remark">Bug 21338</span></em></p></li><li class="listitem"><p>The virtual function
          <code class="code">handleTimeout( Mercury::TimerID id, void * arg )</code>
          now cannot be overloaded using an <code class="code">int</code> as its
          <code class="code">id</code> parameter.</p><p class="remark"><em><span class="remark">Bug 19816, Caveat of the 64 bit port.</span></em></p></li></ul></div></div><div class="section" title="5.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6278"></a>5.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a potential CellApp crash caused by using a deleted
        Channel.</p><p>This could occur if a message in a packet on an entity's channel
        caused that entity to teleport. If there were further buffered packets
        on this channel, these would be processed after the channel was
        gone.</p></li><li class="listitem"><p>Fixed DBMgr compilation errors when <code class="code">
        USE_MYSQL_PREPARED_STATEMENTS=0 </code> in the make file.</p></li><li class="listitem"><p>The file specified by <code class="code"> resources.xml/system/terrain2
        </code> (by default, <code class="code"> system/data/terrain2.xml </code> ) is now
        loaded at startup, and no longer needs to be loaded and referenced in
        your cell's personality script to prevent disk access in the main
        thread</p></li><li class="listitem"><p>The file specified by <span class="literal">
        resources.xml/environment/materialKinds </span> (by default,
        <span class="literal"> system/data/material_kinds.xml </span> ) is now loaded at
        startup, and no longer needs to be loaded and referenced in your
        cell's personality script to prevent disk access in the main
        thread</p></li><li class="listitem"><p>Corrected spurious warning message when spaces are
        destroyed.</p></li><li class="listitem"><p>Improved navigation support when inside shells.</p><p class="remark"><em><span class="remark">Bug 19655</span></em></p></li><li class="listitem"><p>Fixed an issue where an uncontrolled BaseApp process death could
        cause corruption of the global bases registry.</p><p class="remark"><em><span class="remark">Bug 21352</span></em></p></li><li class="listitem"><p>The web integration module sources are now included, so now the
        server Makefile will not fail because of the missing
        subdirectory.</p><p class="remark"><em><span class="remark">Bug 20564</span></em></p></li><li class="listitem"><p>Fixed an issue with Base reference counting. If a Base is
        created and the Base Python script calls
        <code class="varname">self</code>.<code class="methodname">destroy</code>() in
        <code class="methodname">__init__</code>(), this can cause the Base object to
        be destructed prematurely which can cause dangling Python
        references.</p><p class="remark"><em><span class="remark">Bug 21464</span></em></p></li><li class="listitem"><p>Fixed an issue with the ControlCluster command line tool missing
        the <span class="literal">eventprofile</span> command.</p><p class="remark"><em><span class="remark">Bug 17429</span></em></p></li><li class="listitem"><p>Fixed an issue with BigWorld module being un-imported on script
        reload via <code class="methodname">BigWorld.reloadScript()</code>.</p><p class="remark"><em><span class="remark">Bug 21588</span></em></p></li><li class="listitem"><p>Fixed an issue with the cell counterparts to base entities that
        have not been successfully restored after a crash sending garbage to
        the baseapp it thinks it has been restored to.</p><p class="remark"><em><span class="remark">Bug 21535</span></em></p></li><li class="listitem"><p>Fixed shutting down the server when
        <code class="code">shutDownServerOnBadState</code> is <code class="code">true</code>.
        Previously, the server would not shut down cleanly if the last CellApp
        died.</p><p class="remark"><em><span class="remark">Bug 21752</span></em></p></li><li class="listitem"><p>The StatGrapher legend has been modified so that only values
        greater than or equal to one million are displayed in scientific
        notation. Previously the rollover was 1000.</p></li><li class="listitem"><p>Fixed a bug where an incoming bundle could time out and never be
        received even though it is on a channel.</p><p class="remark"><em><span class="remark">Bug 22179</span></em></p></li><li class="listitem"><p>Fixed the library scripts in
        <code class="code">bigworld/res/entities/common/Lib</code> which were of a previous
        version to the Python interpreter used in server apps.</p><p class="remark"><em><span class="remark">Bug 22199</span></em></p></li><li class="listitem"><p>Added <code class="code">BigWorld.getMaterialKinds</code> method to CellApp's
        Python API. This was previously only available on the client.</p><p class="remark"><em><span class="remark">Bug 22479</span></em></p></li><li class="listitem"><p>
		  Fixed the library scripts in
		  <code class="code">bigworld/res/entities/common/Lib</code> which were of a
		  previous version to the Python interpreter used in server apps.</p><p class="remark"><em><span class="remark">Bug 22199</span></em></p></li><li class="listitem"><p>
		  Fixed a bug where two seperate logins from the same client would
		  be mistaken for resending the request after the reply had been
		  dropped.</p><p class="remark"><em><span class="remark">Bug 22502</span></em></p></li><li class="listitem"><p>Fixed a bug where enabling <code class="code">baseApp/packetLog</code> would
		  cause the  BaseApp to immediately segfault when a client connected.
		</p><p class="remark"><em><span class="remark">Bug 22832</span></em></p></li><li class="listitem"><p>Fixed a bug where overflow packets are not cleared when the
		  channel is reset.
		</p><p class="remark"><em><span class="remark">Bug 22973</span></em></p></li><li class="listitem"><p>User data object circular references are now broken up when
      	chunks containing one or more of these user data objects are unloaded.
		</p><p class="remark"><em><span class="remark">Bug 21674</span></em></p></li><li class="listitem"><p>Bots will not needlessly time out when packet loss occurs.
		</p><p class="remark"><em><span class="remark">Bug 23249</span></em></p></li><li class="listitem"><p>The displaying of Python backtraces will become asynchronous if
		reading in the source file would cause the main thread to block.</p><p class="remark"><em><span class="remark">Bug 12999</span></em></p></li></ul></div></div><div class="section" title="6.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6440"></a>6.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Due to adding support to the <code class="code"><em class="replaceable"><code>*</code></em>_MSG</code>
        message macros for the <span class="literal">%z</span> format string modifier, log messages
        generated from 1.9.1 client / server processes using <span class="literal">%z</span> will
        be incorrectly saved by 1.9.0 or earlier instances of MessageLogger.</p><p>The recommended solution for this issue is to remove the old log directory
        when installing the 1.9.1 server tools and allow a completely fresh set of logs
        to be written.</p><p>For example:</p><pre class="programlisting">$ rm -rf /var/log/bigworld/message_logger</pre></li><li class="listitem"><p><em class="emphasis">Fedora 9</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Python hashlib does not function correctly in Bots process
            or BaseApp due to an incompatibility between versions of
            openssl.</p><p class="remark"><em><span class="remark">Bug 21059</span></em></p></li></ul></div></li><li class="listitem"><p><em class="emphasis">Secondary Databases</em></p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>When secondary databases are enabled and the final
            <code class="code">writeToDB</code> operation is disabled by passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter of the
            <code class="code">Base.destroy</code> function, all <code class="code">writeToDB</code>
            operations on the entity since the entity was loaded from the
            database may be disregarded. For example: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Entity A is loaded from the database</p></li><li class="listitem"><p>Entity A's properties are changed.</p></li><li class="listitem"><p>Entity A is written to the database by calling the
                  <code class="code">Base.writeToDB</code> method.</p></li><li class="listitem"><p>Entity A is destroyed by calling the
                  <code class="code">Base.destroy</code> method but <code class="code">False</code> is
                  passed in the <code class="code">writeToDB</code> parameter.</p></li></ol></div><p> The <code class="code">writeToDB</code> operation in step 3,
            may be disregarded and the changes to entity A's properties in
            step 2 will be lost.</p><p>There is no guarantee that the changes will be lost so this
            cannot be used as a rollback facility. If the system is shutdown
            soon after the entity is destroyed (with <code class="code">writeToDB =
            False</code>), then the changes to the entity may be
            retained.</p><p>The correct behaviour should be to retain all the changes
            that were supposedly written to the database using the
            <code class="code">Base.writeToDB</code> method. BigWorld will conform to this
            behaviour in a future release. In the meantime, passing
            <code class="code">False</code> in the <code class="code">writeToDB</code> parameter to the
            <code class="code">Base.destroy</code> method should be avoided due to its
            unpredictable behaviour.</p></li></ul></div><p class="remark"><em><span class="remark">Bug 20612</span></em></p></li><li class="listitem"><p>This is associated with the Changed Feature regarding Identifier
        properties.</p><p>In 1.9.1, we do not catch instances of setting identifier
        properties that exist on the cell entity (e.g.
        <span class="literal">ALL_CLIENTS</span> properties), as we do for identifier
        properties on the base entity. In addition, modifications to a cell
        entity identifier property in the <code class="varname">Base.cellData</code>
        base property (which exists if the cell entity has not been created)
        are also not checked.</p><p>If an entity has been previously saved to the database
        successfully, and the identifier property on the cell entity (or the
        identifier property's entry in the <code class="varname">cellData</code>
        dictionary) subsequently changes, the next attempt to save to the
        database could fail due to the uniqueness constraint on that
        identifier property being broken in the event that another entity is
        keyed to the new value of the identifier property being set.</p><p class="remark"><em><span class="remark">Bug 19719</span></em></p></li><li class="listitem"><p>The file specified by <code class="code"> resources.xml/system/terrain2
        </code> (by default, <code class="code"> system/data/terrain2.xml </code> ) is
        loaded each time that terrain is loaded. This can cause disk access in
        the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The file specified by <code class="code">
        resources.xml/environment/materialKinds </code> (by default, <code class="code">
        system/data/material_kinds.xml </code> ) is loaded the first time a
        collision test occurs that involves terrain. This can cause disk
        access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The <code class="code"> UserDataObjectRef </code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="code"> fantasydemo/res/scripts/cell/FantasyDemo.py </code> and
        <code class="code"> fantasydemo/res/scripts/base/FantasyDemo.py </code> for
        examples.</p></li><li class="listitem"><p><code class="code"> FIXED_DICT </code> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scritps.</p></li><li class="listitem"><p>Currently, MySQL stored procedures are not supported when used
        with the <code class="code"> BigWorld.executeRawDatabaseCommand </code>
        method.</p><p>For details on this method, see the document <em class="emphasis"> Server Programming Guide </em> 's section <em class="emphasis"> The Database Layer -&gt; Execute Arbitrary Commands On
        Database </em> .</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>Customers using Debian Etch will experience issues with
        WebConsole and StatLogger failing overnight due to a MySQL
        reconnection issue. The cause of this issue is due to MySQL timing out
        inactive connections after 8 hours. Currently the default package
        versions of MySQL-python and SQLObject provided by Debian Etch do not
        include a known fix for this issue. The suggested work around for this
        problem is to restart WebConsole every morning prior to the majority
        of developers starting work. This can be achieved by added a cron job
        to the root user of the machine running WebConsole as follows:</p><pre class="programlisting">
          # 06:30 Mon-Fri: Restart WebConsole to avoid MySQL reconnection issues
30 6 * * 1-5 /etc/init.d/bw_web_console restart
        </pre></li><li class="listitem"><p>The new function
        <code class="methodname">findRandomNeighbourPoint()</code> is a work in
		progress, and may return points such that, when the points are passed to
        <code class="methodname">canNavigateTo()</code>, the resulting nearest
        navigable point may be some distance away.</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.0.5 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6648"></a>BigWorld Technology 1.9.0.5 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6651"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Extended the buffer size used when reading <code class="code"> /proc/cpuinfo
        </code> in bwmachined. The short buffer size was causing a crash when
        the processor flags line exceeded 256 characters (as seen on Opteron
        machines).</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.0.4 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6661"></a>BigWorld Technology 1.9.0.4 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6664"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Fixed a bug where any base entity with the <code class="code"> cellData
        </code> member (i.e. its cell entity has not yet been created or has
        already been destroyed) cannot be restored if the BaseApp that it is
        on crashes.</p></li><li class="listitem"><p>Fixed a bug where if the configuration setting <code class="code">
        &lt;baseApp&gt;/&lt;backUpUndefinedProperties&gt; </code> is set to
        false, entities cannot be backed up successfully.</p><p>Initially added in BigWorld 1.8.6.1.</p></li><li class="listitem"><p>Fixed an issue with Base reference counting. If a Base is
        created and the Base Python script calls <code class="code"> self.destroy() </code>
        in <code class="code"> __init__() </code> , this can cause the Base obejct to be
        destructed prematurely which can cause dangling Python
        references.</p></li><li class="listitem"><p>Fixed a bug that could cause a CellApp assertion to be hit if a
        BaseApp dies.</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.0.3 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6694"></a>BigWorld Technology 1.9.0.3 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6697"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The web integration module sources are now included, The server
        Makefile will no longer fail due to these sources being missing (fixed
        since 1.9.0.1).</p></li><li class="listitem"><p>Fixed possible loss of ARRAY property data when two <code class="code">
        BigWorld.writeToDB </code> operations for the same entity are
        performed concurrently in different threads in the DBMgr.</p><p>Initially added in BigWorld 1.8.6.1.</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9.0.2 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6712"></a>BigWorld Technology 1.9.0.2 Server Release Notes</h2></div></div><hr></div><p>No changes were done to the server for 1.9.0.2.</p></div><div class="article" title="BigWorld Technology 1.9.0.1 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6717"></a>BigWorld Technology 1.9.0.1 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6720"></a>1.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>If multiple entities teleported between the same spaces, at the
        same time, it was possible for property changes that occurred just
        before teleporting, not to be propagated. This has now been
        fixed.</p><p>Initially added in BigWorld 1.8.4.3.</p></li><li class="listitem"><p>Fixed a potential crash due channel being accessed after being
        deleted.</p><p>Initially added in BigWorld 1.8.4.2.</p></li><li class="listitem"><p>Fixed a memory leak associated with unacked packets.</p><p>Initially added in BigWorld 1.8.4.2.</p></li><li class="listitem"><p>Fixed a memory leak in the bots where calling <code class="code"> Bot.moveTo(
        position ) </code> was never releasing the memory associated with the
        previous movement destination.</p><p>Initially added in BigWorld 1.8.4.2.</p></li><li class="listitem"><p>Fixed a problem where two clients could log in with the same
        account details at the same time. If <code class="code"> Proxy.onLogOnAttempt
        </code> allowed the second login, an assertion on the BaseApp could be
        triggered if both logins succeeded.</p></li></ul></div></div></div><div class="article" title="BigWorld Technology 1.9 Server Release Notes"><div class="titlepage"><div><div><h2 class="title"><a name="d0e6753"></a>BigWorld Technology 1.9 Server Release Notes</h2></div></div><hr></div><div class="section" title="1.&nbsp;Important Notes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6756"></a>1.&nbsp;Important Notes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Please refer to <em class="emphasis"> How To Convert to
        BigWorld 1.9 </em> for more detailed information on migrating
        from BigWorld 1.8 to 1.9.</p></li><li class="listitem"><p>MySQL databases created by BigWorld 1.8.x must be upgraded to
        work correctly with BigWorld 1.9. Before starting the new server,
        backup your database and run:</p><pre class="programlisting">
          dbmgr -upgrade
        </pre><p>Please note that this operation only works if the tables in the
        database currently matches the entity definition. Do not attempt to
        upgrade the database and change the entity definition at the same
        time.</p><p>In BigWorld 1.9, entity property columns have the "NOT NULL"
        specification. As part of the upgrade process, existing NULL values
        will be set to the default value of the property</p></li><li class="listitem"><p>The <code class="code"> seeingHeight </code> argument of the cell entity
        methods <code class="code"> addVision </code> and <code class="code"> addScanVision </code> has
        changed. See the details in the <em class="emphasis"> Changed Features
        </em> section.</p></li><li class="listitem"><p>The BigWorld Technology suite now does some simple XML
        validation.</p><p>Previously, badly formed XML was allowed, but this resulted in
        third-party applications being unable to parse XML resources.</p><p>The main source of these problems is spaces in tag names and tag
        names beginning with numbers, which mostly occurs in three
        places:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p><code class="code"> .graph </code> files, which have tags based upon a
            UID, and frequently begin with numbers.</p></li><li class="listitem"><p>Particle systems, which could have spaces in the
            sub-particle system names.</p></li><li class="listitem"><p>Node names in model files, which quite often have spaces in
            certain tags.</p></li></ul></div><p>In version 1.9, the use of such tags result in a warning being
        issued. Future versions of BigWorld Technology will make this an
        error.</p><p>To fix these warnings, you can either manually edit the XML, or
        you can run AssetProcessor, which finds the locations of these errors
        (and in the cases of particle systems, models and graph files, fix
        them for you).</p><p>Badly formed tags should be fixed as follows: </p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Spaces in tags should be replaced with <code class="code"> '..' </code>
              .</p><p>For example, <code class="code"> &lt;my tag&gt; </code> should be
              replaced with <code class="code"> &lt;my..tag&gt; </code> .</p><p>Internally what the tag refers to still retains the
              spaces, so for example, in Python or C++, a sub-particle
              system's name is referred to in exactly the same way as
              before.</p></li><li class="listitem"><p>UID tags in <code class="code"> .graph </code> files should be prefixed
              with <code class="code"> 'id.' </code> .</p><p>For example, <code class="code">
              &lt;0897F6FD.4B03ADAD.0F9401B6.C483C775&gt; </code> should be
              replaced with <code class="code">
              &lt;id.0897F6FD.4B03ADAD.0F9401B6.C483C775&gt; </code> .</p></li></ul></div></li></ul></div></div><div class="section" title="2.&nbsp;New Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6849"></a>2.&nbsp;New Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Added the BigWorld Web Integration Module. This module allows
        web servers to make method calls to entities on a running BigWorld
        server, and allows for the creation of web interfaces into your game,
        which can be accessible via PC browsers, mobile phones and other
        mobile devices. There are two flavours currently supported: Python and
        PHP.</p><p>For details, see the document <em class="emphasis"> Web
        Integration Reference </em> and <em class="emphasis"> How to
        Implement Web Integration </em> .</p></li><li class="listitem"><p>Added the <code class="code"> FLOAT64 </code> data type, that corresponds to
        a IEEE 64-bit floating-point number.</p><p>For details, see the document <em class="emphasis"> Server
        Programming Guide </em> 's sections <em class="emphasis">
        Properties -&gt; Property Types -&gt; Primitive Types </em> and
        <em class="emphasis"> The Database Layer -&gt; Mapping BigWorld
        Properties Into SQL -&gt; Simple Data Types </em> .</p></li><li class="listitem"><p>Added context support to <code class="code"> mlcat.py </code> and the
        WebConsole's LogViewer module.</p><p>For details on <code class="code"> mlcat.py </code> , see the document
        <em class="emphasis"> Server Operations Guide </em> 's section
        <em class="emphasis"> Admin Tools -&gt; Logger Daemons -&gt;
        MessageLogger -&gt; Command-line Utilities </em> .</p><p>For details on WebConsole's LogViewer module, see the document
        <em class="emphasis"> Server Operations Guide </em> 's section
        <em class="emphasis"> Admin Tools -&gt; WebConsole -&gt; Modules
        -&gt; LogViewer </em> and WebConsole's online help.</p></li><li class="listitem"><p>Added the configuration options <code class="code"> cellApp/maxGhostsToDelete
        </code> and <code class="code"> cellApp/minGhostLifespan </code> to allow control
        of anti-hysteresis in creation and deletion of ghost entities.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis"> Server
        Configuration With <code class="code"> bw.xml </code> -&gt; CellApp Configuration
        Options </em> .</p></li><li class="listitem"><p>Added support to use of more CellApps to initially load the
        geometry of a space (if it has not been loaded, then more cells will
        be added, to help load the space faster).</p><p>This is controlled by the <code class="code"> cellAppMgr/maxLoadingCells
        </code> and <code class="code"> cellAppMgr/minLoadingArea </code> configuration
        options in <code class="code"> bw.xml </code> .</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis">
        Software Configuration With <code class="code"> bw.xml </code> -&gt; CellAppMgr
        Configuration Options </em> .</p></li><li class="listitem"><p>The optional argument <code class="code"> shouldLoadOnServer </code> has been
        added to <code class="code"> BigWorld.addSpaceGeometryMapping </code> on the
        CellApp.</p><p>This argument also specifies whether the geometry should only be
        loaded on the client, but not on the server.</p><p>For details, see the <em class="emphasis"> CellApp Python API
        </em> and <em class="emphasis"> CellApp C++ API </em>
        documentations.</p></li><li class="listitem"><p>The BigWorld version is now accessible in code as a string using
        the <code class="code"> BWVersion::versionString() </code> method.</p></li><li class="listitem"><p>Added the <code class="code"> Entity.getDict </code> method to cell entities,
        which is useful for debugging while inspecting all <code class="code"> .def </code>
        file properties. On other processes, the <code class="code"> __dict__ </code>
        property can be used.</p><p>For details, see the <em class="emphasis"> CellApp Python API
        </em> and <em class="emphasis"> CellApp C++ API </em>
        documentations.</p></li><li class="listitem"><p>Added support for accessing entries in a <code class="code"> FIXED_DICT
        </code> using attribute syntax -- <em class="emphasis"> i.e. </em> , you
        can use <code class="code"> self.myDict.myValue </code> as an alternative to <code class="code">
        self.myDict[ "myValue" ] </code> .</p><p>For details, see the document <em class="emphasis"> Server
        Programming Guide </em> 's section <em class="emphasis">
        Properties -&gt; Property Types -&gt; Composite Types -&gt; <code class="code">
        FIXED_DICT </code> Data Type </em> .</p></li><li class="listitem"><p>Documentation strings can now be added to methods exposed to
        Python (via new macros like <code class="code"> PY_METHOD_DECLARE_WITH_DOC </code>
        ).</p><p>For details, see the <em class="emphasis"> C++ API </em>
        documentations, and <code class="code"> src/lib/pyscript/pyobject_plus.hpp </code>
        .</p></li><li class="listitem"><p>Added the configuration option <code class="code">
        cellApp/maxPhysicsNetworkJitter </code> to allow control of tolerance
        for network jitter when performing physics validation.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis"> Server
        Configuration With <code class="code"> bw.xml </code> -&gt; CellApp Configuration
        Options </em> .</p></li><li class="listitem"><p>When entity definitions are parsed, a warning is now emitted to
        the logger if PYTHON arguments are used in exposed methods. The
        presence of PYTHON args in <code class="code"> Exposed </code> methods represent a
        security risk and should be converted to use more concrete types such
        as <code class="code"> FIXED_DICT </code> .</p></li><li class="listitem"><p>Added a new type of script object, the user data object, which
        allows embedding user-defined data in chunk files. A key feature of
        user data objects is their linkability, which allows both entities and
        user data objects to link to other user data objects. They can be
        instantiated in the client or the server.</p></li><li class="listitem"><p>Added the option <code class="code"> options/dbPrefix </code> to StatLogger
        which allows multiple instances to be run on the same host.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis"> Admin
        Tools -&gt; StatLogger -&gt; Option Configuration </em> .</p></li><li class="listitem"><p>Added the python callback <code class="code"> onBotsReady() </code> to bots
        which is called when the process becomes initialised.</p></li><li class="listitem"><p>Added member <code class="code"> base </code> to <code class="code"> CellViaBaseMailBox
        </code> and <code class="code"> cell </code> to <code class="code"> BaseViaCellMailBox </code>
        which is a direct MailBox to the intermediary entity for
        convenience.</p></li><li class="listitem"><p>Added a Flush User Mappings page in the administrative page of
        Web Console. This allows the administrator to flush user mappings of
        all bwmachined processes in the network so that new UNIX users can be
        used to create a new Web Console account.</p></li></ul></div></div><div class="section" title="3.&nbsp;Changed Features"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7103"></a>3.&nbsp;Changed Features</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <code class="code"> seeingHeight </code> argument of the cell entity
        methods <code class="code"> Entity.addVision </code> and <code class="code">
        Entity.addScanVision </code> is no longer scaled down by 0.875.</p><p>This scaling has been removed and the actual value passed in is
        now used.</p></li><li class="listitem"><p><code class="code"> BigWorld.createBaseAnywhere </code> and <code class="code">
        BigWorld.createBaseRemotely </code> can now accept data sections to
        describe the entity's properties.</p><p><code class="code"> BigWorld.createBaseLocally </code> has changed slightly
        to be consistent. Like the other <code class="code"> BigWorld.createBase </code>
        methods, it accepts multiple data sections.</p></li><li class="listitem"><p>The stream-data-to-client functionality formerly provided by
        <code class="code"> Proxy.addProxyData </code> is now provided by <code class="code">
        Proxy.streamStringToClient </code> and <code class="code"> Proxy.streamFileToClient
        </code> .</p><p>The callbacks on both the client and server have been renamed
        from <code class="code"> onProxyDataDownloadComplete </code> to <code class="code">
        onStreamComplete </code> .</p><p>Server-only customers should be aware that the <code class="code">
        onProxyData </code> method in the <code class="code"> ServerMessageHandler </code>
        interface in <code class="code"> servconn.hpp </code> has been changed to <code class="code">
        onStreamComplete </code> , and has a slightly different
        signature.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis">
        Software Configuration With <code class="code"> bw.xml </code> -&gt; CellApp
        Configuration Options -&gt; Download Streaming Configuration Options
        </em> , and the <em class="emphasis"> BaseApp Python API
        </em> and <em class="emphasis"> BaseApp C++ API </em>
        documentations</p></li><li class="listitem"><p>CellApp's <code class="code"> Entity.fieldOfView </code> attribute has been
        deprecated, since it is confusing (it is actually half the field of
        view) -- please use <code class="code"> Entity.visionAngle </code> instead.</p><p>For details, see the <em class="emphasis"> CellApp Python API
        </em> and <em class="emphasis"> CellApp C++ API </em>
        documentations.</p></li><li class="listitem"><p>The initial witnessed state of cell entities, as queried by
        <code class="code"> Entity.isWitnessed </code> , has changed to False.</p><p>Previously, entities were created assuming that they had just
        been witnessed, causing <code class="code"> Entity.onWitnessed( False ) </code>
        being called 8-12 minutes after creation (assuming no witnessing
        occurs in this period).</p><p>It has been changed so that entities are created assuming that
        they have <em class="emphasis"> not </em> been witnessed, such
        that after entity creation, <code class="code"> Entity.onWitnessed( False ) </code>
        is now not called until after <code class="code"> Entity.onWitnessed( True )
        </code> has been called when the entity has been witnessed.</p><p>For details, see the <em class="emphasis"> CellApp Python API
        </em> and <em class="emphasis"> CellApp C++ API </em>
        documentations.</p></li><li class="listitem"><p>The <code class="code"> FLOAT </code> data type has been renamed to <code class="code">
        FLOAT32 </code> . However, <code class="code"> FLOAT </code> is an alias for <code class="code">
        FLOAT32 </code> , so existing entity definitions will still
        work.</p><p>For details, see the document <em class="emphasis"> Server
        Programming Guide </em> 's sections <em class="emphasis">
        Properties -&gt; Property Types -&gt; Primitive Types </em> and
        <em class="emphasis"> The Database Layer -&gt; Mapping BigWorld
        Properties Into SQL -&gt; Simple Data Types </em> .</p></li><li class="listitem"><p>Old-style BaseApp backups ( <em class="emphasis"> i.e. </em> , via
        change of the IP address) are no longer supported.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis"> Fault
        Tolerance -&gt; BaseApp Fault Tolerance </em> , the document
        <em class="emphasis"> Server Overview </em> 's section
        <em class="emphasis"> Server Components -&gt; BaseApp -&gt; Fault
        Tolerance </em> , and the document <em class="emphasis"> Server
        Programming Guide </em> 's section <em class="emphasis"> Fault
        Tolerance -&gt; BaseApp Fault Tolerance </em> .</p></li><li class="listitem"><p>The Cell Viewer protocol has changed to support sending of space
        geometry mapping information to connected viewer clients.</p><p>The Cell Viewer now supports two extra message types to
        facilitate this: <code class="code"> GET_VERSION </code> and <code class="code">
        GET_SPACE_GEOMETRY_MAPPINGS </code> .</p><p>Space Viewer has added support for this by displaying the space
        geometry mapping in the top left corner of space viewer windows
        (however, this does not dynamically update at present).</p><p>For using the new protocol, see <code class="code"> cell_app_mgr_talker.py
        </code> .</p><p>For details on the new message types, see the <em class="emphasis"> CellAppMgr C++ API </em> documentation.</p></li><li class="listitem"><p>CellApp watchers under the <code class="code"> profiles/ </code> and <code class="code">
        python/ </code> directories have been standardised to camelCase
        format.</p></li><li class="listitem"><p>The macro to redefine when declaring <code class="code"> EntityExtra </code>
        derived class has changed from <code class="code"> PY_METHOD_ATTRIBUTE </code> to
        <code class="code"> PY_METHOD_ATTRIBUTE_WITH_DOC </code> .</p><p>For details, see the <em class="emphasis"> C++ API </em>
        documentation.</p></li><li class="listitem"><p>All database columns that map to entity properties now have the
        "NOT NULL" specification. Previously, this specification was missing
        but BigWorld never inserts NULL values into the database.</p></li><li class="listitem"><p>The <code class="code"> bigworldTableMetadata </code> has been removed. DBMgr
        now uses the table meta data provided by MySQL. If you have previously
        "tricked" DBMgr into accepting a schema which does not match the
        entity definition by modifying <code class="code"> bigworldTableMetadata </code> ,
        it will no longer work.</p></li><li class="listitem"><p>Converted database tables bigworldGameTime, bigworldSpaces and
        bigworldSpaceData to use InnoDB instead of MyISAM. Now all tables
        created by BigWorld uses the InnoDB engine. As the result of this
        conversion the version column became unnecessary and has been dropped
        from bigworldSpaces and bigworldSpaceData.</p></li><li class="listitem"><p>The configuration option <code class="code"> dbMgr/name </code> has been
        deprecated - please use <code class="code"> dbMgr/databaseName </code>
        instead.</p><p>For details, see the document <em class="emphasis"> Server
        Operations Guide </em> 's section <em class="emphasis"> Server
        Configuration With <code class="code"> bw.xml </code> -&gt; DBMgr Configuration
        Options </em> .</p></li><li class="listitem"><p>When using new style BaseApp backup, BaseApps will only back up
        to BaseApps located on different physical machines if such BaseApps
        exist. This means that the system can survive the hardware failure of
        a physical machine running multiple BaseApps.</p></li></ul></div></div><div class="section" title="4.&nbsp;Bug Fixes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7373"></a>4.&nbsp;Bug Fixes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Reduced the creation of new <code class="code"> CellAppChannel </code>
        instances when a real entity is initially created on the wrong
        cell.</p><p>For details on this class, see the <em class="emphasis">
        CellApp C++ API </em> documentation.</p></li><li class="listitem"><p>Improved error checking when accessing <code class="code"> Entity.ownClient
        </code> of entities that do not have a <code class="code"> Witness </code> .</p><p>For details on this attribute, see the <em class="emphasis">
        BaseApp Python API </em> and <em class="emphasis"> CellApp
        Python API </em> documentations.</p></li><li class="listitem"><p>Delayed the calling of <code class="code"> Base.onGetCell </code> until after
        the cell entity has been informed that it should have a
        witness.</p><p>For details on this callback, see the <em class="emphasis">
        BaseApp Python API </em> documentation.</p></li><li class="listitem"><p>Fixed navigation mesh sharing, which was causing crashes in the
        case of different spaces with the same geometries mapped.</p></li><li class="listitem"><p>Fixed bug with base entity <code class="code"> cellData['position'] </code>
        and <code class="code"> cellData['direction'] </code> initially referencing the
        same <code class="code"> Vector3 </code> object.</p></li><li class="listitem"><p>Improved LoginApp's resilience to Denial-of-Server attacks by
        not using reliable communication mechanism for failed login
        attempts.</p></li><li class="listitem"><p>The zlib library has been updated from version 1.2.1 to version
        1.2.3. This version includes some security fixes. See <code class="code">
        mf/src/lib/zip/ChangeLog </code> for more details.</p></li><li class="listitem"><p>Fixed a bug that could cause entity positions on a client to be
        incorrect when travelling on a very fast moving vehicle. The vehicle's
        position must have changed by at least 128 metres in the round-trip
        time to the server.</p></li><li class="listitem"><p>Fixed a bug that caused entities riding on a vehicle to be
        restored to an incorrect position when restoring from their Base
        entity.</p></li><li class="listitem"><p>Fixed spurious error messages when trying to archive an entity
        that is in the process of destroying its cell part.</p></li><li class="listitem"><p>Fixed a DBMgr crash when writing an entity with a base property
        that does not match its type in the entity definition.</p></li><li class="listitem"><p>Fixed a bug in MLTar when extracting a log archive file, it was
        possible to create an unusable user log directory due to the
        particular user log directory not already existing before the
        extraction.</p></li><li class="listitem"><p>Fixed a bug with streaming on request messages onto packets in
        multi-packet bundles.</p></li><li class="listitem"><p>Fixed a bug where entities would get stuck when they passed
        through navpolys with zero distance between them.</p></li></ul></div></div><div class="section" title="5.&nbsp;Known Bugs &amp; Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7461"></a>5.&nbsp;Known Bugs &amp; Limitations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>For Linux machines running a kernel version 2.6 or greater,
        bwmachined will report slightly incorrect load under certain
        circumstances due to a change in the format of <code class="code"> /proc/stat
        </code> from kernel version 2.4.</p><p>The load reporting issue will only manifest when the system is
        spending a significant time idling due to IOwait or IRQ handling
        situations. As this issue only impacts statistic reporting in
        StatLogger/StatGrapher as well as the values reported in the cluster
        view of WebConsole there should be no detrimental impact to your
        server cluster operation.</p></li><li class="listitem"><p>The file specified by <code class="code"> resources.xml/system/terrain2
        </code> (by default, <code class="code"> system/data/terrain2.xml </code> ) is
        loaded each time that terrain is loaded. This can cause disk access in
        the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>Terrain Data uses a large amount of memory but it is not taken
        into account in load balancing.</p></li><li class="listitem"><p>The file specified by <code class="code">
        resources.xml/environment/materialKinds </code> (by default, <code class="code">
        system/data/material_kinds.xml </code> ) is loaded the first time a
        collision test occurs that involves terrain. This can cause disk
        access in the main thread.</p><p>To avoid this, load and store a reference to this file's data
        section in your cell's personality script. See <code class="code">
        fantasydemo/res/scripts/cell/FantasyDemo.py </code> for an
        example.</p></li><li class="listitem"><p>The <code class="code"> UserDataObjectRef </code> module is loaded the first
        time that it is needed. This can cause disk access in the main
        thread.</p><p>To avoid this, import this module into your personality scripts.
        See <code class="code"> fantasydemo/res/scripts/cell/FantasyDemo.py </code> and
        <code class="code"> fantasydemo/res/scripts/base/FantasyDemo.py </code> for
        examples.</p></li><li class="listitem"><p><code class="code"> FIXED_DICT </code> properties that have an <code class="code">
        &lt;implementedBy&gt; </code> can cause a module to be imported the
        first time that the type is created. This can cause disk access in the
        main thread.</p><p>To avoid this, import the necessary modules in the script file
        of the relevant entities or the personality scritps.</p></li><li class="listitem"><p>Currently, MySQL stored procedures are not supported when used
        with the <code class="code"> BigWorld.executeRawDatabaseCommand </code>
        method.</p><p>For details on this method, see the document <em class="emphasis"> Server Programming Guide </em> 's section <em class="emphasis"> The Database Layer -&gt; Execute Arbitrary Commands On
        Database </em> .</p></li><li class="listitem"><p>Due to the Watcher protocol changing as of 1.9.0, the server
        tools (WebConsole, StatLogger, ControlCluster, ...) are not backwards
        compatible. If your operational environment is still running 1.8.x
        servers it is recommended to maintain the existing server tools as
        forward compatibility has been maintained.</p></li><li class="listitem"><p>Customers using Debian Etch will experience issues with
        WebConsole and StatLogger failing overnight due to a MySQL
        reconnection issue. The cause of this issue is due to MySQL timing out
        inactive connections after 8 hours. Currently the default package
        versions of MySQL-python and SQLObject provided by Debian Etch do not
        include a known fix for this issue. The suggested work around for this
        problem is to restart WebConsole every morning prior to the majority
        of developers starting work. This can be achieved by added a cron job
        to the root user of the machine running WebConsole as follows:</p><pre class="programlisting">
          # 06:30 Mon-Fri: Restart WebConsole to avoid MySQL reconnection issues

30 6 * * 1-5 /etc/init.d/bw_web_console restart
        </pre></li><li class="listitem"><p>Tools startup scripts may fail to report when a tool has a
        problem starting if it terminated after it had detached.</p></li><li class="listitem"><p>BWMachined can crash if the messages it sends exceeds its
        internal limits, for example if it reports too many coredumps in one
        request.</p></li><li class="listitem"><p>A race condition can occur when a cell entity is created then
        immediately distroyed. This will cause the script to raise an
        exception. We recommend to either avoid doing this or handling the
        exception.</p></li><li class="listitem"><p>Too many python tracebacks caused by unhanded exceptions can
        cause CellApp to time out. It is recommended to deal with python
        exceptions as they arise.</p></li><li class="listitem"><p>DBMgr does not compile or run without using prepared statements
        despite looking like it should.</p></li><li class="listitem"><p>DBMgr has a race condition when <code class="code"> destroy() </code> and
        <code class="code"> createBaseLocallyFromDBID() </code> are used quickly together
        on the same entity.</p><p>To reset an entity, it is better to create a method to delete
        non-persistant properties and call the destruction and creation
        callbacks than to reload it from DB.</p></li><li class="listitem"><p>Starting multiple copies of DBMgr simultaneously may cause
        system to crash. Please make sure an instance is not running before
        starting another.</p></li><li class="listitem"><p>Unreliable packets do not have a sequence number and can thus be
        replayed by malicious parties. BigWorld does not, as a general rule,
        use unreliable packets for highly sensitive data.</p></li><li class="listitem"><p>All internal server cluster traffic is regarded as trusted and
        may expose stability or security issues if invalid. This will not be
        an issue unless a server component has already become
        compromised.</p></li><li class="listitem"><p>Clients may report a negative latency. This will only happen
        when real latency is very close to zero.</p></li><li class="listitem"><p>The entity definition parser may assert when a def file contains
        contradictory information such as a default value that exceeds the
        maximum length of a property.</p></li><li class="listitem"><p><code class="code"> FIXED_DICT </code> properties ignores assignments from
        invalid dictionaries but does not raise an exception.</p><p>If a <code class="code"> FIXED_DICT </code> is not being propagated, please
        check that every key corresponds to key in the fixed dict.</p></li><li class="listitem"><p>Large servers cannot use multiple instances of stat logger or
        message logger to share the load.</p><p>A single instance however should be able to handle a very large
        cluster.</p></li><li class="listitem"><p>Log output only works correctly with latin-1 encoding, try not
        to log unicode messages.</p></li><li class="listitem"><p>Multiple copies of CellAppMgr, BaseAppMgr and DBMgr can be
        started from WebConsole even though this configuration is not
        supported.</p><p>Make sure a configuration makes sense before hitting
        "Go!".</p></li><li class="listitem"><p>Searching for very narrow time periods in LogViewer can sometime
        be slightly inaccurate.</p><p>Please give it a few seconds margin of error on either
        side.</p></li><li class="listitem"><p>StatGrapher will occasionally fail to display certain time
        periods or display the wrong time period.</p><p>Just give it another try.</p></li><li class="listitem"><p>StatGrapher has a memory leak.</p><p>Please reload the page if flash is taking all of your
        memory.</p></li><li class="listitem"><p>There is an issue when cell entities pass their own mailbox from
        their <code class="code"> __init__() </code> function to the BaseApp that spawned
        them, and this cell mailbox is used for a remote method call. You can
        workaround this by using a short timer to delay any method calls that
        may pass a cell entity's mailbox to base methods until the next
        tick.</p></li></ul></div></div></div></div></div></body></html>